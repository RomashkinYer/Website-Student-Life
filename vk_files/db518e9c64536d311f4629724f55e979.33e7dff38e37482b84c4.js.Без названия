"use strict";(self.webpackChunkvk=self.webpackChunkvk||[]).push([[93424],{832117:(e,_,t)=>{t.d(_,{Icon48PauseButton:()=>i});var i=(0,t(28178).makeIcon)("Icon48PauseButton","pause_button_48","0 0 48 48",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 48 48" id="pause_button_48"><path fill="currentColor" fill-rule="evenodd" d="M24 48c13.255 0 24-10.745 24-24S37.255 0 24 0 0 10.745 0 24s10.745 24 24 24z" clip-rule="evenodd" opacity=".4" /><path fill="#fff" d="M20.077 15c.669 0 .911.07 1.156.2.244.131.436.323.567.567.13.245.2.487.2 1.156v14.154c0 .669-.07.911-.2 1.156a1.371 1.371 0 0 1-.567.567c-.245.13-.487.2-1.156.2h-2.154c-.669 0-.911-.07-1.156-.2a1.364 1.364 0 0 1-.567-.567c-.13-.245-.2-.487-.2-1.156V16.923c0-.669.07-.911.2-1.156.131-.244.323-.436.567-.567.245-.13.487-.2 1.156-.2h2.154zm9 0c.669 0 .911.07 1.156.2.244.131.436.323.567.567.13.245.2.487.2 1.156v14.154c0 .669-.07.911-.2 1.156a1.371 1.371 0 0 1-.567.567c-.245.13-.487.2-1.156.2h-2.154c-.669 0-.911-.07-1.156-.2a1.364 1.364 0 0 1-.567-.567c-.13-.245-.2-.487-.2-1.156V16.923c0-.669.07-.911.2-1.156.131-.244.323-.436.567-.567.245-.13.487-.2 1.156-.2h2.154z" /></symbol>',48,48,!1,void 0)},501129:(e,_,t)=>{t.d(_,{Icon48PlayButton:()=>i});var i=(0,t(28178).makeIcon)("Icon48PlayButton","play_button_48","0 0 48 48",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 48 48" id="play_button_48"><path fill="currentColor" fill-rule="evenodd" d="M24 48c13.255 0 24-10.745 24-24S37.255 0 24 0 0 10.745 0 24s10.745 24 24 24z" clip-rule="evenodd" opacity=".4" /><path fill="#fff" d="M31.65 21.922c1.181.682 1.772 1.023 1.97 1.468a1.5 1.5 0 0 1 0 1.22c-.198.445-.789.786-1.97 1.468L21.6 31.881c-1.181.682-1.772 1.023-2.257.972a1.5 1.5 0 0 1-1.056-.61C18 31.849 18 31.166 18 29.803V18.197c0-1.364 0-2.047.287-2.44a1.5 1.5 0 0 1 1.056-.611c.485-.05 1.076.29 2.257.972l10.05 5.803z" /></symbol>',48,48,!1,void 0)},972520:(e,_,t)=>{t.d(_,{default:()=>i});const i={header:"styles-module__header--aAME2",content:"styles-module__content--xBzRu",actions:"styles-module__actions--jD0Ou"}},715417:(e,_,t)=>{t.d(_,{default:()=>i});const i={root:"AudioCatalogVkMixBlock-module__root--G89IE",description:"AudioCatalogVkMixBlock-module__description--CAeGE",wrap:"AudioCatalogVkMixBlock-module__wrap--_SBsf"}},173607:(e,_,t)=>{t.d(_,{default:()=>i});const i={stateIcon:"AudioStateButton-module__stateIcon--b9QtQ"}},39655:(e,_,t)=>{t.d(_,{default:()=>i});const i={root:"Lottie-module__root--VbKrX"}},376396:(e,_,t)=>{t.d(_,{mapChoiceToActionChoice:()=>s});var i=t(434788),o=t(820224);function s(e){switch(e.type){case"action":return e;case"link":{const{href:_}=e,t=(0,o._)(e,["href"]);return(0,i._)({},t,{type:"action",action:()=>{var e;null==(e=window.open(_,"_blank"))||e.focus()}})}}}},547608:(e,_,t)=>{t.d(_,{CatalogBannerStatCollector:()=>l});var i=t(434788),o=t(957973),s=t(193452);class l{destroy(){this.observer.disconnect(),this.observed_items.forEach(((e,_)=>this.sendViewStat(_))),this.elements.forEach((e=>e.removeEventListener("mousedown",this.clickHandler)))}addHandlers(){this.clickHandler=this.onClick.bind(this),this.elements.forEach((e=>e.addEventListener("mousedown",this.clickHandler))),this.elements.forEach((e=>this.observer.observe(e)))}onClick(e){if(e.currentTarget&&e.currentTarget instanceof HTMLElement&&e.currentTarget.parentElement&&e.currentTarget.dataset.id){const _=parseInt(e.currentTarget.dataset.id),t={type:o.ClickProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,position:[...e.currentTarget.parentElement.children].indexOf(e.currentTarget)+1},i={type:o.EventItemType.CATALOG_BANNER,id:_,track_code:this.blockId};this.clickCollector.logEvent(t,i)}}sendViewStat(e){if(void 0!==this.observed_items[e]){const _=(0,i._)({},this.observed_items[e],{end_view:this.productCollector.getCurrentTime()}),t={type:o.EventItemType.CATALOG_BANNER,id:e,track_code:this.blockId};this.viewCollector.logEvent(_,t),delete this.observed_items[e]}}onView(e){e.forEach((e=>{const _=e.target;if(_ instanceof HTMLElement&&_.parentElement&&_.dataset.id){const t=parseInt(_.dataset.id);e.isIntersecting?void 0===this.observed_items[t]&&(this.observed_items[t]={type:o.ViewProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,start_view:this.productCollector.getCurrentTime(),end_view:"0",position:[..._.parentElement.children].indexOf(_)+1}):this.sendViewStat(t)}}))}constructor(e,_){this.blockId=_;this.observed_items=[],this.observer=new IntersectionObserver((e=>this.onView(e)),{root:null,rootMargin:"0px",threshold:.5}),this.productCollector=new s.ProductionStatCollector,this.viewCollector=new s.ViewStatCollector(this.productCollector),this.clickCollector=new s.ClickStatCollector(this.productCollector),this.elements=e,this.addHandlers()}}},479853:(e,_,t)=>{t.d(_,{BannersController:()=>s,ConsumeReason:()=>i});var i,o=t(547608);!function(e){e.Click="click",e.Close="close"}(i||(i={}));class s{getBanners(){return Array.from(this.blockContent.querySelectorAll(".BannerItem"))}setBannersEvents(){this.getBanners().forEach((e=>{if(e.dataset.id){const _=parseInt(e.dataset.id);this.addConsumableClick(e,_),this.addConsumableCloseClick(e,_)}}))}checkItems(){this.getBanners().length||this.blockContent&&this.blockContent.remove()}destroy(){this.bannerStatCollector.destroy()}onDataLoad(){}constructor(e,_){this.blockContent=e,this.blockId=_;const t=this.getBanners();this.bannerStatCollector=new o.CatalogBannerStatCollector(t,_)}}},220126:(e,_,t)=>{t.d(_,{formatAudioTime:()=>o});var i=t(722082);function o({duration:e,progress:_,negative:t}){return t&&_<1?"-"+(0,i.formatTime)(Math.round(e-_*e)):(0,i.formatTime)(Math.round(_*e))}},65780:(e,_,t)=>{function i(e){let _=e.split(" ");_=_.slice(0,_.length-1);let t=_.join(" ");return t&&(t+="..."),t}function o(e,_=0){if(e.scrollHeight/e.clientHeight>1.1){let t=e.clientHeight,o=e.innerText;for(;o&&e.scrollHeight/t>1.1&&e.innerText.split(" ").length>_;)o=i(o),e.innerHTML=o}}t.d(_,{truncateMultilineText:()=>o})},846681:(e,_,t)=>{t.d(_,{useUpdateEffect:()=>o,useUpdateLayoutEffect:()=>s});var i=t(667294);const o=l(i.useEffect),s=l(i.useLayoutEffect);function l(e){return function(_,t){const o=(0,i.useRef)();e((()=>{if(o.current)return _();o.current=!0}),t)}}},391207:(e,_,t)=>{t.d(_,{AudioCatalogVkMixBlockTq:()=>l});var i=t(785893),o=t(301951),s=t(331354);const l=({payload:{target:e,data:_}})=>{if(!e)throw new Error("FriendsGroupsBlock: Missing target");const{items:t}=_;(0,o.initReactApp)(e,(0,i.jsx)(s.AudioCatalogVkMixBlockAplication,{id:t[0].id,backgroundAnimationUrl:t[0].background_animation_url,description:t[0].description,title:t[0].title}))}},435599:(e,_,t)=>{t.d(_,{BannersController:()=>s});var i=t(479853),o=t(363444);class s extends i.BannersController{consumeBanner(e,_){o.ajax.post("/al_audio.php?act=consume_banner",{id:e,ref:this.blockId,reason:_},{onFail:()=>!0})}addConsumableClick(e,_){e.classList.contains("BannerItem--consumable")&&e.dataset.id&&e.addEventListener("click",(()=>this.consumeBanner(_,i.ConsumeReason.Click)))}addConsumableCloseClick(e,_){const t=e.querySelector(".BannerItem__close");t instanceof HTMLElement&&(t.onclick=t=>{this.consumeBanner(_,i.ConsumeReason.Close),e.remove(),this.checkItems(),t.stopPropagation(),t.preventDefault()})}checkItems(){const e=this.getBanners();if(e.length){if(1===e.length){const e=this.blockContent.querySelectorAll(".audio_promo__control");e&&e.forEach((e=>e.remove()))}}else{const e=this.blockContent.parentElement;this.blockContent&&this.blockContent.remove(),e&&!e.childElementCount&&e.remove()}}constructor(e,_){super(e,_),this.setBannersEvents()}}},234649:(e,_,t)=>{t.d(_,{BaseController:()=>a});var i=t(434788),o=t(942260),s=t(977835),l=t(98645);class a{fetchNext(){return this.fetchSection(this.id,this.nextFrom)}fetchSection(e,_,t={}){return this.fetchInProgress=!0,new Promise(((o,s)=>{const l=(0,i._)({section_id:e,start_from:_},t);window.nav.objLoc.claim&&(l.claim=window.nav.objLoc.claim),window.ajax.post("al_audio.php?act=load_catalog_section",l,{onDone:(e,_,t)=>{this.fetchInProgress=!1,o({blocks:e,data:_,blockItems:t})},onFail:()=>(s(),this.fetchInProgress=!1,!0)})}))}getId(){return this.id}static getHint(e,_){switch(_.type){case o.HintType.Tooltip:return new s.TooltipHint(_,e);case o.HintType.Highlight:return new l.HighlightHint(_,e)}return null}}},533643:(e,_,t)=>{t.d(_,{BlockController:()=>b});var i=t(134540),o=t(95432),s=t(691483),l=t(234649),a=t(221695),n=t(444402),r=t(459474),d=t(258016),u=t(435599),c=t(795558),h=t(60896),E=t(665833),p=t(363444),P=t(928021),g=t(866310);class b extends l.BaseController{initSpecificBlockController(){if(this.blockContent)switch(this.blockContent.dataset.type){case"catalog_banners":this.specificController=new u.BannersController(this.blockContent,this.getId());break;case"artist":case"curator":this.specificController=new P.MusicAuthorController(this.blockContent)}}enable(){this.reorderer&&this.reorderer.enable()}disable(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.disable()}emitEvent(e){if(this.listenEvents.includes(e))if(e===g.events.PLACEHOLDER_REMOVE)this.removeBlock();else this.reloadData()}initSearch(){const e=this.block.getElementsByClassName("ui_search");e.length&&Array.prototype.forEach.call(e,(e=>d.default.init(e)))}initListenEvents(){var e;if(null==(e=this.blockContent)?void 0:e.dataset.listenEvents)try{var _;this.listenEvents=JSON.parse(null==(_=this.blockContent)?void 0:_.dataset.listenEvents)}catch(e){}}onSectionInit(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(s.BLOCK_ITEMS_REORDERABLE)&&this.initListReorder("current"!==this.section.name)}hasBlockName(e){return this.blockContent&&this.blockContent.classList.contains(`${s.BLOCK_ELEMENT}__${e}`)}reloadData(){this.fetchSection(this.id,"").then((({blockItems:e,data:_})=>{if(this.setItems(b.createNodesFromItems(e)),_.playlists&&_.playlists.length){const e=(0,o.getAudioPlayer)();e&&e.addWithReplacePlaylists(_.playlists.filter(Boolean))}})).catch((()=>!0))}setFromBlockContent(){if(this.blockContent=this.block.classList.contains(s.BLOCK_CONTENT)?this.block:this.block.querySelector(`.${s.BLOCK_CONTENT}`),this.blockContent){this.id=this.blockContent.dataset.id||"",this.nextFrom=this.blockContent.dataset.next||"",this.dataType=this.blockContent.dataset.type||null;const e=this.blockContent.classList.toString().match(/CatalogBlock__layout--(.*)/);this.layoutName=e&&e[1]}}removeBlock(){this.destroy();const e=this.block.closest(`.${s.BLOCK_ELEMENT}`);let _=this.block;e instanceof HTMLElement&&1===e.childElementCount&&(_=e),_.remove()}clearList(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")}destroy(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.destroy(),this.specificController&&this.specificController.destroy()}hideLoader(){this.loader&&(this.loader.style.display="none")}showLoader(){this.loader&&(this.loader.style.display="")}setNextFrom(e){this.nextFrom=e,this.blockContent&&(this.blockContent.dataset.next=this.nextFrom)}setId(e){this.id=e,this.blockContent&&(this.blockContent.dataset.id=this.id),this.blockItemsContainer&&this.blockItemsContainer.dataset.playlistId&&(this.blockItemsContainer.dataset.playlistId=this.id)}setItems(e){if(this.blockItemsContainer&&this.dataType&&this.layoutName){new h.BlockItemsReplacer(this.blockItemsContainer,this.dataType,this.layoutName).replaceItems(e)}}resetItems(){this.blockItemsContainer&&(this.clearItems(),this.blockItemsContainer.append(...this.initialItems))}clearItems(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")}initAutoList(e=[]){let _=e;this.blockItemsContainer&&(this.blockAutoList&&this.blockAutoList.destroy(),this.blockAutoList=new i.default(this.blockItemsContainer,{scrollNode:!1,onRendered:()=>{(0,o.getAudioPlayer)().updateCurrentPlaying(),this.specificController&&this.specificController.onDataLoad()},onNoMore:()=>this.hideLoader(),onNeedRows:e=>{if(this.showLoader(),_.length){const t=_;return _=[],void e(t)}this.nextFrom?this.fetchNext().then((({blockItems:_,data:t})=>{this.setNextFrom(t.nextFrom),this.dataType===E.DataType.RadioStations&&t.playlist&&b.mergePlaylistFromPaginatedResponse(t.playlist),e(_)})).catch((()=>{})):e(null)}}))}updateListReorder(){this.reorderer&&this.reorderer.update()}initListReorder(e=!0){let _;switch(this.dataType){case E.DataType.MusicAudios:_=(_,t,i)=>this.onAudioBlockReorder(_,t,i,e);break;case E.DataType.MusicPlaylists:_=this.onPlaylistsBlockReorder.bind(this);break;default:_=()=>{}}this.reorderer=new n.default(this.blockItemsContainer,"",{onReorder:_.bind(this)})}onAudioBlockReorder(e,_,t,i){window.currentAudioPage(this.block).onAudioRowsReorder(!i,e,_,t)}onPlaylistsBlockReorder(e,_,t){window.currentAudioPage(this.block).onPlaylistsReorder(e,_,t)}static mergePlaylistFromPaginatedResponse(e){const _=(0,o.getAudioPlayer)(),t=_.getPlaylist(e.type,e.ownerId,e.id);_.mergePlaylistData(t,e)}initSortSelector(){const e=this.block.querySelector(`.${s.SORTER_ACTION}`);e&&(this.sortSelector=new a.BlockSorter(e,(e=>{p.ajax.post("/al_audio.php?act=replace_blocks",{replacement_ids:e},{onDone:e=>this.section.replaceBlocks(e.replacements,e.nextFrom,e.playlists)})})))}initGallery(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(s.GALLERY)&&(this.gallery=new r.UIGallery(this.blockItemsContainer,{scrollY:!1}))}static search(e,_,t,i){const o=b.findBlockById(e,i.target);o&&!o.fetchInProgress&&(t?o.fetchSection(_,"",{search_query:t}).then((({blockItems:e})=>{o.setItems(b.createNodesFromItems(e))})).catch((()=>!0)):o.resetItems())}static showMore(e,_){const t=b.findBlockById(e,_);t&&!t.fetchInProgress&&t.fetchNext().then((({blockItems:e,data:_})=>{t.setItems(b.createNodesFromItems(e)),t.nextFrom=_.nextFrom})).catch((()=>!0))}static findBlockById(e,_){const t=window.currentAudioPage(_).catalogController.currentSection;return t?t.getBlockById(e):null}static findBlockByElement(e){var _;return(null==(_=(0,c.gpeByClass)("CatalogBlock__content",e))?void 0:_.dataset.id)||null}static createNodesFromItems(e){return e.map((e=>{const _=document.createElement("template");return _.innerHTML=e,_.content.firstElementChild})).filter((e=>!!e))}initHints(){if(this.block.dataset.catalogHintId){const e=this.section.getHintById(this.block.dataset.catalogHintId);if(e){const _=l.BaseController.getHint(this.block,e);if(_){const t=this.section.hintsToShow.findIndex((e=>_.id===e.id&&e.initialElement.parentElement===_.initialElement.parentElement));if(t>-1){const _=this.section.hintsToShow[t],i=_.initialElement.parentElement||_.initialElement,o=l.BaseController.getHint(i,e);o&&(this.section.hintsToShow[t]=o)}else this.section.hintsToShow.push(_)}delete this.block.dataset.catalogHintId}}const e=this.block.querySelectorAll("[data-catalog-hint-id]");if(e.length){const _={};e.forEach((e=>{e.dataset.catalogHintId&&(Array.isArray(_[e.dataset.catalogHintId])?_[e.dataset.catalogHintId].push(e):_[e.dataset.catalogHintId]=[e],delete e.dataset.catalogHintId)})),Object.entries(_).forEach((([e,_])=>{const t=this.section.getHintById(e);if(!t)return;let i;i=1===_.length?_[0]:this.block;const o=l.BaseController.getHint(i,t);o&&this.section.hintsToShow.push(o)}))}}constructor(e,_){super(),this.section=e,this.block=_,this.listenEvents=[],this.setFromBlockContent(),this.blockItemsContainer=_.querySelector(`.${s.BLOCK_ITEMS_CONTAINER}`),this.blockItemsContainer&&(this.initialItems=[...this.blockItemsContainer.children]),this.initSpecificBlockController(),this.initGallery(),this.loader=_.getElementsByClassName(s.AUTO_LIST_LOADER)[0],this.initSearch(),this.initSortSelector(),this.initHints(),this.initListenEvents()}}},60896:(e,_,t)=>{t.d(_,{BlockItemsReplacer:()=>s});var i=t(665833),o=t(778971);class s{replaceItems(e){switch(this.dataType){case i.DataType.MusicAudios:this.replaceItemsBase(e);break;case i.DataType.MusicPlaylists:this.replaceMusicPlaylists(e);break;case i.DataType.MusicOwners:this.replaceMusicOwners(e);break;default:this.replaceItemsBase(e)}}replaceMusicPlaylists(e){let _=e;this.layoutName===o.LayoutName.LargeSlider&&(_=e.slice(0,5)),this.replaceItemsBase(_)}replaceItemsBase(e){this.container.innerHTML="",this.container.append(...e)}replaceMusicOwners(e){const _=e[0];if(_){const e=_.querySelector(".MusicOwnerCell__actions");if(e){const _=this.container.querySelector(".MusicOwnerCell__actions");if(_)_.innerHTML=e.innerHTML;else{const _=this.container.querySelector(".MusicOwnerCell__after");_&&_.appendChild(e)}}}}constructor(e,_,t){this.container=e,this.dataType=_,this.layoutName=t}}},221695:(e,_,t)=>{t.d(_,{BlockSorter:()=>l});var i=t(434788),o=t(691483),s=t(833712);class l{getConfig(){const e=this.element.querySelector(`.${o.SORTER_ACTION_DATA}`);if(!e)return null;const _=Array.from(e.querySelectorAll("li"));if(0===_.length)return null;const t={};return t.items=_.map((e=>{const _=e.dataset.id||"";return e.dataset.selected&&(t.selected=_),[_,e.innerText]})),t.withArrow=!0,e.remove(),t}constructor(e,_){this.element=e;const t=this.getConfig();this.dropdown=new s.InlineDropdown(e,(0,i._)({onSelect:_},t))}}},514282:(e,_,t)=>{t.d(_,{CatalogController:()=>o});var i=t(201557);class o{setSection(e,_,t){this.sections[e]&&this.sections[e].getId()===t.sectionId?(this.currentSection=this.sections[e],this.enableSection(e)):(this.currentSection=new i.SectionController(_,t,this),this.sections[e]=this.currentSection)}disableSection(e){this.sections[e]&&this.sections[e].disable()}enableSection(e){this.sections[e]&&this.sections[e].enable()}emitEvent(e,_){Object.values(this.sections).forEach((t=>t.emitEvent(e,_)))}deleteSection(e){const _=this.sections[e];_&&(_.destroy(),delete this.sections[e])}destroy(){Object.entries(this.sections).forEach((([,e])=>{e.destroy()})),this.headerSection&&this.headerSection.destroy()}updateSectionReorder(){this.currentSection&&this.currentSection.updateReorder()}initBlocksManually(){this.currentSection=new i.SectionController(this.root,{nextFrom:"",isBlockPagination:!1,sectionId:"",name:""},this),this.currentSection.initBlocksManually()}constructor(e){this.sections={},this.root=e;const _=this.root.querySelector(".CatalogSection--header_section");_ instanceof HTMLElement&&(this.headerSection=new i.SectionController(_,{})),this.tabs=Array.from(this.root.querySelectorAll("._audio_section_tab .ui_tab"))}}},98645:(e,_,t)=>{t.d(_,{HighlightHint:()=>a});var i=t(942260),o=t(432445),s=t(145637),l=t(438221);class a extends o.Hint{show(){this.highlight=new s.default(this.initialElement,this.generateContent(),this.options),(0,l.disableBodyScroll)(),this.highlight.showTT()}hide(){this.highlight.hideTT(),(0,l.enableBodyScroll)(),super.hide()}constructor(e,_){super(i.HintType.Highlight,e),this.initialElement=_,this.options={highlight:!0,width:280,offset:[0,-17],scrollOffset:40,side:"bottom"},e.unskipable?this.options.ttOnHide=()=>{}:this.options.onBGClick=()=>this.hide()}}},432445:(e,_,t)=>{t.d(_,{Hint:()=>l});var i=t(221780),o=t(953908),s=t(363444);class l{hide(){this.onHide&&this.onHide(),s.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:this.hintId,hash:this.hideHash})}generateContent(){let e=document.createElement("div");if(this.title&&(e.innerHTML+=`<div class="CatalogHint__title">${this.title}</div>`),this.text&&(e.innerHTML+=`<div class="CatalogHint__text">${this.text}</div>`),this.actions){const _=document.createElement("div");_.classList.add("CatalogHint__actions");let t=this.actions.map((e=>{const _=document.createElement("a");switch(_.classList.add("flat_button"),e.type){case"open_url":_.href=e.url,_.onclick=_=>{window.nav.go(e.url),this.hide(),(0,o.cancelEvent)(_)};break;case"switch_section":_.onclick=t=>{(0,o.cancelEvent)(t);window.currentAudioPage(_).catalogController.currentSection.switchSection(e.targetSectionId),this.hide()}}return _.innerHTML=e.label,_}));if(_.append(...t),this.tutorialSteps){const e=document.createElement("div");e.classList.add("CatalogHint__tutorialSteps"),e.innerHTML=(0,i.langStr)(i.getLang("audio_onboarding_tutorial_progress"),"step",this.tutorialSteps.current,"total_steps",this.tutorialSteps.total),_.append(e)}e.append(_)}return e}constructor(e,_){this.type=e,this.id=_.id,this.title=_.title,this.text=_.text,this.hintId=_.hintId,this.hideHash=_.hideHash,this.actions=_.actions,_.currentStep&&_.totalSteps&&(this.tutorialSteps={current:_.currentStep,total:_.totalSteps})}}},942260:(e,_,t)=>{var i;t.d(_,{HintType:()=>i}),function(e){e.Tooltip="tooltip",e.Highlight="highlight"}(i||(i={}))},977835:(e,_,t)=>{t.d(_,{TooltipHint:()=>a});var i=t(434788),o=t(942260),s=t(432445),l=t(84543);class a extends s.Hint{show(){this.tooltip.show()}constructor(e,_){let t=_,s="center",a="top";(_.classList.contains("CatalogBlock__layout--header")||_.classList.contains("CatalogBlock__layout--header_extended"))&&(t=_.querySelector(".CatalogBlock__title")||_,s="left"),_.classList.contains("MusicAuthor__follow_btn")&&(s="right",a="bottom"),super(o.HintType.Tooltip,e),this.initialElement=_;const n=(0,i._)({force_side:a,align:s,offset_left:0,offset_top:0,width:"250px"},e);this.tooltip=new l.ElementTooltip(t,{content:this.title||this.text||"",cls:`feature_intro_tt ${this.id} CatalogTooltip`,forceSide:n.force_side,align:n.align,width:n.width,offset:[n.offset_left,n.offset_top],autoShow:!1,onHide:()=>this.hide()})}}},928021:(e,_,t)=>{t.d(_,{MusicAuthorController:()=>o});var i=t(65780);class o{truncateName(){const e=this.blockContent.querySelector(".MusicAuthor_block__title");if(e instanceof HTMLElement){(0,i.truncateMultilineText)(e);parseInt(getComputedStyle(e).lineHeight)===e.clientHeight&&e.classList.add("MusicAuthor_block__title--singleLine"),e.classList.remove("MusicAuthor_block__title--hidden")}}destroy(){}onDataLoad(){}constructor(e){this.blockContent=e,this.truncateName()}}},201557:(e,_,t)=>{t.d(_,{SectionController:()=>d});var i=t(145669),o=t(95432),s=t(134540),l=t(533643),a=t(691483),n=t(234649),r=t(98645);class d extends n.BaseController{showHints(){if(this.hintsToShow.length){let e;const _=this.hintsToShow.filter((e=>e instanceof r.HighlightHint));_.length?(e=_[0],this.hintsToShow.splice(this.hintsToShow.indexOf(e),1),e.onHide=()=>this.showHints(),e.show()):this.hintsToShow.forEach((e=>e.show()))}}initBlocksManually(){this.initBlocks()}getSectionElement(){return this.sectionEl}enable(){this.initSectionAutoList(),this.blocks.forEach((e=>e.enable()))}disable(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks.forEach((e=>e.disable()))}emitEvent(e,_){this.blocks.forEach((t=>{_&&_!==t.getId()||t.emitEvent(e)}))}switchSection(e){var _;const t=null==(_=this.catalogController)?void 0:_.tabs;t&&t.forEach((_=>{_.dataset.sectionId===e&&_.click()}))}replaceBlocks(e,_,t){let i=!1;t&&this.addPlaylists(t),e.forEach((e=>{var _;const t=e.fromIds.map((e=>this.getBlockById(e))).filter((e=>null!==e));let o=null;if(t.length&&(null==(_=t[t.length-1])?void 0:_.block)&&(o=t[t.length-1].block),!o)return;const s=l.BlockController.createNodesFromItems(e.toBlocks);s.forEach((e=>{var _;return null==(_=o)?void 0:_.insertAdjacentElement("beforebegin",e)})),i=i||t.some((e=>e===this.paginatedBlockController)),t.forEach((e=>{e.block.remove(),e.destroy(),this.blocks=this.blocks.filter((_=>_!==e))}));const a=s.map((e=>new l.BlockController(this,e)));this.blocks.push(...a),this.hideShowMoreLoaders()})),"string"==typeof _&&this.setNextFrom(_),i&&(this.initPaginatedBlock(),_&&(this.isBlockPagination?this.initBlockAutoList([],this.nextFrom):this.sectionAutoList.isDone()&&this.initSectionAutoList()))}sectionInited(){this.blocks.forEach((e=>e.onSectionInit()))}initTabsHints(){var e;const _=null==(e=this.catalogController)?void 0:e.tabs;_&&_.forEach((e=>{if(e.dataset.catalogHintId){const _=this.getHintById(e.dataset.catalogHintId);if(_){const t=n.BaseController.getHint(e,_);t&&this.hintsToShow.push(t),delete e.dataset.catalogHintId}}}))}getHintById(e){return this.sectionData.hints&&this.sectionData.hints[e]||null}destroy(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks&&this.blocks.forEach((e=>e.destroy()))}getBlockById(e){return this.blocks&&this.blocks.find((_=>_.getId()===e))||null}reloadBlock(e){const _=this.findBlockByBlockName(e);_&&_.reloadData()}updateReorder(){this.blocks&&this.blocks.forEach((e=>{e.updateListReorder()}))}hideShowMoreLoaders(){this.blocks.forEach((e=>e.hideLoader()))}addPlaylists(e){e.forEach((e=>{e&&new i.AudioPlaylist(e)}))}setPagePlaylist(e){const _=window.currentAudioPage(this.sectionEl);let t=(0,o.getAudioPlayer)().getPlaylist(e.type,e.ownerId,e.id,"",e.blockId);t.mergeWith(e),t.getAudiosCount()||t.load(),_.setPagePlaylist(t)}setNextFrom(e){this.nextFrom=e,this.sectionEl&&(this.sectionEl.dataset.next=e)}initSectionAutoList(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.sectionAutoList=new s.default(this.sectionEl,{fetchImmediate:!1,onNeedRows:e=>{if(this.isBlockPagination)return this.initBlockAutoList(),void e(null);var _;this.nextFrom?(null==(_=this.paginatedBlockController)||_.showLoader(),this.fetchNext().then((({blocks:_,data:t,blockItems:i})=>{if(this.setNextFrom(t.nextFrom),t.isBlockPagination||t.blockIds&&1===t.blockIds.length&&this.getBlockById(t.blockIds[0])){if(e(null),this.isBlockPagination=this.isBlockPagination||t.isBlockPagination,this.initBlockAutoList(i,this.nextFrom),t.playlist&&"search"===t.playlist.type){(0,o.getAudioPlayer)().getPlaylist().sendSearchStats("search_view")}}else t.playlists&&this.addPlaylists(t.playlists),e(_||null),this.initBlocks()})).catch((()=>{}))):e(null)}})}initBlocks(){this.blocks=[];const e=[];[...this.sectionEl.getElementsByClassName(a.BLOCK_ELEMENT)].forEach((_=>{_.classList.contains(a.BLOCK_DIVIDED)?_.querySelectorAll(`.${a.BLOCK_CONTENT}`).forEach((_=>e.push(_))):e.push(_)})),this.blocks=e.map((e=>new l.BlockController(this,e))),this.initPaginatedBlock()}initPaginatedBlock(){const e=this.sectionEl.querySelector(`.${a.PAGINATED_BLOCKS_CONTAINER}`);if(e){const _=[...e.getElementsByClassName(a.BLOCK_CONTENT)],t=_[_.length-1].dataset.id;t&&(this.paginatedBlockController=this.getBlockById(t))}else this.paginatedBlockController=this.blocks[this.blocks.length-1]}initBlockAutoList(e=[],_){this.paginatedBlockController&&(void 0!==_&&this.paginatedBlockController.setNextFrom(_),this.paginatedBlockController.initAutoList(e))}findBlockByBlockName(e){return this.blocks.find((_=>_.hasBlockName(e)))}constructor(e,_,t){super(),this.sectionData=_,this.catalogController=t,this.blocks=[],this.hintsToShow=[];const i=e.classList.contains(a.SECTION)?e:e.querySelector(`.${a.SECTION}`);i?(this.sectionEl=i,this.name=_.name,this.initTabsHints(),this.initBlocks(),this.nextFrom=void 0===this.sectionEl.dataset.next?_.nextFrom:this.sectionEl.dataset.next,this.id=_.sectionId,_.playlists&&_.playlists.length&&this.addPlaylists(_.playlists),_.playlist&&this.setPagePlaylist(_.playlist),this.isBlockPagination=this.sectionData.isBlockPagination,this.initSectionAutoList(),this.hideShowMoreLoaders(),this.sectionInited(),this.showHints()):this.sectionEl=e}}},665833:(e,_,t)=>{var i;t.d(_,{DataType:()=>i}),function(e){e.MusicAudios="music_audios",e.MusicPlaylists="music_playlists",e.MusicOwners="music_owners",e.RadioStations="radiostations"}(i||(i={}))},778971:(e,_,t)=>{var i;t.d(_,{LayoutName:()=>i}),function(e){e.LargeSlider="large_slider",e.List="list"}(i||(i={}))},691483:(e,_,t)=>{t.d(_,{AUTOPLAY_CONTAINER:()=>b,AUTOPLAY_DISABLED:()=>p,AUTOPLAY_HEADER:()=>g,AUTOPLAY_HEADER_WRAPPER:()=>P,AUTO_LIST_LOADER:()=>d,BLOCK_CONTENT:()=>u,BLOCK_DIVIDED:()=>r,BLOCK_ELEMENT:()=>a,BLOCK_ITEMS_CONTAINER:()=>s,BLOCK_ITEMS_REORDERABLE:()=>l,BLOCK_SEPARATOR:()=>n,GALLERY:()=>E,PAGINATED_BLOCKS_CONTAINER:()=>o,SECTION:()=>i,SORTER_ACTION:()=>c,SORTER_ACTION_DATA:()=>h});const i="CatalogSection",o="CatalogSection__paginatedBlocks",s="CatalogBlock__itemsContainer",l="CatalogBlock__itemsContainer--reorderable",a="CatalogBlock",n="CatalogBlock--separator",r="CatalogBlock--divided",d="CatalogBlock__autoListLoader",u="CatalogBlock__content",c="CatalogBlock__sorter",h="CatalogBlock__sortingData",E="ui_gallery",p="Autoplay--disabled",P="Autoplay--header__wrapper",g="Autoplay--header",b="Autoplay--container"},541983:(e,_,t)=>{t.d(_,{AutoplayBlock:()=>c});var i=t(11010),o=t(866310),s=t(595509),l=t(9480),a=t(95432),n=t(691483),r=t(795558),d=t(85187),u=t(958721);class c{onNoMore(){this.uiScroll&&this.uiScroll.emitter.removeListener("more",this.onNeedRows)}init(e,_){var t;if(this.container)throw new Error("AutoplayBlock already initialized");if(!this.autoplayQueue.hasMore&&0===this.autoplayQueue.list.length)return;this.container=e,this.uiScroll=_,this.offset=0,this.isPending=!1;const i=document.createElement("div");i.classList.add(n.BLOCK_ELEMENT,n.AUTOPLAY_CONTAINER),i.innerHTML=`<div class="${n.AUTOPLAY_HEADER_WRAPPER}">\n        <div>\n              <div class="${n.BLOCK_SEPARATOR}">\n                <div class="${n.BLOCK_CONTENT} CatalogBlock__layout--in_block_separator"></div>\n            </div>\n        </div>\n    </div>`,this.audioListContainer=i,null==(t=i.querySelector(`.${n.AUTOPLAY_HEADER_WRAPPER}`))||t.append(this.headerElement),this.renderHeader(),this.container.append(i);const o=this.autoplayQueue.service.$enabled.watch((e=>{e?this.enable():this.disable()}));this.onDestroyCallbacks.push(o)}destroy(){var e,_;this.disable(),this.headerInitiator.isMounted()&&this.headerInitiator.unmount(),this.container&&(this.container=null,null==(e=this.audioListContainer)||e.remove(),this.onDestroyCallbacks.forEach((e=>e())),this.onDestroyCallbacks=[],null==(_=this.uiScroll)||_.emitter.removeAllListeners(),this.uiScroll=null)}enable(){var e,_;if(this.enabled)return;null==(e=this.audioListContainer)||e.classList.remove(n.AUTOPLAY_DISABLED),null==(_=this.uiScroll)||_.emitter.addListener("more",this.onNeedRows),this.onDisableCallbacks.push((()=>{var e;null==(e=this.uiScroll)||e.emitter.removeListener("more",this.onNeedRows)}));const t=this.eventBus.subscribe(o.AudioPlayerEventType.PLAY_TRACK_FROM_AUTOPLAY,this.onAutoplayTrackStart);this.onDisableCallbacks.push(t.unsubscribe),this.enabled=!0,this.offset||this.onNeedRows()}disable(){var e;this.onDisableCallbacks.forEach((e=>e())),this.onDisableCallbacks=[],null==(e=this.audioListContainer)||e.classList.add(n.AUTOPLAY_DISABLED),this.enabled=!1}renderHeader(){this.headerInitiator.render({autoplayService:this.autoplayQueue.service})}constructor(){this.autoplayQueue=(0,a.getAudioPlayer)().getPlaylistQueue().autoplayQueue,this.eventBus=(0,a.getAudioPlayer)().getPlaylistQueue().eventBus,this.enabled=!1,this.onDisableCallbacks=[],this.onDestroyCallbacks=[],this.isPending=!1,this.offset=0,this.uiScroll=null,this.container=null,this.audioListContainer=null,this.onAutoplayTrackStart=e=>{var _;const{autoplayQueue:t,container:i,audioListContainer:o}=this;if(!i||!o)return;const l=i.querySelector(".audio_page__audio_rows_list"),a=o.querySelector(`.${n.AUTOPLAY_HEADER_WRAPPER}`),d=(0,s.audioTupleToAudioObject)(e),u=o.querySelector(`[data-full-id="${null==(_=d)?void 0:_.fullId}"]`);if(!(l&&a&&u&&u.parentNode))return;let c=Array.from(u.parentNode.childNodes);if(!t.hasMore&&0===t.list.length)return l.append(...c.slice(1)),void a.remove();const h=a.offsetHeight,E=u.offsetHeight,p=c.indexOf(u);c=c.slice(1,p+1),requestAnimationFrame((()=>{(0,r.setStyle)(a,{transform:`translateY(${p*E}px)`,transition:"transform  0.5s ease"}),c.forEach((e=>{(0,r.setStyle)(e,{transition:"transform  0.5s ease",transform:`translateY(-${h+18}px)`})}));const e=()=>{(0,r.setStyle)(a,{transition:null,transform:null}),c.forEach((e=>{(0,r.setStyle)(e,{transition:null,transform:null})})),l.append(...c),a.removeEventListener("transitionend",e)};a.addEventListener("transitionend",e)}))};var e=this;this.onNeedRows=(0,i._)((function*(){try{if(e.isPending)return;e.isPending=!0;const _=e.audioListContainer;if(_){const t=yield e.autoplayQueue.getNextAudios(e.offset);if(0===t.length&&!e.autoplayQueue.hasMore)return e.onNoMore();const i=t.map((e=>{const _=l.AudioUtils.drawAudio(e);_.trim();const t=document.createElement("div");return t.innerHTML=_,t.firstChild}));0!==i.length&&(_.append(...i),e.offset+=i.length),e.isPending=!1}}catch(_){e.isPending=!1,console.log(_)}}));const _=document.createElement("div");_.classList.add(n.AUTOPLAY_HEADER),this.headerElement=_,this.headerInitiator=(0,d.createReactInitiator)(u.AutoplayHeaderApplication,_,{destroyAfterNavigation:!1})}}},366965:(e,_,t)=>{t.d(_,{AutoplayHeaderApplication:()=>n});var i=t(785893),o=t(504190),s=t(869048),l=t(86894),a=t(790074);function n({autoplayService:e}){const _=(0,o.useStore)(e.$toggleSupported),t=(0,o.useStore)(e.$enabled),n=(0,o.useStore)(e.setEnabledFx.pending);return(0,i.jsx)(s.AppRootProvider,{children:(0,i.jsx)(a.AutoplayHeader,{autoplaySwitch:_&&(0,i.jsx)(l.Switch,{checked:n?!t:t,disabled:n,onChange:_=>{e.setEnabledFx(_.target.checked)}})})})}},790074:(e,_,t)=>{t.d(_,{AutoplayHeader:()=>l});var i=t(785893),o=t(29271),s=t(972520);function l(e){return(0,i.jsxs)("div",{className:s.default.header,children:[(0,i.jsxs)("div",{className:s.default.content,children:[(0,i.jsx)("h2",{className:"CatalogBlock__title",children:o.getLang("audio_autoplay_title")}),(0,i.jsx)("div",{className:"CatalogBlock__subtitle",children:o.getLang("audio_autoplay_subtitle")})]}),(0,i.jsx)("div",{className:s.default.actions,children:e.autoplaySwitch})]})}},958721:(e,_,t)=>{t.d(_,{AutoplayHeaderApplication:()=>i.AutoplayHeaderApplication});var i=t(366965)},724768:(e,_,t)=>{t.d(_,{FullscreenBanner:()=>n});var i=t(363444),o=t(514986),s=t(479853),l=t(193452),a=t(957973);class n{static initiate(e){n.fetch(e).then((({banner:_,bannerId:t})=>_?new n(e,t,_):null)).catch((()=>null))}show(){this.box.show(),this.startView=this.productCollector.getCurrentTime()}hide(){this.box.hide(),this.sendViewStat()}sendViewStat(){const e={end_view:this.productCollector.getCurrentTime(),start_view:this.startView},_={type:a.EventItemType.AUDIO_FULLSCREEN_BANNER,id:this.bannerId,track_code:this.sectionId};this.viewCollector.logEvent(e,_)}static fetch(e){return new Promise(((_,t)=>{i.ajax.post("/audio?act=get_fullscreen_banner",{section_id:e},{onDone:e=>{var i;(null==(i=e)?void 0:i.bannerId)?_(e):t()},onFail:()=>(t(),!0)})}))}addEventListeners(){const e=this.box.bodyNode.querySelector(".FullscreenBanner__closeButton");e&&e.addEventListener("click",this.close.bind(this));this.box.bodyNode.querySelectorAll(".FullscreenBanner__button").forEach((e=>{e.addEventListener("click",(()=>{this.consume(e.dataset.reason||s.ConsumeReason.Click),setTimeout((()=>this.hide()))}))}))}close(){this.consume(s.ConsumeReason.Close),this.hide()}consume(e){i.ajax.post("/al_audio.php?act=consume_banner",{id:this.bannerId,type:"fullscreen",track_code:this.sectionId,reason:e})}constructor(e,_,t){this.sectionId=e,this.bannerId=_,this.productCollector=new l.ProductionStatCollector,this.viewCollector=new l.ViewStatCollector(this.productCollector),this.box=new o.MessageBox({bodyStyle:"padding: 0",width:655,containerClass:"FullscreenBanner",noControls:!0,onHide:()=>this.consume(s.ConsumeReason.Close)}),this.box.content(t),this.addEventListeners(),this.show()}}},159601:(e,_,t)=>{t.d(_,{ensureAudioPageMyAudioPlaylistsService:()=>u});var i=t(11010),o=t(434788),s=t(798116),l=t(778748),a=t(360731),n=t(108155),r=t(367431),d=t(72305);const u=(0,r.makeSharedState)("global/audio/audioPage/myPlaylists",(()=>function({config:e,myAudioPlaylistsService:_}){const t=(0,l.getEffectorServiceDomain)(e),s=t.createStore({}),r=t.createEffect((0,i._)((function*(e){return yield _.createFx((0,o._)({},e))}))),d=t.createEffect((0,i._)((function*(e){yield _.deleteFx((0,o._)({},e))})));return s.on(r.done,((e,{params:_,result:t})=>(0,a.addPairToMap)(e,{key:_.blockId,value:t}))),s.on(d.done,((e,{params:_})=>(0,n.removePairFromMap)(e,_.blockId))),{createFx:r,deleteFx:d,setUserId:_.setUserId,$myAudioPlaylistsIdentitiesMap:s}}({config:{domain:(0,s.createDomain)("global/audio/audioPage/myPlaylists"),name:"global/audio/audioPage/myPlaylists"},myAudioPlaylistsService:(0,d.ensureMyAudioPlaylistsService)()})),{version:1})},750499:(e,_,t)=>{t.d(_,{ensureAudioPageMyAudioPlaylistsService:()=>i.ensureAudioPageMyAudioPlaylistsService});var i=t(159601)},503756:(e,_,t)=>{t.d(_,{ensureAudioPageMyAudioPlaylistsService:()=>i.ensureAudioPageMyAudioPlaylistsService});var i=t(750499)},105943:(e,_,t)=>{t.d(_,{AudioAdActionsModalApplication:()=>d});var i=t(785893),o=t(667294),s=t(384627),l=t(869048),a=t(846681),n=t(376396),r=t(675372);function d({target:e,ad:_,onClosed:t}){const[d,u]=(0,o.useState)((()=>{const t=_.choices.map(n.mapChoiceToActionChoice);return t.length?(0,i.jsx)(s.DropdownActionSheet,{shown:!0,onShownChange:e=>{e||u(null)},content:(0,i.jsx)(i.Fragment,{children:t.map((({label:e,action:_},t)=>(0,i.jsx)(s.DropdownActionSheet.Item,{onClick:_,children:e},t)))}),children:(0,i.jsx)(r.ForwardElementRef,{element:e})}):null}));return(0,a.useUpdateEffect)((()=>{d||t()}),[d]),(0,i.jsx)(l.AppRootProvider,{children:d})}},764821:(e,_,t)=>{t.d(_,{AudioAdActionsModalController:()=>l});var i=t(243859),o=t(105943);let s;class l{static ensure(){return s||(s=new l),s}open(e,_){this.mount(e,_)}close(e){e&&e!==this.currentTarget||this.unmount()}isOpen(e){return(!e||e===this.currentTarget)&&this.initiator.isMounted()}unmount(){this.initiator.unmount(),this.currentTarget=null}mount(e,_){this.isOpen(e)||(this.currentTarget=e),this.initiator.render({target:e,ad:_,onClosed:this.handleClosed})}constructor(){this.initiator=(0,i.createReactInitiator)(o.AudioAdActionsModalApplication),this.handleClosed=()=>{this.unmount()}}}},675372:(e,_,t)=>{t.d(_,{ForwardElementRef:()=>i});const i=(0,t(667294).forwardRef)((function({element:e,getRootRef:_},t){return _&&o(_,e),o(t,e),null}));function o(e,_){e&&("function"==typeof e?e(_):e.current=_)}},993951:(e,_,t)=>{t.d(_,{AudioCatalogVkMixBlock:()=>d});var i=t(785893),o=t(667294),s=t(545637),l=t(86894),a=t(718409),n=t(747729),r=t(715417);function d({id:e,backgroundAnimationUrl:_,description:t,title:d}){const[u,c]=(0,o.useState)("pause");return(0,i.jsxs)("div",{className:r.default.root,children:[(0,i.jsxs)("div",{className:r.default.wrap,children:[(0,i.jsx)(s.Div,{paddingTop:0,children:(0,i.jsx)(n.AudioStateButton,{state:u,ariaLabelPlay:"play",ariaLabelPause:"pause",onChange:()=>{c((e=>"pause"===e?"play":"pause"))}})}),(0,i.jsx)(s.Div,{mode:"horizontal",spacing:4,children:(0,i.jsx)(l.Title,{level:"2",children:d})}),(0,i.jsx)(s.Div,{paddingBottom:0,mode:"horizontal",spacing:0,children:(0,i.jsx)(l.Footnote,{children:t})})]}),(0,i.jsx)(a.Lottie,{options:{width:910,height:248,lazyLoading:!0,loop:!0,upscale:!0,autoplay:!1,group:e,animationUrl:_},play:"play"===u})]})}},521693:(e,_,t)=>{t.d(_,{AudioStateButton:()=>u});var i=t(785893),o=t(667294),s=t(86894),l=t(832117),a=t(501129),n=t(568408),r=t(173607);function d({state:e,onChange:_,ariaLabelPlay:t,ariaLabelPause:o}){const d=function(e){switch(e){case"play":return(0,i.jsx)(l.Icon48PauseButton,{className:r.default.stateIcon});case"pause":return(0,i.jsx)(a.Icon48PlayButton,{className:r.default.stateIcon});default:return(0,n.expectNever)(e)}}(e),u="play"===e?t:o;return(0,i.jsx)(s.Tappable,{hoverMode:"opacity",activeMode:"opacity",onClick:_,"aria-label":u,children:d})}const u=(0,o.memo)(d)},747729:(e,_,t)=>{t.d(_,{AudioStateButton:()=>i.AudioStateButton});var i=t(521693)},642273:(e,_,t)=>{t.d(_,{AudioCatalogVkMixBlock:()=>i.AudioCatalogVkMixBlock});var i=t(993951)},233546:(e,_,t)=>{t.d(_,{AudioCatalogVkMixBlockAplication:()=>a});var i=t(434788),o=t(785893),s=t(869048),l=t(642273);const a=e=>(0,o.jsx)(s.AppRootProvider,{children:(0,o.jsx)(l.AudioCatalogVkMixBlock,(0,i._)({},e))})},331354:(e,_,t)=>{t.d(_,{AudioCatalogVkMixBlockAplication:()=>i.AudioCatalogVkMixBlockAplication});var i=t(233546)},605101:(e,_,t)=>{function i(){return{icon:'<svg fill="none" height="8" viewBox="0 0 12 8" width="12" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M2.16 2.3a.75.75 0 0 1 1.05-.14L6 4.3l2.8-2.15a.75.75 0 1 1 .9 1.19l-3.24 2.5c-.27.2-.65.2-.92 0L2.3 3.35a.75.75 0 0 1-.13-1.05z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"dropdown_12"}}t.d(_,{getIcon12Dropdown:()=>i})},668871:(e,_,t)=>{function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="playlist_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="playlist_24__playlist_24"><path id="playlist_24__Shape" d="M0 0h24v24H0z"/><path d="M13 6.88c0-.48-.4-.88-.88-.88H2.88C2.4 6 2 6.4 2 6.88v.24c0 .48.4.88.88.88h9.24c.49 0 .88-.4.88-.88v-.24Zm0 4c0-.48-.4-.88-.88-.88H2.88c-.49 0-.88.4-.88.88v.24c0 .48.4.88.88.88h9.24c.49 0 .88-.4.88-.88v-.24ZM2 15.12v-.24c0-.48.4-.88.88-.88h4.23c.5 0 .89.4.89.88v.24c0 .48-.4.88-.89.88H2.88c-.49 0-.88-.4-.88-.88Zm15 .7c0 3.74-.99 4.64-3.77 5.13-1.48.26-3.23-.48-3.23-2.8 0-1.15.72-2.23 2.2-2.51 1.12-.22-.43.05 2.12-.42.62-.12.69-.34.69-.81L15 12.56V5.98c0-1.1.83-1.5 2.6-1.85 0 0 2.34-.34 3.82-.61.33-.06.58.06.58.44V7.4c0 .37-.15.54-.53.6-1.5.27-3.99.65-3.99.65-.33.08-.48.32-.48.65v6.51Z" id="playlist_24__Mask" fill="currentColor"/></g></g></svg>',name:"playlist_24"}}t.d(_,{getIcon24Playlist:()=>i})},141943:(e,_,t)=>{function i(){return{icon:'<svg width="56" height="56" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg"><g id="playlist_outline_56__Icons-56/playlist_outline_56" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="playlist_outline_56__playlist_outline_28"><path id="playlist_outline_56__playlist_outline_56" d="M0 0h56v56H0z"/><path d="M39 38.93c0 4.55-1.94 7.97-5.07 9.62-2.84 1.5-6.24 1.22-8.22-.76-2.04-2.04-2.3-5.5-.58-8.3C27 36.44 30.77 34.61 36 34.5V16.76a6.88 6.88 0 0 1 5.03-6.68c1.08-.36 3.24-.92 6.5-1.67l1.64-.37A1.5 1.5 0 0 1 51 9.5v4.2a6.7 6.7 0 0 1-4.97 6.48L39 22.05Zm-3-1.42h-.4c-4 .18-6.67 1.53-7.91 3.54-1.02 1.66-.88 3.6.14 4.62.98.98 2.96 1.14 4.7.22 2.12-1.11 3.47-3.5 3.47-6.96V37.5ZM27.5 22a1.5 1.5 0 0 1 0 3h-19a1.5 1.5 0 0 1 0-3h19ZM48 11.38a83.8 83.8 0 0 0-6.03 1.54l-.21.08c-1.93.71-2.8 2.05-2.76 4.33v1.62l6.25-1.67A3.7 3.7 0 0 0 48 13.71ZM30.5 10a1.5 1.5 0 0 1 0 3h-22a1.5 1.5 0 0 1 0-3h22Z" id="playlist_outline_56__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"playlist_outline_56"}}t.d(_,{getIcon56PlaylistOutline:()=>i})},322498:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{AudioPage:()=>AudioPage,currentAudioPage:()=>currentAudioPage});var _swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(11010),_swc_helpers_extends__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(434788),_shared_evbus__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(283452),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(301230),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(95432),_web_lib_fx__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(893106),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(504867),_shared_lib_date__WEBPACK_IMPORTED_MODULE_58__=__webpack_require__(722082),_shared_audio_formatters_formatAudioTime__WEBPACK_IMPORTED_MODULE_57__=__webpack_require__(220126),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(10645),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(584356),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(438221),_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(215066),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(953908),_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(866310),_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(589806),_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(984133),_web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(134540),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(145669),_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(664988),_web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(258810),_web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(276125),_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(379610),_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(795558),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(514986),_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(672132),_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(705758),_web_grid_sorted__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(444402),_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(725296),_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(221780),_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(508249),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(320422),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(9480),_shared_audio_enums__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(182525),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(82161),_web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(514282),_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(724768),_icons_desktop__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(141943),_icons_desktop__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(614271),_icons_desktop__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(329191),_icons_desktop__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(91525),_icons_desktop__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(668871),_icons_desktop__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(475117),_icons_desktop__WEBPACK_IMPORTED_MODULE_59__=__webpack_require__(605101),_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(459474),_shared_lib_storage__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(307411),_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(659397),_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(258169),_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(550536),_player_radiostation_unfollowRadiostation__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(604681),_player_radiostation_followRadiostation__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(347765),_shared_audioplayer_AudioPlayerAdapter_audioTuple_audioTupleToAudioObject__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(595509),_web_audio_components_AutoplayBlock__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(541983),_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(764821),_shared_ranges__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(931917),_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(970978),_web_audio_player_playlist_addAudioPlaylistToMyAudioPlaylists__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(27655),_web_audio_services_AudioPage__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(503756),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(839470),_AudioCatalogVkMixBlockTq__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(391207);const SLIDER_TIMEOUT=1e4;let sectionsToUpdate=[];function currentAudioPage(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_layout",e);return!!_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(_,"audioPage")}function AudioPage(e,_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(e,"audioPage",this),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(cur.lang||{},_.langs),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().langs=_.langs,this._data=_,this._ownerId=_.ownerId,_.playlists&&_.playlists.length&&(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().addWithReplacePlaylists(_.playlists.filter(Boolean)),this.isLayer()||(cur.audioPage=this),this.isLayer()&&uiSearch.init("audio_search_layer"),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.toggleAudioHQBodyClass(),this._els={pageContainer:e,sections:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_sections",e),playerWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_wrap",e),player:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player",e),contentBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_content_block",e),scrollWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_content_block_wrap",e),searchSectionAudios:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_search__local_audios_list",e),searchSectionAudiosHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_section_search__local_audios_header",e),searchSectionPlaylists:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_search__local_playlists_list",e),searchSectionPlaylistsHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_search__local_playlists_header",e),searchNoLocalResults:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_local_no_results",e),searchGlobalBlocks:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__blocks",e),searchGlobalCommunitiesPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__communities_place",e),searchGlobalPlaylistsPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__playlists_place",e),searchGlobalArtistsPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__artists_place",e),searchGlobalAudiosBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__audios_block",e),searchGlobalAudiosBlockHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__audios_header",e),searchGlobalAudiosList:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__audios_list",e),searchInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ui_search_field",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_search",e)),footer:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__footer",e),footerNowPlayingInfo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__footer_now_playing",e),footerClearNowPlayingButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__footer_clear_playlist",e)},this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),this._readyAudio=this._data.readyAudio;const t=this._data.readyPlaylist;t&&(this._pagePlaylist=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(t.type,t.ownerId,t.id),this._pagePlaylist.mergeWith(t)),!this._readyAudio&&this._pagePlaylist&&(this._readyAudio=this._pagePlaylist.getAudioAt(0)),this._data.playlistCoverUploadOptions&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[this._ownerId]=this._data.playlistCoverUploadOptions),this.isLayer()||(cur.module=_.module||"audio",cur.oid=this._ownerId,+this._ownerId==+vk.id?cur.submodule="my":_shared_ranges__WEBPACK_IMPORTED_MODULE_43__.Ranges.isGroupId(this._ownerId)?cur.submodule="group_list":cur.submodule="user_list"),vk.id&&this._initPlayer(),this.initNavigation(),_shared_lib_storage__WEBPACK_IMPORTED_MODULE_34__.vkLocalStorage.getItem(_shared_audio_enums__WEBPACK_IMPORTED_MODULE_29__.AUDIO_PLAYER_ENUMS.ONBOARDING_ARTISTS_LS_KEY)&&AudioPage.showRecomsOnboarding(!0),this.catalogController=new _web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_31__.CatalogController(e),this.showSection(_.initSection,null,this._data.onlySkeleton),_.initSection||this.catalogController.initBlocksManually();const i=new URLSearchParams(location.search);this.defaultSection=!i.get("section")&&_.initSection||"general",this._initSearchParams(),this.promoAlbumSlideInit(),this._els.searchInput&&this._els.searchInput.focus(),this.isLayer()||this.isPodcastPage()||!nav.objLoc.q||"search_playlists"===nav.objLoc.section||this._els.searchInput&&(this._els.searchInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.winToUtf)(nav.objLoc.q),this._showSearchSection(nav.objLoc)),this.updateCurrentPlayingInfo(),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().setStatusExportInfo(this._data.export),this.updateStatusExportControls(),this._initKeyEvents(),window.onAudioPageLoaded&&(window.onAudioPageLoaded.call(this),delete window.onAudioPageLoaded),this.updateShuffleButton(),this.loadMarketItemsCarousel()}(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setStartupHandler("AudioCatalogVkMixBlock/init",_AudioCatalogVkMixBlockTq__WEBPACK_IMPORTED_MODULE_48__.AudioCatalogVkMixBlockTq),AudioPage.address="audio",AudioPage.initedFromAudioTs=!1,AudioPage.updateSearchHighlight=function(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_playlist",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_layout",this));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(_,"audio_search_focused","focus"===e.type)},AudioPage.onSearchFocused=function(e){AudioPage.updateSearchHighlight(e)},AudioPage.prototype.updatePlaylistsCounter=function(e){if(cur.audioPage&&e===cur.audioPage.getOwnerId()){let e;if(e=cur.audioPage._els.pageContainer.querySelector(".CatalogBlock__own_only_playlists_header .CatalogBlock__title"),e){const _=cur.audioPage._data.playlists.length;e.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(_,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_playlists_count_title")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_section_layout",e),"audio_section_empty",!_)}}},AudioPage.getCoverImage=function(e,_){let t="";if(e)t=`<img alt="${(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_35__.escape)(_)}" width='143px' height='143px' src="${e}" loading='lazy' />`;else{const{icon:e}=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_49__.getIcon56PlaylistOutline)();t=`<div class="audio_pl_cover_placeholder">${e}</div>`}return t},AudioPage.setCoverImageElem=function(e,_,t){if(_){const i=e.querySelector(".audio_pl_cover_placeholder"),o=e.querySelector("img");o&&e.removeChild(o),i&&e.removeChild(i);const s=new Image;s.src=_,s.setAttribute("alt",(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_35__.escape)(t)),s.setAttribute("width","143px"),s.setAttribute("height","143px"),s.setAttribute("loading","lazy"),e.appendChild(s)}else{const _=e.querySelector("img");if(_){e.removeChild(_);const{icon:t}=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_49__.getIcon56PlaylistOutline)(),i=document.createElement("div");i.classList.add("audio_pl_cover_placeholder"),i.innerHTML=t,e.appendChild(i)}}},AudioPage.deletePlaylist=function(e,_,t){const i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,e,_);let o=AudioPlayer.getLang("audio_sure_delete_playlist_box_text");o=o.replace("{name}",i.getTitle()),o='<div style="overflow: hidden; text-overflow: ellipsis;">'+o+"</div>",(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:AudioPlayer.getLang("audio_sure_delete_playlist_box_title")},o,AudioPlayer.getLang("audio_sure_delete_playlist_box_yes"),function(){ajax.post("al_audio.php?act=delete_playlist",{hash:t,playlist_owner_id:e,playlist_id:_,page_owner_id:cur.audioPage?cur.audioPage.getOwnerId():0},{onDone:function(e){if(cur.audioPage){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section__all",cur.audioPage.getPageContainer()),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_block__playlists_items",_);if(_&&t){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(t,"max-items"));if(e&&t.children.length<_){const{thumb:_,title:i}=e;e.cover_image=AudioPage.getCoverImage(_,i),t.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_pl_item",e)))}t.children.length||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_section_layout",t),"no_playlists"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_titled_block",t)))}}},onFail:()=>!0});const i=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.getBoxQueue)();if(i&&i.hideAll(!0),layers&&layers.fullhide&&layers.fullhide(),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_pl_"+e+"_"+_),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(this)})),window.location.pathname.includes(`/music/playlist/${window.vk.id}`))return window.history.length>2?void window.history.back():void document.location.replace(`https://${window.vk.apiConfigDomains.domain}/music?section=${cur.audioPage.defaultSection}`);if(cur.audioPage){if(cur.audioPage._data.playlists=cur.audioPage._data.playlists.filter((function(t){return!(t.id==_&&t.owner_id==e)})),!cur.audioPage._data.playlists.length)return void nav.reload();cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(e)}}.bind(this),_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_cancel"))},AudioPage.prototype.getCurrentSection=function(){return this._currentSection},AudioPage.prototype.getOwnerPlaylists=function(){return this._data.playlists},AudioPage.loadPlaylists=function(ownerId,totalCount,skipFirstChunk,forAttachBox,onDone){const chunkSize=50,chunks=[];(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(totalCount)&&(onDone=totalCount,totalCount=void 0,skipFirstChunk=!1),cur.playlistsCache=cur.playlistsCache||{};const cacheKey=ownerId+"_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(skipFirstChunk);if(cur.playlistsCache[cacheKey])return onDone(cur.playlistsCache[cacheKey]);function onAllLoaded(){let e=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(chunks,(function(_,t){t&&(e=e.concat(t))})),cur.playlistsCache=cur.playlistsCache||{},cur.playlistsCache[cacheKey]=e,onDone&&onDone(e)}function _loadChunk(chunkIndex,_cb){const groupId=cur.group_id||(_shared_ranges__WEBPACK_IMPORTED_MODULE_43__.Ranges.isGroupId(cur.oid)?-cur.oid:0);ajax.post("al_audio.php?act=owner_playlists",{owner_id:ownerId,group_id:groupId,offset:chunkIndex*chunkSize,is_attach:forAttachBox?1:0},{onDone:function(playlists,totalCount,additionalData){additionalData.templates_script&&eval(additionalData.templates_script),additionalData.langs&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(cur.lang,additionalData.langs),additionalData.audio_playlist_cover_upload_options&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[ownerId]=additionalData.audio_playlist_cover_upload_options),chunks[chunkIndex]=playlists,_cb(totalCount)},onFail:function(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLoader),e)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},e),!0}})}function _loadAllChunks(e,_,t){const i=Math.ceil(e/chunkSize);if(i&&i-_!=0){const e=new callHub(t,i-_);for(let t=_;t<i;t++)_loadChunk(t,(function(){e.done()}))}else t()}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(totalCount)?_loadChunk(0,(function(e){_loadAllChunks(e,1,onAllLoaded)})):_loadAllChunks(totalCount,skipFirstChunk?1:0,onAllLoaded)},AudioPage.prototype.getOwnerId=function(){return+this._ownerId},AudioPage.prototype.getPageContainer=function(){return this._els.pageContainer},AudioPage.prototype.getCurrentSectionEl=function(){return this.catalogController.currentSection&&this.catalogController.currentSection.getSectionElement()},AudioPage.prototype.canAddToGroup=function(){return this._data.canAudioAddToGroup},AudioPage.prototype.canEditGroup=function(){return this._data.canEdit},AudioPage.prototype.updateCurrentPlayingInfo=function(){if(!this.isLayer())return;const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),_=e.getCurrentPlaylist();let t=_?_.getTitle():"";if(_&&null!==_.getTitleLang()&&window.langConfig&&window.langConfig.id!==_.getTitleLang()&&ajax.post("al_audio.php?act=get_playlist_info",{owner_id:_.getOwnerId(),playlist_id:_.getAlbumId(),access_hash:_.getAccessHash()},{onDone:t=>{_.updatePlaylist(t)&&(e.saveStateCurrentPlaylist(),this.updateCurrentPlayingInfo())},onFail:()=>{}}),t){let e=_.getOriginalPlaylistRawId();if(_.getBlockId()){t=`<a href="${`/audio?section=recoms_block&type=${_.getBlockId()}`}"\n                  class="audio_page__footer_now_playing_link">\n                  ${t}\n                </a>`}else if(e||_.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST&&0!==_.getAlbumId()){let i,o,s;e?(e=e.split("_"),i=e[0],o=e[1],s=e[2]||""):(i=_.getOwnerId(),o=_.getAlbumId(),s=_.getAccessHash()||"");t=`<a href="${nav.toStr((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({},nav.objLoc,{z:"audio_playlist"+i+"_"+o+(s?"/"+s:"")}))}"\n                  class="audio_page__footer_now_playing_link"\n                  onclick="if (checkEvent(event)) { return true } else { AudioUtils.showAudioPlaylist(${i}, ${o}, '${s}'); return cancelEvent(event) }">\n                  ${t}\n                </a>`}this._els.footerNowPlayingInfo.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_current_playing_from").replace("{playlist}",t)}else{const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio();if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(e)){const _=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_podcast_playing");this._els.footerNowPlayingInfo.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_current_playing_from").replace("{playlist}",_.replace("{name}",e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]))}else this._els.footerNowPlayingInfo.innerHTML=""}this._els.footerClearNowPlayingButton.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_clear_current_playlist"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(this._els.footer,!!_)},AudioPage.prototype.onSearchFiltersChanged=function(e){const _=window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer())],t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this._searchSortFilter.selectedItems()[0][0]),i={performer:_.val?1:null,lyrics:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer),"on")?1:null,sort:t?1:null};this.syncParametersUI(i);let o=e&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isObject)(e)?e:i;this.isLayer()&&(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({},this._prevLoc,o)),nav.change(o,!1,{fromSearch:!0,filtersChanged:!0})},AudioPage.prototype._initSearchParams=function(){window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer())]={els:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_search_type",this._els.pageContainer),keep:this.isLayer()};const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_sort",this._els.pageContainer);e&&(this._searchSortFilter=new window.Dropdown(e,this._data.sortFilters,{big:1,zeroPlaceholder:!0,onChange:this.onSearchFiltersChanged.bind(this)})),this.isLayer()||this.syncParametersUI(nav.objLoc)},AudioPage.prototype.syncParametersUI=function(e){const _="audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer()),t=window.radioBtns[_];t&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.radiobtn)(t.els[e.performer?1:0],!!e.performer,_);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(i,"on",!!e.lyrics);const o={performer:AudioPlayer.getLang("audio_performers_only"),lyrics:AudioPlayer.getLang("audio_search_with_text"),sort:AudioPlayer.getLang("audio_search_by_length")},s=this._els.searchInput;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(["performer","lyrics","sort"],(function(_,t){uiSearch.toggleFilter(s,t,o[t],!!e[t])}))},AudioPage.onFilterRemoved=function(e,_,t){const i=currentAudioPage(_);(function(){switch(e){case"performer":const e="audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer()),_=window.radioBtns[e];(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.radiobtn)(_.els[0],0,e);break;case"sort":const t=this._searchSortFilter.options.defaultItems[0][0];this._searchSortFilter.selectItem(t,!1);break;case"lyrics":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer),"on")}t||this.onSearchFiltersChanged()}).apply(i)},AudioPage.prototype._showSearchSection=function(e){this._toggleSearchProgress(!0);const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")){const _=e.globalQuery||e.q;this._sectionData={q:_,performer:e.performer};const t=void 0!==e.fromSuggestsAcceptId;t||(this._cur_qid=(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__.generateQID)()),this.showSection("search",function(){if(_){const i=this._data.sectionData.search?this._data.sectionData.search.qid:0;(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__.saveSearchAttemptStats)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__.serviceAudio,0,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.isVisible)(this._els.searchNoLocalResults),_,i,void 0,void 0,void 0,void 0,t&&e.fetchedQuery,void 0,void 0,e.fromSuggestsAcceptId)}this._toggleSearchProgress(!1)}.bind(this))}else _.loadAll(function(){this._toggleSearchProgress(!1),this._doShowSearchSection(e)}.bind(this))},AudioPage.prototype._toggleSearchProgress=function(e){this._els.searchInput&&!this._muteSearch&&(e?uiSearch.showProgress(this._els.searchInput):uiSearch.hideProgress(this._els.searchInput))},AudioPage.prototype._doShowSearchSection=function(e){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();if(e&&(this._prevSearchParams=e),!(e=e||this._prevSearchParams))return;let t=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(e.q)+(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(e.globalQuery||"");(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(["performer","lyrics","sort"],(function(_,i){t+=e[i]||0})),t+=this._ownerId,this._toggleSearchProgress(!0);const i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,this._ownerId,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);function o(){i.search(e,function(i){let o="";const s=this._data.playlistsIndex?this._data.playlistsIndex.search(e.q):[];if(this.showSection("search"),s.length){let e="";(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(s,(function(_,t){t.cover_image=AudioPage.getCoverImage(t.thumb,t.title),e+=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_pl_item",t)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchSectionPlaylistsHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchSectionPlaylists),o=+this._ownerId===vk.id?_.langs.audio_found_your_local_playlists:_shared_ranges__WEBPACK_IMPORTED_MODULE_43__.Ranges.isUserId(this._ownerId)?_.langs.audio_found_user_local_playlists:_.langs.audio_found_group_local_playlists,this._els.searchSectionPlaylistsHeader.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(s.length,o),this._els.searchSectionPlaylists.innerHTML=e}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionPlaylistsHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionPlaylists);const l=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__.hashCode)(t));l.mergeWith({list:i,searchParams:{globalQuery:e.globalQuery||e.q,performer:e.performer,lyrics:e.lyrics,sort:e.sort}}),l.setLocalFoundCount(i.length),i.length||s.length?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchNoLocalResults):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchNoLocalResults),o=vk.id===+this._ownerId?_.langs.audio_no_local_results:_shared_ranges__WEBPACK_IMPORTED_MODULE_43__.Ranges.isUserId(this._ownerId)?_.langs.audio_no_user_local_results:_.langs.audio_no_group_local_results,this._els.searchNoLocalResults.innerHTML=o.replace("{query}","<strong>"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(e.q)+"</strong>")),i.length||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionAudiosHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionAudios)),this._pagePlaylist=l,this._toggleSearchProgress(!1)}.bind(this))}i.loadAll(function(){clearTimeout(this._onSilendLoadedTO),this._onSilendLoadedTO=setTimeout(function(){o.call(this)}.bind(this))}.bind(this))},AudioPage.prototype.showFriendMusic=function(e,_){return(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_friends_block","click_friend"),this.isLayer()?nav.go({0:"/audios"+_},!1,{friendId:_}):nav.go("/audios"+_,e),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)},AudioPage.prototype._deinitNavigation=function(){cur.nav.pop(),this._navigationInited=!1},AudioPage.PageSections=["recoms_audio","recoms_block","search_block","recoms_personal","my"],AudioPage.followedRadioClassName="audio_page_player_follow_radiostation--followed";const layerSectionsToMainFrame=["search_block","search_playlists","recoms_block"];function isAdPlayingWithChoices(){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();return e.ads.isActive&&!!e.ads.getCurrentAd()}function makeAudioAdMoreLink(){const e=document.createElement("a");return e.href="#",e.classList.add("audio_page_player_ad_more_link"),e.innerHTML=`${_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_ad_more")} ${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_59__.getIcon12Dropdown)().icon}`,e.addEventListener("click",(e=>{e.preventDefault();const{currentTarget:_}=e,t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),i=_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_42__.AudioAdActionsModalController.ensure();i.isOpen(_)?i.close(_):i.open(_,t.ads.getCurrentAd())})),e}function makeAudioDisableAdsLink(){const e=document.createElement("a");return e.href="/vk_music",e.classList.add("audio_page_player_ad_disable_link"),e.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_ads_off"),AudioPage.initedFromAudioTs||(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_44__.logError)(new Error("AudioPage inited bypassing entrypoint")),e.addEventListener("click",(e=>{e.preventDefault(),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_web_ad_link","click"),nav.go(e.currentTarget.href)})),e}function makeAudioAdPerformerDivider(){const e=document.createElement("span");return e.innerHTML=" · ",e.classList.add("audio_page_player_ad_performer_divider"),e}AudioPage.prototype.initNavigation=function(){this._navigationInited||this.isPodcastPage()||(this._navigationInited=!0,this._prevLoc={},!this.isLayer()&&nav.objLoc.popup&&"recoms_onboarding"===nav.objLoc.popup&&AudioPage.showRecomsOnboarding(),cur.nav.push(function(e,_,t,i){const o=this._ignoreResetedSearch;if(delete this._ignoreResetedSearch,o&&i.fromSearch)return!1;if(i.isLayer&&!this.isLayer())return!1;if(t.popup&&"recoms_onboarding"===t.popup)return AudioPage.showRecomsOnboarding(),nav.setLoc(t),!1;if(t.screen)return;if(this.isLayer()&&!1!==this._prevLoc){_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clone)(this._prevLoc),e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clone)(t);for(let i in _)_.hasOwnProperty(i)&&(_[i]&&void 0===t[i]?e[i]=!1:_[i]==t[i]&&delete e[i])}if(!e||!Object.keys(e).length)return;let s;if(this._deleteDeletedAudios(),this.isLayer()){s=!t.q&&!!_.q&&t.section===_.section?this.prevSection||this.defaultSection:t.section}else s=t.section||this.defaultSection;let l=!1;return 0===t[0].indexOf("podcasts")&&(s="podcast"),i.tab||i.fromSearch||!1===e.q&&1===Object.keys(e).length||i.searchPerformer?l=!1:i.friendId&&this.isLayer()?(s="friend",this.resetSection(s),this._sectionData={friend_id:i.friendId},l=!1):(2!==Object.keys(e).length||!1!==e.q||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(e[0]))&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(e[0])?"signal"===t.section||"signal"===_.section?l=!0:((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(e.section,AudioPage.PageSections)||e.hasOwnProperty("block")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(_.section,AudioPage.PageSections)&&!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(e.section,AudioPage.PageSections))&&(!this.isLayer()||layerSectionsToMainFrame.includes(t.section)||e.hasOwnProperty("block")?l=!0:(l=!1,this._sectionData={audio_id:e.audio_id},s="recoms",delete this._currentSection)):l=!0,l?(this.catalogController&&this.catalogController.destroy(),!0):(t.q?(this._els.searchInput&&!i.fromSearch&&(this._els.searchInput.value=t.q,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.triggerEvent)(this._els.searchInput,"keyup",{},!0),this.lastQuery=t.q),this._showSearchSection((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({},t,i))):(this._ignoreResetedSearch=!1===e.q,this._els.searchInput&&uiSearch.reset(this._els.searchInput,!0),this.showSection(s),this._switchTab(s)),this.isLayer()?this._prevLoc=t:nav.setLoc(t),(i.back||i.hist||i.nav)&&this.syncParametersUI(t),!1)}.bind(this)))},AudioPage.prototype._deleteDeletedAudios=function(){const e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAddRestoreInfo();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(e,(function(e,_){"deleted"!==_.state&&"recom_hidden"!==_.state||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().deleteAudioFromAllPlaylists(e)}))},AudioPage.prototype._switchTab=function(e){if(this.isPodcastPage())return;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__"+e,this._els.pageContainer);_?uiTabs.switchTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domFC)(_)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ui_tab_sel",this._els.pageContainer),"ui_tab_sel")},AudioPage.prototype.onLayerHide=function(){this._deinitNavigation(),this._deinitKeyEvents(),this._onSectionOut(),delete this._currentSection,this._muteSearch=!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchNoLocalResults),setTimeout((()=>uiSearch.reset(this._els.searchInput)),1e3)},AudioPage.prototype.updateLayerHeight=function(){let e=700;e=Math.min(e,window.innerHeight-150),e=Math.max(e,400),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.isVisible)(this._els.footer)&&(e-=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.footer)[1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(this._els.scrollWrap,{height:e}),this._els&&this._els.scrollWrap&&"function"==typeof this._els.scrollWrap.updateScroll&&this._els.scrollWrap.updateScroll()},AudioPage.prototype.scrollToCurrentTrack=function(){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio(),_=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue();if(this._audioRowsAutoList&&e&&_.indexOfAudio(e)>=0){let e=10;for(;e--;){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_CURRENT_CLS,this._audioRowsAutoList.getListEl());if(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(e)[1];this._scroll.scroller.scrollTop=_-(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)()-300,this._scroll.update(),this._layerStartInit=!1;break}this._audioRowsAutoList.drawMore(),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().updateCurrentPlaying()}}},AudioPage.prototype.onLayerShow=function(e){this._layerStartInit=!0;const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist(),t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio());if(t)this.showSection("podcast");else if(_)this.showSection("current");else if(e){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue().isEmpty()&&"current"===e?this.showSection("all"):this.showSection(e)}else this.showSection("all");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__current",this._els.pageContainer),"unshown",!_||t),this.initNavigation(),this.updateCurrentPlayingInfo(),this._initKeyEvents(),this.updateLayerHeight(),this.updateShuffleButton(),this.scrollToCurrentTrack(),delete this._muteSearch},AudioPage.prototype.resetSection=function(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section__"+e,this._els.sections);this.catalogController.deleteSection(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(_)},AudioPage.prototype.isUpdateRequested=function(e){return Array.isArray(sectionsToUpdate)&&sectionsToUpdate.includes(e+this.getOwnerId())},AudioPage.prototype.requestUpdate=function(e,_=""){sectionsToUpdate=e.map((e=>e+_))},AudioPage.prototype.showSection=function(e,_,t){this._currentSection&&this._currentSection!==this.prevSection&&(this.prevSection=this._currentSection),this.isPodcastPage()&&(e="podcast"),"search"!==this._currentSection||"all"!==e&&"current"!==e||uiSearch.reset(this._els.searchInput,!0),this._data.onlySkeleton||layers.fullhide&&layers.fullhide(),this._switchTab(e);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")&&"search"===e||this.isUpdateRequested(e);if(this._currentSection===e&&"search"!==this._currentSection)return void((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(_)&&_());if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("search_audio_catalog_web")&&"search"===e)return;this._currentSection=e;const o=this.findSectionElement(e),s=this._data.sectionData&&this._data.sectionData[e]||{};if(s.name=e,t||(this._data.onlySkeleton=!1),o&&(!i||!1===t)&&!this._data.onlySkeleton){if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_section",this._els.pageContainer),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalBlocks),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalCommunitiesPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalPlaylistsPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalArtistsPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalAudiosBlock),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchNoLocalResults),"search"===e&&!o.innerHTML)){var l;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchNoLocalResults);const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),_=vk.id===+this._ownerId?e.langs.audio_no_local_results:_shared_ranges__WEBPACK_IMPORTED_MODULE_43__.Ranges.isUserId(this._ownerId)?e.langs.audio_no_user_local_results:e.langs.audio_no_group_local_results;var a;const t=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.winToUtf)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(null!=(a=null==(l=s.searchParams)?void 0:l.globalQuery)?a:""));this._els.searchNoLocalResults.innerHTML=_.replace("{query}","<strong>"+t+"</strong>")}if(this._onSectionOut(),delete cur._back,"podcast"!==e&&(this.catalogController.setSection(e,o,s||{}),!this.isLayer()&&_shared_ranges__WEBPACK_IMPORTED_MODULE_43__.Ranges.isUserId(window.vk.id)&&_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_32__.FullscreenBanner.initiate(s.sectionId)),this._destroyAutoplayBlock(),this._onSectionOut((()=>{this.catalogController.disableSection(e)})),this.isLayer()||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist()||!s.title||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setDocumentTitle)(s.title),!["podcast","current"].includes(e))return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(_)&&_(),void(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().updateCurrentPlaying();switch(e){case"current":this._initSection_current(o,s,!0);break;case"podcast":this._initSection_podcast(o,s)}return(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().updateCurrentPlaying(),void((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(_)&&_())}let n=this._ownerId,r=!1;if("podcast"===e&&!this.isPodcastPage()){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;n=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID];(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_37__.getAudioExtra)(e).voiceAssistant&&(r=!0)}if(this.isUpdateRequested(e)&&(sectionsToUpdate=null),r)return void setTimeout((()=>{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)(`<div class="audio_section _audio_section _audio_section__${e} audio_section__${e} clear_fix audio_w_covers">\n        <div class="page_block audio_block">\n          <div class="audio_page__audio_rows _audio_page__audio_rows">\n            <div class="audio_page__audio_rows_list _audio_page__audio_rows_list audio_w_covers"></div>\n          </div>\n        </div>\n      </div>`);this._els.sections.appendChild(t),delete this._currentSection,this.showSection(e,_,!1)}));let d="",u={};if(this._data.onlySkeleton&&s.sectionId)d="/audio?act=load_catalog_section",u.section_id=s.sectionId;else{d="al_audio.php";const _={act:"section",section:e,owner_id:n,is_layer:this.isLayer()?1:0,claim:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(nav.objLoc.claim)};"search"===e&&(_.query_id=this._cur_qid),u=(0,_swc_helpers_extends__WEBPACK_IMPORTED_MODULE_50__._)({},this._sectionData,_)}ajax.post(d,u,{onDone:(t,i)=>{this._data.sectionData=this._data.sectionData||{};this.findSectionElement(e)&&t&&this.resetSection(e),this._data.sectionData[e]=i;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)('<div class="audio_section _audio_section _audio_section__'+e+" audio_section__"+e+' clear_fix audio_w_covers">'+t+"</div>");this._els.sections.appendChild(o),delete this._currentSection,this.showSection(e,_,!1)},onFail:()=>!0}),delete this._sectionData},AudioPage.prototype._onSectionOut=function(e){e?(this._onSectionOutCbs=this._onSectionOutCbs?this._onSectionOutCbs:[],this._onSectionOutCbs.push(e)):((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(this._onSectionOutCbs||[],(function(e,_){_()})),this._onSectionOutCbs=[])},AudioPage.prototype.findSectionElement=function(e){const[_]=this._els.sections.getElementsByClassName("_audio_section__"+e);return _},AudioPage.prototype.onPlaylistsReorder=function(e,_,t){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(e,"raw-id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(t,"raw-id");ajax.post("al_audio.php",{act:"reorder_playlist",owner_id:this.getOwnerId(),playlist_id:i.split("_")[1],prev_playlist_id:o?o.split("_")[1]:0,hash:this._data.reorderHash},{onFail:()=>!0})},AudioPage.prototype._initSection_current=function(e,_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(this._els,{audioRows:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__audio_rows_list",e),audioRowsMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_more_rows",e),friendsBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_list_wrap",e),friendsBlockContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_list_content",e)});const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist();if(!t&&!this.retriedCurrent)return this.retriedCurrent=!0,setTimeout((()=>this._initSection_current(e,_)));this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),t&&(this._pagePlaylist=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this._els.audioRows,"playlist-id",t.getId()));const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_search",e);i&&uiSearch.init(i),this._initAudioRowsAutoList(!0),setTimeout((()=>this._initFixedFriendsBlock(e)))},AudioPage.prototype.drawMore=function(){this._audioRowsAutoList&&this._audioRowsAutoList.drawMore()},AudioPage.prototype.scrollIntoView=function(e,_){this._scroll.scrollIntoView(e,_)},AudioPage.prototype._initSection_podcast=function(e,_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(this._els,{audioRows:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__audio_rows_list",e),audioRowsMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("podcast_episodes_more",e)});let t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist();if(!t){const e=_.playlistData;e&&(t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(e.type,e.ownerId,e.id),t.getAudiosCount()||(t.mergeWith(e),t.load()))}t&&(this._pagePlaylist=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this._els.audioRows,"playlist-id",t.getId())),this._initAudioRowsAutoList(),this._data.reverse||this._enableAudioRowsSorter()},AudioPage.prototype.setPagePlaylist=function(e){this._pagePlaylist=e},AudioPage.prototype._initFixedFriendsBlock=function(){if(!this._els.friendsBlock)return;this._isFixed=!1,this._isDraggable=!1,this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.friendsBlock);const e=this.isLayer(),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)("page_header")[1],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.playerWrap)[1],i=e?13:15;this._fixedThreshold=e?_+t+i:this._initialPos[1]-_-t-i;const o=e?this._scroll.scroller:window;if(this._fixedThreshold<0)return;(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"resize",this._resizeHandler=()=>{this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.friendsBlock)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(o,"scroll",this._scrollHandler=()=>{this._moveFriendsBlock()});const s=this;AudioPage.onUpdateDraggablePosition=()=>{s._isDraggable=!0,s._moveFriendsBlock(),requestAnimationFrame((()=>s._isDraggable=!1))},AudioPage.forceFix=()=>{const e=s._els.friendsBlockContent.getBoundingClientRect();if(!(e.width>0&&e.height>0))return;const _=s.isLayer()?s._scroll.scroller.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)();s._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,_-s._fixedThreshold-9)}px)`,s._unfixedFriendsBlock()},this._onSectionOut((()=>{this._scrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(o,"scroll",this._scrollHandler),this._resizeHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"resize",this._resizeHandler),this._fixedBlockScrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.friendsBlockContent,"audio_friends_fixed")}))},AudioPage.prototype._moveFriendsBlock=function(){const e=this.isLayer()?this._scroll.scroller.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)(),_=this._els.friendsBlockContent.getBoundingClientRect(),t=_.width>0&&_.height>0;this._isDraggable&&t?(this._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,e-this._fixedThreshold-9)}px)`,this._unfixedFriendsBlock()):(this._els.friendsBlockContent.style.transform="",e>this._fixedThreshold?this._fixedFriendsBlock():this._unfixedFriendsBlock())},AudioPage.prototype._fixedFriendsBlock=function(){this._isFixed||(this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.friendsBlock),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!0,this.isLayer()&&(this._fixedBlockScrollHandler=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(this._els.friendsBlockContent,"mousewheel",(e=>(this._scroll.scroller.scrollTop=this._scroll.scroller.scrollTop+e.deltaY,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e))))))},AudioPage.prototype._unfixedFriendsBlock=function(){this._isFixed&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!1,this._fixedBlockScrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler))},AudioPage.prototype.playPlaylist=function(e,_,t,i){const o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),s=o.getCurrentPlaylist(),l=o.getPlaylist(e,_,t);s&&s.equals(l)&&o.isPlaying()?o.pause():l.load(0,(function(){o.play(l.getAudiosList()[0],l,i)}))},AudioPage.prototype.playShuffledBlockPlaylist=function(e){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),t=_.getPlaylistByBlockId(e)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist({hasMore:!0,blockId:e});t.clean(),t.loadByBlockId("",(function(e){_.play(e.getAudiosList()[0],e,e.getContext())}))},AudioPage.prototype.saveAsPlaylist=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_51__._)((function*(e){const _=document.querySelector(".audio_page_save_as_playlist_button"),t=document.querySelector(".audio_page_save_as_playlist_button_text");_.disabled=!0;const i=document.querySelector("#audio_page_save_as_playlist_icon_create"),o=document.querySelector("#audio_page_save_as_playlist_icon_delete"),s=(0,_web_audio_services_AudioPage__WEBPACK_IMPORTED_MODULE_46__.ensureAudioPageMyAudioPlaylistsService)();s.setUserId(vk.id);const l=s.$myAudioPlaylistsIdentitiesMap.getState()[e];if(l){try{yield s.deleteFx({blockId:e,id:l.id}),o.classList.add("audio_page_save_as_playlist_icon_hide"),i.classList.remove("audio_page_save_as_playlist_icon_hide"),t.textContent=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_save_as_playlist_button")}catch(e){console.error("[AudioPage saveAsPlaylist]",e)}finally{_.disabled=!1}return}const a=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistByBlockId(e)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist({hasMore:!0,blockId:e});a.clean(),a.loadByBlockId("",(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_51__._)((function*(l){try{yield(0,_web_audio_player_playlist_addAudioPlaylistToMyAudioPlaylists__WEBPACK_IMPORTED_MODULE_45__.addAudioPlaylistToMyAudioPlaylists)(e,l,s),i.classList.add("audio_page_save_as_playlist_icon_hide"),o.classList.remove("audio_page_save_as_playlist_icon_hide"),t.textContent=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_save_as_playlist_delete_button")}catch(e){console.error("[AudioPage saveAsPlaylist]",e)}finally{_.disabled=!1}})))})),AudioPage.prototype.playBlockPlaylist=function(e,_=null){const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),i=t.getCurrentPlaylist(),o=t.getPlaylistByBlockId(e)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist({hasMore:!0,blockId:e});if(i&&i.equals(o)&&t.isPlaying())t.pause();else{const e=o.getContext()||_&&_.dataset.context||"";o.loadByBlockId("",(_=>t.play(_.getAudiosList()[0],_,e)))}},AudioPage.prototype.onAudioRowsReorder=function(e,_,t,i){const o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(_,"full-id"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(i,"full-id"),a=o.getPlaylistQueue(),n=this.getPageCurrentPlaylist();let r=(e?a:n).indexOfAudio(s),d=(e?a:n).indexOfAudio(l);l?d++:d=0,a.moveAudio(r,d),e&&o.saveStateCurrentPlaylist(),this.isPodcastPage()?ajax.post("al_podcasts.php",{act:"a_reorder_episodes",hash:this._data.audiosReorderHash,oid:this.getOwnerId(),episode_id:s?s.split("_")[1]:0,next_episode_id:l?l.split("_")[1]:0},{onFail:()=>!0}):e||ajax.post("al_audio.php",{act:"reorder_audios",hash:this._data.audiosReorderHash,owner_id:this.getOwnerId(),audio_id:s?s.split("_")[1]:0,next_audio_id:l?l.split("_")[1]:0},{onFail:()=>!0})},AudioPage.prototype._enableAudioRowsSorter=function(e){(this._data.audiosReorderHash||e)&&(this._audioRowsSorter&&this._audioRowsSorter.destroy(),this._audioRowsSorter=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_23__.default(this._els.audioRows,"",{wrapNode:this.isLayer()?this._scroll.scroller:void 0,onReorder:(_,t,i)=>this.onAudioRowsReorder(e,_,t,i)}),this._onSectionOut(function(){this._audioRowsSorter&&this._audioRowsSorter.destroy()}.bind(this)))},AudioPage.prototype._disableAudioRowsSorter=function(){this._audioRowsSorter&&this._audioRowsSorter.disable()},AudioPage.prototype._initAutoplayBlock=function(e,_){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue().isAutoplaySupported&&(this._els.autoplayBlock||(this._els.autoplayBlock=new _web_audio_components_AutoplayBlock__WEBPACK_IMPORTED_MODULE_41__.AutoplayBlock),this._els.autoplayBlock.init(e,_))},AudioPage.prototype._destroyAutoplayBlock=function(){var e;null==(e=this._els.autoplayBlock)||e.destroy()},AudioPage.prototype._onCurrentSectionNeedRows=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_51__._)((function*(e,_){const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue();e(yield t.getAudios(_,_+_shared_audio_enums__WEBPACK_IMPORTED_MODULE_29__.AUDIO_PLAYER_ENUMS.AUDIO_QUEUE_MAX_AUDIOS_COUNT))})),AudioPage.prototype._initAudioRowsAutoList=function(e=!1){if(!this._els.audioRows)return;const _=this.isPodcastPage()||"podcast"===this._currentSection,t=this._pagePlaylist;this._els.audioRows.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.audioRows,"audio_owner_list_canedit",!_&&!!this._data.canEdit),this._audioRowsAutoList&&this._audioRowsAutoList.destroy(),this._audioRowsAutoList=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(this._els.audioRows,{scrollNode:!!this._scroll&&this._scroll.scroller,onRendered:function(){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().updateCurrentPlaying()},onNoMore:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.audioRowsMore),e&&this._initAutoplayBlock(this.getCurrentSectionEl(),this._scroll)}.bind(this),offset:0,onNeedRows:function(i,o,s,l,a){const n=[],r=(e=[])=>{e.forEach((e=>{n.push(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.drawAudio(e))})),i(n),0===o&&this._audioRowsSorter&&this._audioRowsSorter.update(),0===o&&1===n.length&&a.drawMore()};_?((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.lockButton)(this._els.audioRowsMore),this._loadPodcastEpisodes(o,function(e){r((e||[]).slice(o)),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.unlockButton)(this._els.audioRowsMore)}.bind(this))):e?this._onCurrentSectionNeedRows(r,o):t&&t.load(o,(()=>{const e=t.getAudiosList();r(e)}))}.bind(this)}),this._onSectionOut(function(){this._destroyAutoplayBlock(),this._audioRowsAutoList.destroy(),this._els.audioRows.innerHTML=""}.bind(this))},AudioPage.prototype._loadPodcastEpisodes=function(e,_){let t;const i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;let o={};try{o=JSON.parse(i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_EXTRA])}catch(e){}if(o&&o.externalAudio){let e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist();return void _(e._ref._list)}t=this.isPodcastPage()?this._ownerId:i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID],cur._podcastsEpisodes=cur._podcastsEpisodes||{},cur._podcastsEpisodes[t]=cur._podcastsEpisodes[t]||[];const s=cur._podcastsEpisodes[t];s.length&&e<s.length?_(s):ajax.post("al_podcasts.php",{act:"a_episodes",oid:t,episode_full_id:i?i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_ID]:"",offset:e,rev:this._data.reverse,claim:window.nav.objLoc.claim},{onDone:function(e){cur._podcastsEpisodes[t]=s.concat(e||[]),_(cur._podcastsEpisodes[t])},onFail:function(){return _(cur._podcastsEpisodes[t]),!0}})},AudioPage.showAttachBox=function(e,_){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode),"offset")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode),"offset",0),1===vk.widget?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showBox)("al_audio.php",{act:"choose_box",owner_id:e,options:JSON.stringify(_)}):AudioPage.editPlaylist(e,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",_)},AudioPage.editPlaylist=function(e,_,t,i){if(vk.widget)for(let e in i)i.hasOwnProperty(e)&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isString)(i[e])?i[e]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(i[e]):(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(i[e])?delete i[e]:i[e]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(i[e]));let o,s;if("edit"===t&&i&&(i.audioAttachSwitchOwnerId=!1),i&&i.audioAttachSwitchOwnerId&&(cur.audioAttachSwitchOwnerId=i.audioAttachSwitchOwnerId),t=t||"edit",_)o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,e,_);else if(cur.audioPage){const e=cur.audioPage._data.maxPlaylistsCount;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isArray)(cur.audioPage._data.playlists)&&cur.audioPage._data.playlists.length>=e){const _=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(e,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_playlists_limit_error")).replace("{limit}",e);return void new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.MessageBox({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")}).content(_).setButtons("Ok",(function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().hide()})).show()}}const l=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.showBoxLoader)();(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__.parallel)((e=>{window.stManager.add(["audio.css",window.jsc("web/indexer.js"),window.jsc("web/auto_list.js"),window.jsc("web/grid_sorter.js"),"edit"===t&&window.jsc("web/upload.js")],e)}),(e=>{o?(o.setForceReload(!0),o.loadAll(e,t)):e()}),(_=>{var o,l;if(cur.audioPage&&cur.audioPage.getOwnerId()===+e&&!(null==(o=i)?void 0:o.promotedAudios)&&(s=cur.audioPage.getOwnerPlaylists()),null==(l=i)?void 0:l.promotedAudios){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();s=[],i.addAudio=[],i.promotedAudios.forEach(((t,o,s)=>{const l=e.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,t[0],t[1]);0===l.getAudiosCount()&&void 0===l.getTotalCount()?l.load((()=>{i.addAudio.push(...l.getAudiosList()),o===s.length-1&&_()})):(i.addAudio.push(...l.getAudiosList()),o===s.length-1&&_())}))}else s?_():AudioPage.loadPlaylists(e,void 0,!1,"attach"===t,(e=>{s=e,_()}))}),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.isBoxLoadingCancelled)(l)||AudioPage._openEditPlaylist(t,e,_,s,i)}))},AudioPage.initBoxEls=function(e){return{boxContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_pl_edit_box",e.bodyNode),playlistNameInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_input",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_title",e.bodyNode)),playlistDescriptionInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_input",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_description",e.bodyNode)),playlistDiscoverToggle:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_discover_checkbox",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_discover",e.bodyNode)),playlistUpdateIdInput:e.bodyNode.querySelector("#ape_pl_to_update_id"),playlistUpdateTimeInput:e.bodyNode.querySelector("#ape_pl_to_update_time"),playlistUpdateCutInput:e.bodyNode.querySelector("#ape_pl_to_update_cut"),playlistUpdateFilterInput:e.bodyNode.querySelector("#ape_pl_to_update_filter"),stat:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_pl_stat",e.bodyNode),uploadCoverButtonWrapper:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover",e.bodyNode),uploadCoverInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_upload",e.bodyNode),errorMsg:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_error_msg",e.bodyNode),header:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_header",e.bodyNode),search:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_search",e.bodyNode),searchInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_field",e.bodyNode),addAudiosButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_add_audios_btn",e.bodyNode),addAudiosFromPlaylistsButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_add_pl_audios_btn",e.bodyNode),listWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_list_wrap",e.bodyNode),list:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",e.bodyNode),globalResults:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_global_results",e.bodyNode),globalResultsList:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_global_list",e.bodyNode),emptyPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_audios_empty_list",e.bodyNode),emptyPlaylistsPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_audios_empty_playlists_list",e.bodyNode),emptyGlobalPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_audios_empty_global_list",e.bodyNode)}},AudioPage.showRecomsOnboarding=function(e=!1){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(boxLoader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(boxLayerWrap),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.boxRefreshCoords)(boxLoader),ajax.post("al_audio.php?act=get_recoms_onboarding",{load_script:+e},{onDone:e=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLoader);let _=!1;if(window.AudioRecomsOnboarding)if(window.AudioRecomsOnboarding.checkFinalScreen())window.AudioRecomsOnboarding.showFinalScreenFromLS(),_=!0;else if(e){new window.AudioRecomsOnboarding(e).show(),_=!0}_||(window.nav.change({popup:!1}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLayerWrap))}})},AudioPage._openEditPlaylist=function(e,_,t,i,o){var s;let l,a,n,r,d,u,c;const h=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),E=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_TEMP,_,(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.irand)(0,999999));if((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()){d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode),"offset"),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)("ape_edit_playlist_search");const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode);e&&(c=e.scrollTop)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLoader),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLayerWrap),cur.apLayer&&(r=cur.apLayerPlaylistId,layers.fullhide()),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({audioPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_add_media"),playlistPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_attach_playlist_button"),canPlaylistAttach:!1,onAudioChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.onAudioChoose,onPlaylistChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.onPlaylistChoose},o),cur.onChooseAudio=o.onAudioChoose,cur.onChoosePlaylist=o.onPlaylistChoose;const p=!t||t===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID,P="attach"===e,g=!!(null==(s=o)?void 0:s.promotedAudios);let b,D=!1,O=!1,M=!1,m=!1,A=0,C=null,w=!0,y=!1,I=0,T=0;i=i.filter((e=>e.id!==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID&&e.size>0));const f=new _web_indexer_indexer__WEBPACK_IMPORTED_MODULE_21__.vkIndexer(i,(e=>e.title)),B=i.length>0;let L=!1;p&&!P||g?o.addAudio&&E.pushAudio(o.addAudio):(L=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,_,t),E.pushAudio(L.getAudiosList()),E.mergeWith({title:L.getTitle(),description:L.getDescription(),rawDescription:L.getRawDescription(),coverUrl:L.getCoverUrl(),editHash:L.getEditHash(),noDiscover:L.getNoDiscover()}));const v=P?_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_audio_title"):t?_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_title"):_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_new_playlist_title");function R(e){if(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(e)){let _=" "+(e+"|")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.parseLatin)(e)||"")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.parseCyr)(e)||"");_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(_.replace(/\)/g,"").replace(/&/,"&amp;")),m=new RegExp("(\\s|^)("+_.replace(_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_21__.vkIndexer.delimiter,"|").replace(/(^\||\|$|\?)/g,"")+")","gi")}else m=!1;F(O,"playlists"!==D,e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder)}function U(){o.onClose&&o.onClose(),w||(E.clean(),h.deletePlaylist(E),r&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.showAudioPlaylist(r[0],r[1]))}function W(_){if(!y||_||"attach"===e)return!0;let i,o;return t?(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_cancel_confirm_text"),o=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_cancel_confirm_yes")):(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_new_playlist_remove_confirm_text"),o=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_new_playlist_remove_confirm_continue")),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_warning"),i,o,(()=>{w=!1,(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().hide(),l.hide(!0)}),_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_cancel")),!1}function K(){return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(a.searchInput.value)}function S(_){const t=E.indexOfAudio(_)>=0?"ape_selected":"",i=_;m&&((_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clone)(i))[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE].replace(m,"$1<em>$2</em>"),_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER].replace(m,"$1<em>$2</em>"));let s="";if("edit"===e){s=`<div class="ape_check">\n        <div class="ape_check--unchecked">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_52__.getIcon24CheckCircleOff)().icon}</div>\n        <div class="ape_check--checked">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_53__.getIcon24CheckCircleOn)().icon}</div>\n      </div>`}else{let e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(i);if(o&&o.wiki){s='<div role="button" class="ape_attach" onclick="'+`editorChooseAudio(\n        '${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(e.performer)}',\n        '${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(e.title)}',\n        ${e.duration},\n        '${e.fullId}',\n        '${e.url}',\n        ${e.duration},\n        this)`+'">'+o.audioPickerButtonText+"</div>"}else{e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(JSON.stringify(e));s=`<div role="button" class="ape_attach" onclick="cur.onChooseAudio(event, this, ${e}, ${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(JSON.stringify(i))})">${o.audioPickerButtonText}</div>`}}return'<div class="ape_audio_item_wrap _ape_audio_item '+t+'">'+s+_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.drawAudio(_)+"</div>"}function k(){clearTimeout(I);const e=K();e&&(I=setTimeout((function(){I=!1,M=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__.hashCode)(e+"no conflict")),M.mergeWith({searchParams:{globalQuery:e},hasMore:!0});let _=0;n&&(_=n.getOffset(),n.destroy()),n=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(a.list,{scrollNode:a.list,onNeedRows:function(e,t){t-=_,M.load(t,(function(){const _=[],i=M.getAudiosList();if(0==+t&&i.length&&_.push('<div class="ape_list_header">'+_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_global_results")+"<div>"),i.length){const e=Math.min(i.length,t+20);for(let o=t;o<e;o++)i[o]&&_.push(S(i[o]))}M.getAudiosCount()||n&&n._offset?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.list)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list)),e(_)}))}}),n.drawMore()}),300),C=null)}function x(){l.setOptions({title:'<div class="back _back"><span class="back__icon">'+(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_54__.getIcon24ChevronLeft)().icon+"</span>"+_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_back")+"</div>",bodyStyle:"padding: 0"})}function H(){let e="";cur.audioAttachSwitchOwnerId&&cur.audioAttachOriginalOwnerId&&(e='<span class="dvd"></span><a class="tab_link" onclick="cur.audioAttachSwitch()">',e+=_shared_ranges__WEBPACK_IMPORTED_MODULE_43__.Ranges.isGroupId(E.getOwnerId())?_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_wall_to_my_audios"):_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_wall_to_group_audios"),E.getOwnerId()===cur.audioAttachOriginalOwnerId?cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachSwitchOwnerId,o)}:cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachOriginalOwnerId,o)},e+="</a>"),l.setOptions({title:v+e,bodyStyle:"padding: 0"})}function N(){const e=a.boxContent.getBoundingClientRect();if(e.height&&e.width){const _=a.list.getBoundingClientRect();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a.list,{height:e.height-(_.y-e.y)})}}function F(e,_,t){O=e,_&&O?t?O.search({q:t},(function(e){q(!0,e)})):q(!0,O.getAudiosList(),e):q(!1,t?f.search(t):i),j("initial"===D&&!t)}function q(e,_,t){a.list.innerHTML="",n&&n.destroy(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyPlaylistsPlaceholder),N();let i=0;n=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(a.list,{scrollNode:a.list,onNoMore:function(){0===i&&(K()?e||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyPlaylistsPlaceholder)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyPlaceholder))),g?function(){clearTimeout(T);const e=K();e&&(T=setTimeout((function(){T=!1;let _=0;n&&(_=n.getOffset(),n.destroy()),n=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(a.list,{scrollNode:a.list,onNeedRows:function(t,i){i>_?t([]):(i-=_,ajax.post("/audio?act=load_catalog_section",{section_id:o.audioSectionId,search_query:e},{onDone:function(){var e,_;const o=(null==(_=arguments[1])||null==(e=_.playlist)?void 0:e.list)||[],s=[];0==+i&&o.length&&s.push('<div class="ape_list_header">'+_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_global_results")+"<div>"),o.length&&o.forEach((e=>{s.push(S(e))})),o&&o.length?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.list)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyGlobalPlaceholder)),t(s)},onFail:function(e){return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error"),width:350},e),!0}}))}}),n.drawMore()}),100),C=null)}():e&&k()},onNeedRows:function(o,s){let l=d||20;const a=t&&t.hasMore()?s+l:Math.min(_.length,s+l);if(a>_.length&&t&&t.hasMore())t.load(s+l,(l=>{const n=z((_=t.getAudiosList()).slice(s,a),e);i+=n.length,o(n)}));else{const t=z(_.slice(s,a),e);i+=t.length,o(t)}},onRendered:e=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(a.list,"offset",e),c&&d&&(a.list.scrollTop=c,d=0,c=0)}})}function z(e,_){const t=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_55__.getIcon24Playlist)().icon,i=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_56__.getIcon24ChevronRight)().icon;return e.map((e=>{if(_)return S(e);{const _='<div class="ape_pl_item_inner"><span class="ape_pl_title">'+(m?e.title.replace(m,"$1<em>$2</em>"):e.title)+'</span> <span class="ape_pl_size">'+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(e.size,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_playlist_audios_count"),!0).replace("{count}",e.size)+"</span></div>";return`<div class="ape_pl_item"\n                        data-playlist-access-hash="${e.access_hash}"\n                        data-playlist-owner-id="${e.owner_id}"\n                        data-playlist-id="${e.id}">\n                          <div class="ape_pl_item__icon_playlist">${t}</div>\n                          ${_}\n                          <div class="ape_pl_item__icon_chevron">${i}</div>\n                        </div>`}}))}function j(e){b||(b=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_23__.default(a.list,"ape_audio_item_wrap",{wrapNode:a.list,onReorder:function(e,_){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_row",e),"full-id");const i=E.indexOfAudio(t);let o;_?(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_row",_),"full-id"),o=E.indexOfAudio(t)):o=E.getAudiosCount(),E.moveAudio(i,o)}})),e?b.enable():b.disable()}function Y(t,s){if("default"===t&&cur.audioPage&&cur.audioPage._data.addBanned)(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},cur.audioPage._data.addBannedText);else{switch(D=t,l.removeButtons(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(a.list,"view",t),t){case"initial":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.globalResults),F(E,!0),G(),H();break;case"default":const t=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,_,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.disableEl)(a.addAudiosButton),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.showProgress)(a.addAudiosButton),t.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.enableEl)(a.addAudiosButton),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.hideProgress)(a.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(a.addAudiosFromPlaylistsButton,B),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosButton),"edit"===e?x():H(),F(t,!0,u),N(),"edit"===e&&G()}));break;case"playlists":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.globalResults),x(),F(i);break;case"playlist":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosButton),x(),F(s,!0),P&&function(e){if(!o.canPlaylistAttach)return;function _(_){cur.onChoosePlaylist(_,e)}l.addButton(o.playlistPickerButtonText,_,"ok",!0)}(s),"edit"===e&&G()}N(),a.searchInput.value="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.elfocus)(a.searchInput),m=!1,C=null,clearTimeout(I),h&&h.updateCurrentPlaying&&h.updateCurrentPlaying()}}function G(){l.addButton(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_save_playlist_button"),Q,"ok",!0)}function $(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domClosest)("ape_pl_item",e.target);if(_){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(_,"playlist-id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(_,"playlist-owner-id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(_,"playlist-access-hash"),s=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,i,t,o);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.showProgress)(_),s.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.hideProgress)(_),Y("playlist",s)}))}if(e.target.closest(".ape_check")){function l(e,_){if(cur.audioPage&&cur.audioPage._data.addBanned)return void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},cur.audioPage._data.addBannedText);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(e,"ape_selected",_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_row",e),o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(i);t?E.pushAudio(o,0):E.removeAudio(o)}const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domClosest)("_ape_audio_item",e.target);if(e.shiftKey&&C){let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domChildIndex)(C),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domChildIndex)(n);const u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domPN)(n);if(r>d){const p=d;d=r,r=p}const c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(C,"ape_selected");for(let g=r;g<=d;g++)l(u.children[g],c)}else l(n),C=n;V(),Z()}if(P&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(e.target,"artist_link")){if(e.metaKey&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mac||e.ctrlKey)return;const b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(e.target,"performer")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(e.target.innerText);b&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.searchInput,b),uiSearch.onChanged(a.searchInput),R(b))}return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)}function V(){const e=E.getAudiosCount(),_=E.getTotalDuration();let t;if(e){let i;t=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(e,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_edit_playlist_audios_info")),t=t.replace("{count}",e);const o=_%60,s=Math.floor(_/60)%60,l=Math.floor(_/3600);_<60?i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(_,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_seconds")):_<3600?(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(s,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_minutes")),o&&(i+=" "+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(o,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_seconds")))):(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(l,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_hours")),s&&(i+=" "+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(s,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_minutes")))),t+='<span class="dvd">'+i+"</span>"}else t=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_no_audios");a.stat.innerHTML=t}function Q(e){let t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.playlistNameInput));t=t.replace(/[\u200B-\u200D\uFEFF]/g,"");const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.playlistDescriptionInput)),s=+(a.playlistDiscoverToggle&&a.playlistDiscoverToggle.classList.contains("on"));if(a.playlistUpdateIdInput&&(t=`${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(a.playlistUpdateIdInput.value)}_${a.playlistUpdateTimeInput.valueAsNumber}_${a.playlistUpdateCutInput.valueAsNumber}`),!t)return Y("initial"),void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.notaBene)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.ge)("ape_pl_name"));const n=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(E.getAudiosList(),(function(e,_){n.push(_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_ID]+"_"+_[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_29__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY])}));const r=o.newPlaylistHash||cur.audioPage&&cur.audioPage._data.newPlaylistHash||"",d={hash:p?r:L.getEditHash(),owner_id:_,playlist_id:p?0:L.getPlaylistId(),title:t,description:i,Audios:n.join(","),cover:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isObject)(A)?JSON.stringify(A):A};a.playlistUpdateIdInput&&(d.update_id=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(a.playlistUpdateIdInput.value),d.update_time=(a.playlistUpdateTimeInput.valueAsNumber+6e4*(new Date).getTimezoneOffset())/1e3,d.update_cut=a.playlistUpdateCutInput.valueAsNumber,d.update_filter=a.playlistUpdateFilterInput.classList.contains("on")?1:0),null!==s&&(d.no_discover=s),ajax.post("al_audio.php?act=save_playlist",d,{showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.lockButton)(e),onDone:(e,t)=>{p&&!document.querySelector(".CatalogSection ._audio_page__playlists")?nav.reload():((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_pl_"+e.ownerId+"_"+e.id),(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_pl__cover",this);if(_){AudioPage.setCoverImageElem(_,e.coverUrl,e.title);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_pl_grid_covers_wrap",this);t&&(t.innerHTML=e.coverUrl?"":e.gridCovers)}const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_pl__title",this);if(t){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_item__title",t);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(_||t,e.title)}const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_pl__stats_count",this);i&&(i.innerHTML=e.totalCount)})),p&&cur.audioPage&&_==cur.audioPage.getOwnerId()&&["all","my_playlists"].includes(cur.audioPage._currentSection)&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(cur.audioPage._els.pageContainer.querySelectorAll(".CatalogBlock__my_playlists ._audio_page_block__playlists_items"),(function(){const{thumb:e,title:_}=t,i=(0,_swc_helpers_extends__WEBPACK_IMPORTED_MODULE_50__._)({},t,{cover_image:AudioPage.getCoverImage(e,_)}),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_pl_item",i));let s=this;if(s.classList.contains(_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_33__.UI_GALLERY_CLASSNAME)){const e=(0,_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_33__.uiGetGallery)(s);let _=document.createElement("div");_.classList.add("ui_gallery_item"),_.appendChild(o),e.addItems([_],0)}else{s.insertBefore(o,s.firstChild);const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(s,"max-items"));e&&s.children.length>e&&s.removeChild(s.lastChild)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page__playlists",s))})),cur.audioPage._data.playlists=cur.audioPage._data.playlists||[],cur.audioPage._data.playlists.unshift(t)),p&&cur.audioPage&&cur.audioPage.catalogController.updateSectionReorder(),cur.audioPage&&cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(_),L&&(L.clean(),L.mergeWith(e)),l.hide(!0),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(o.onPlaylistSave)&&o.onPlaylistSave(L))},onFail:()=>(l.hide(!0),!0)})}function X(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.coverThumb),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a.coverThumb,"background-image","url("+e+")"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(a.uploadCoverButtonWrapper,"ape_thumb_set"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.uploadCoverButton)}function J(e){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(a.uploadCoverButtonWrapper,"ape_thumb_set"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_thumb")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.uploadCoverButton),A=-1,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)}function Z(){y=!0}(2===vk.widget||3===vk.widget)&&window.box&&(!boxQueue.count()&&!(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()||cur.audioChooseBox===(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)())?(l=window.box,l.setOptions({title:v,bodyStyle:"padding: 0",width:560,onBeforeHide:U,onHideAttempt:W,hideButtons:!0})):(cur.audioChooseBox&&cur.audioChooseBox===(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().hide(),l=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.MessageBox({title:v,bodyStyle:"padding: 0",width:560,onBeforeHide:U,onHideAttempt:W})),cur.audioChooseBox=l,l.content((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_edit_playlist")),l.show(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(l,"ownerId",_),a=AudioPage.initBoxEls(l),function(){const t=window.innerHeight;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a.boxContent,"height",Math.min(800,Math.max(t-200,500))),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.addAudiosFromPlaylistsButton,"click",Y.bind(this,"playlists")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.addAudiosButton,"click",Y.bind(this,"default")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.list,"click",$),P&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(a.list,"audio-context","attach");(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(l.titleWrap,"click",(function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(e.target,"_back")&&function(){switch(D){case"initial":break;case"default":Y("initial");break;case"playlists":Y("default");break;case"playlist":Y("playlists")}}()})),uiSearch.init("ape_edit_playlist_search",{onChange:R}),"edit"===e&&(Y("initial"),V(),function(){if(!cur.audioCoverUploadOptions||!cur.audioCoverUploadOptions[_])return;const e=cur.audioCoverUploadOptions[_],t={file_name:"photo",file_size_limit:5242880,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",onUploadStart:function(e,_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))},onUploadComplete:function(e,_){(_=JSON.parse(_)).error?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.errorMsg),N()):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.errorMsg),A=_,X(A.url),Z(),N()),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))},onUploadProgress:function(e,_,t){},onUploadError:function(e,_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))},clear:1,type:"photo",max_attempts:3,server:e.server,noCheck:!0,chooseBox:!0,uploadButton:!0,accept:".jpg,.jpeg,.png",filesize_hide_last:!0,label:e.button};function i(){(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isObject)(A)&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByTag1)("input",a.uploadCoverButtonWrapper).click()}Upload.init(a.uploadCoverButtonWrapper,e.url,e.vars,t),a.uploadCoverButton=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_cover_accessibility_upload_btn",l.bodyNode),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_delete"),"click",J),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.uploadCoverButton,"click",(()=>i())),a.coverThumb=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_thumb")}(),E.getCoverUrl()&&X(E.getCoverUrl()),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_5__.autosizeSetup)(a.playlistDescriptionInput,{minHeight:30,maxHeight:150,onResize:N}),a.playlistNameInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(E.getTitle()),a.playlistDescriptionInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(E.getRawDescription().replace(/<br>/g,"\n")),a.playlistDiscoverToggle&&a.playlistDiscoverToggle.classList.toggle("on",E.getNoDiscover()),a.playlistNameInput.addEventListener("input",Z),a.playlistDescriptionInput.addEventListener("input",Z),a.playlistDiscoverToggle&&a.playlistDiscoverToggle.addEventListener("click",Z),a.playlistUpdateIdInput&&cur.editorialPlaylistsParams&&(a.playlistUpdateIdInput.value=cur.editorialPlaylistsParams.target_playlist,a.playlistUpdateTimeInput.valueAsNumber=1e3*cur.editorialPlaylistsParams.update_time-6e4*(new Date).getTimezoneOffset(),a.playlistUpdateCutInput.valueAsNumber=cur.editorialPlaylistsParams.update_cut,a.playlistUpdateFilterInput.classList.toggle("on",1===cur.editorialPlaylistsParams.update_filter),a.playlistUpdateFilterInput.setAttribute("aria-checked",1===cur.editorialPlaylistsParams.update_filter),a.playlistUpdateIdInput.addEventListener("input",Z),a.playlistUpdateTimeInput.addEventListener("input",Z),a.playlistUpdateCutInput.addEventListener("input",Z),a.playlistUpdateFilterInput.addEventListener("click",Z)));g?Y("playlist",E):P&&Y("default");H(),L&&"attach"!==e&&l.setControlsText(`<a onclick="AudioPage.deletePlaylist(${L.getOwnerId()}, ${L.getPlaylistId()}, '${L.getEditHash()}')">\n                              ${_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_delete_playlist")}\n                            </a>`)}(l.bodyNode),u&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.searchInput,u),k()},AudioPage.prototype._deinitKeyEvents=function(){this._audioHQKeyEventHandler1&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"keydown",this._audioHQKeyEventHandler1),this._audioHQKeyEventHandler2&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"keyup",this._audioHQKeyEventHandler2),this._audioHQKeyEventHandler3&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"visibilitychange",this._audioHQKeyEventHandler3),this._audioHQKeyEventHandler4&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"mousedown",this._audioHQKeyEventHandler4),this._audioSeekKeyEventHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"keydown",this._audioSeekKeyEventHandler)},AudioPage.prototype._initKeyEvents=function(){this._deinitKeyEvents();const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),_=()=>!this.isLayer()&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getLayer().isShown();(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"mousedown",this._audioHQKeyEventHandler4=function(e){e.ctrlKey&&(cur.ctrlMouseDown=!0,cur.ctrlPressed=!1)},!0),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"keydown",this._audioHQKeyEventHandler1=function(e){_()||(cur.ctrlPressed=e.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.CTRL)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"keyup",this._audioHQKeyEventHandler2=function(e){_()||(e.keyCode!==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.CTRL||cur.ctrlMouseDown)&&(delete cur.ctrlMouseDown,delete cur.ctrlPressed)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"keydown",this._audioSeekKeyEventHandler=function(t){const i=t.target,o=i&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(i.tagName.toLowerCase(),["input","textarea"])&&""!==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(i),s=i&&i.isContentEditable,l=cur&&cur.pvShown;o||s||l||_()||!e.isPlaying()||!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(t.keyCode,[_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.RIGHT,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.LEFT])||cur.wallLayer||t.ctrlKey||e.seekCurrentAudio(t.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.RIGHT)}),cur.destroy.push((()=>this._deinitKeyEvents()))},AudioPage.prototype.editFeed=function(){const e=this;(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showTabbedBox)("al_settings.php",{act:"a_edit_owners_list",list:"audio",height:lastWindowHeight},{stat:[window.jsc("web/privacy.js"),"privacy.css","ui_controls.js","ui_controls.css",window.jsc("web/indexer.js")]}),cur.onOListSave=function(_,t,i,o){const s=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)(),l={act:"a_ignore_olist",hash:o.hash};return _.length<t.length?l.White=_.join(","):l.Black=t.join(","),ajax.post("al_audio.php",l,{onDone:function(){s.hide();e.getCurrentPlaylist().clean(),e.refreshCurrentPage()},onFail:()=>!0,showProgress:s.showProgress,hiderogress:s.hideProgress}),!1}},AudioPage.prototype.updateStatusExportControls=function(e){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),t=_.getStatusExportInfo();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_export_status",this._els.pageContainer),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this,"on",t&&!!t[(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this,"oid")])}));const i=_.hasStatusExport(),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_status",this._els.pageContainer);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(o,"audio_page_player_btn_enabled",i),!e)if(this.isLayer())cur.audioPage&&cur.audioPage.updateStatusExportControls(!0);else{const e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getLayer().getPageInstance();e&&e.updateStatusExportControls(!0)}return!1},AudioPage.prototype.updateStatusExport=function(e,_){e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.checkbox)(e),_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(_);const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),i=t.getStatusExportInfo()||{};let o,s;if(_)i[_]?(delete i[_],o=!1):(i[_]=1,o=!0);else if(t.hasStatusExport()){for(let e in i)i.hasOwnProperty(e)&&delete i[e];o=!1}else i[_=vk.id]=1,o=!0;t.setStatusExportInfo(i),_!=vk.id&&_||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.checkbox)("currinfo_audio",t.hasStatusExport()),this.updateStatusExportControls();const l=t.getCurrentAudio();l&&(s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(l).fullId);const a=null;t.stats.sendCurrentAudioEvent({type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.TYPE_BROADCASTING,subtype:o?_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.SUBTYPE_ON:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.SUBTYPE_OFF,targetOwnerId:_}),ajax.post("al_audio.php?act=toggle_status",{exp:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(o),oid:_,hash:vk.statusExportHash,id:s,top:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(a)},{onFail:()=>!0})},AudioPage.prototype.playStatusAudio=function(e,_,t){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_friend",t);(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().playLive(e,{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.showProgress.pbind(i),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.hideProgress.pbind(i)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(_)},AudioPage.showActionTooltip=function(e,_){const t=[3,-8,0],i=currentAudioPage(e),o=i&&i.isLayer();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(e,"_audio_page_player_add")?(0,_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_26__.audioShowActionTooltip)(e,t,o):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(e,"_audio_page_player_play_rate")&&(t[0]=-17),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_27__.showTooltip)(e,{text:_,black:1,shift:t,appendParentCls:"_audio_page_player",forcetodown:o,needLeft:o}))},AudioPage.prototype.onHide=function(){const e=this;cur.nav=cur.nav.filter((function(_){return e._nav_func!=_})),this._deinitKeyEvents()},AudioPage.prototype.showRecoms=function(e,_){if(!_){const e=this._readyAudio?this._readyAudio:(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio();if(!e)return;_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e).fullId}(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_recoms_by_track_button_click",!0),nav.go({0:"audio",section:"recoms_audio",audio_id:_},null,{nocur:!0})},AudioPage.prototype.onAudioUploaded=function(e,_){if(!_)return;const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),i=t.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);i.pushAudio(_);const o=t.getCurrentPlaylist();o&&o.getSelf()==i&&o.pushAudio(_),"all"!==this._currentSection&&this.resetSection("all");let s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_);(0,_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_12__.onAdditionalEvent)(null,s,{type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.TYPE_ADDED,subtype:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.SUBTYPE_UPLOAD,context:"on_audio_uploaded",playlistId:i.getOwnerId()+"_"+i.getPlaylistId()});let l=5;const a=this;!function e(t){--l<0||setTimeout((function(){ajax.post("al_audio.php?act=check_audio_data",{audio_owner_id:s.ownerId,audio_id:s.id},{onDone:function(i){if(!i)return;let o=i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]!=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE];o=o||i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]!=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER],o=o||i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS]!=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS],o&&((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().updateAudio(s.fullId,i),"all"===a._currentSection&&"audio"===cur.module&&a._initAudioRowsAutoList(),s=i),e(1.5*t)},onFail:()=>!0})}),t)}(1e3)},AudioPage.prototype.onAudioAllUploaded=function(){"all"===this._currentSection&&nav.reload()},AudioPage.prototype.uploadAudio=function(e){this._data.uploadBanned?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},this._data.uploadBannedText):(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showBox)("al_audio.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(e||{},{act:"new_audio",gid:_shared_ranges__WEBPACK_IMPORTED_MODULE_43__.Ranges.isGroupId(this.getOwnerId())?-this.getOwnerId():0}),{params:{width:"450px",bodyStyle:"padding: 0px; position: relative;"}})},AudioPage.prototype.editAudio=function(e,_,t){return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showBox)("al_audio.php",{act:"edit_audio_box",aid:_},{params:{width:"456px",bodyStyle:"padding: 20px; background-color: #F7F7F7;",hideButtons:1}}),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t),!1},AudioPage.prototype.restoreRecommendation=function(e){const _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(e,!0),t={act:"restore_recommendation",hash:(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_37__.getAudioExtra)(_).recom.hash,audio_id:_.fullId};nav.objLoc.audio_id&&(t.recommendation_type="query"),nav.objLoc.album_id&&(t.recommendation_type="album"),ajax.post("al_audio.php",t,{onFail:()=>!0}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(e,"audio_row__deleted");const i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAddRestoreInfo(),o=i[_.fullId].removedCurrentPos,s=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist(),l=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue();o>=0&&s&&s.getType()==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_RECOM&&l.addAudio(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(e),o),delete i[_.fullId],_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.onRowOver(e,!1,!0)},AudioPage.isInRecentPlayed=function(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_playlist",e);return!(!_||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(_,"audio_recent_rows"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(_,"playlist")},AudioPage.prototype.chooseFromMyAudios=function(e){let _=!1;AudioPage.editPlaylist(vk.id,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",{audioPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_add"),playlistPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_add"),onClose:()=>{_&&nav.reload()},onAudioChoose:(t,i,o)=>{const s=t.ctrlKey||t.metaKey;if(ajax.post("al_audio.php?act=add",{group_id:e,audio_owner_id:o.ownerId,audio_id:o.id,hash:o.addHash},{onDone:e=>{e&&(_=!0)},onFail:()=>!0}),s)i.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_added"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(i,"ape_added");else{_=!0;const e=window.__bq;if(e)for(;e.count();)e.hideLast()}}})},AudioPage.prototype.updateShuffleButton=function(){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue().shuffled;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_shuffle",this._els.pageContainer),"audio_page_player_btn_enabled",e),this.isLayer()&&cur.audioPage&&cur.audioPage.updateShuffleButton()},AudioPage.prototype.loadMarketItemsCarousel=function(){try{Boolean(document.querySelector(".EcommAudioMarketItemsCarousel__root"))&&(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_35__.asyncImportLoader)((()=>__webpack_require__.e(34932).then(__webpack_require__.bind(__webpack_require__,321880))),3)}catch(e){}},AudioPage.prototype.updatePlayerClass=function(e){const _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(e),t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isRadio(e),i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isArticleTts(e),o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isMarusiaTale(e),s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isMarusiaTrack(e);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_podcast",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_radio_station",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_article_tts",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_radio_marusia",t&&s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_external_stream_audio",t||i||o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_marusia_tale",o),this._updatePlaybackRate(),!this.isPodcastPage()){this.isLayer()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__current",this._els.pageContainer),"unshown",_||!(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist());const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__podcast",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(t,_),t&&_&&(e=e||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.attr)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ui_tab",t),"href","podcasts"+e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]))}},AudioPage.prototype.updateRadioFollowBtn=function(){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio(),_=this._els.player.querySelector(".audio_page_player_follow_radiostation");_&&(_.classList.toggle(AudioPage.followedRadioClassName,(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_37__.getAudioExtra)(e).fave),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(_,(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_36__.isRadio)(e)&&!_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isMarusiaTrack(e)))},AudioPage.prototype.updateFaveButton=function(){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentFaveStatus(),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_fave",this._els.player);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(_,"activated",e)},AudioPage.prototype.toggleRepeat=function(){if(this.isPodcastPage())return;const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();e.isRepeatAll()||e.isRepeatCurrentAudio()?e.toggleRepeatCurrentAudio():e.toggleRepeatAll(),this.updateRepeatButton()},AudioPage.prototype.updateRepeatButton=function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_page_player_repeat");if(e&&e.length){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),t=_.isRepeatAll(),i=_.isRepeatCurrentAudio();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(e,((e,_)=>{_.ariaLabel=_.ariaLabel&&AudioPage.getRepeatButtonText(),_.onmouseover=_.onmouseover&&AudioPage.showActionTooltip.bind(void 0,_,AudioPage.getRepeatButtonText),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(_,"audio_page_player_btn_enabled",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(_,"audio_page_player_btn_repeat_one",i)}))}},AudioPage.getRepeatButtonText=function(){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),_=e.isRepeatAll(),t=e.isRepeatCurrentAudio();let i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_repeat_tooltip");return _?i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_repeat_track_tooltip"):t&&(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_dont_repeat_tooltip")),i},AudioPage.prototype.toggleShuffle=function(e){if(this.isPodcastPage())return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(e,"audio_page_player_btn_enabled")&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_sort_stat","audio_sort","shuffle_player",this.isLayer()?"layer":"page");const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue();if(_.isEmpty())return;let t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio();const i=()=>{_.shuffled?_.resetShuffle():_.shuffle(!0),"current"===this._currentSection&&this._initAudioRowsAutoList(!0),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().play(t),this.updateShuffleButton()};t?i():_.getAudioAt(0).then((e=>{t=e,i()}))},AudioPage.prototype.toggleFave=function(e){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(_)&&AudioPlayer.podcastToggleFave(e,_)},AudioPage.prototype.changePlaybackRate=function(e,_){const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(t)||_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isArticleTts(t))&&((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().podcastChangePlaybackRate(!!_.shiftKey),this._updatePlaybackRate())},AudioPage.prototype._updatePlaybackRate=function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_play_rate",this._els.player);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_icon",e),AudioPlayer.podcastGetPlaybackRate()+"x")},AudioPage.prototype._getCurrentSearchParams=function(){const e=window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer())],_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this._searchSortFilter.selectedItems()[0][0]);return{performer:e&&e.val?1:null,lyrics:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._container),"on")?1:null,sort:_?1:null}},AudioPage.searchAudios=function(e,_,t,i,o){currentAudioPage(this).searchAudios(e,_,t,i,o)},AudioPage.prototype.searchAudios=function(e,_,t,i,o){this.lastQuery!==e&&(this.lastQuery=e,this._muteSearch?delete this._muteSearch:(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(e),nav.change((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(this._getCurrentSearchParams(),{q:e||null}),!1,{fromSearch:!0,globalQuery:e,fromHistory:t,isLayer:this.isLayer(),fetchedQuery:i,fromSuggestsAcceptId:o})))},AudioPage.prototype.onUserAction=function(e,_){const t=_.indexOfAudio(e);if(-1!=+t&&_.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_SEARCH){if(!(_.getOwnerId()===vk.id&&t>=0&&t<_.getLocalFoundCount())&&_.getSearchParams()){const t=_.getSearchParams();t.globalQuery&&uiSearch.saveHistorySearch(this.searchInputEl,t.globalQuery,e.ownerId,e.id,_.getTotalCount(),_.getTotalCountHash())}}},AudioPage.prototype._updateFriendsList=function(e,_,t){if(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(e),this._friendSearchInProgress=!1,!e)return;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_list",this._els.pageContainer),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)('<div class="audio_friends_list _audio_friends_list" style="">'+e+"</div>");t&&(this._shownFriends=[]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domPN)(i).appendChild(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(i)},AudioPage.prototype.shareAudio=function(){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;e&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.shareAudio(!1,e)},AudioPage.prototype.showStatusTooltip=function(e){this.statusTT||(this.statusTT=!0,ajax.post("al_audio.php?act=status_tt",{},{onDone:(_,t)=>{this.statusTT=new ElementTooltip(e,{content:t,width:250,offset:[1,14],elClassWhenShown:"audio_status_tt_shown",id:"audio_status_tt",onFirstTimeShow:function(e){this.sb=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__.default((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_status_wrap",e),{global:!0})},onShow:function(){setTimeout(function(){this.statusTT.sb.update()}.bind(this),0)}.bind(this)}),cur._onStatusExportBtn&&(this.statusTT.show(),this.statusTT.sb.update())},onFail:()=>!0}))},AudioPage.prototype.isLayer=function(){return this._data.isLayer},AudioPage.prototype.isPodcastPage=function(){return!this.isLayer()&&!!this._data.podcastPage},AudioPage.prototype.destroy=function(){this._trackSlider&&this._trackSlider.destroy(),this._volumeSlider&&this._volumeSlider.destroy(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"scroll",this._ev_onScroll)},AudioPage.prototype.getPageCurrentPlaylist=function(){return this._pagePlaylist},AudioPage.prototype.clearCurrentPlaylist=function(){if(!this.isLayer())return;const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();e.deleteCurrentPlaylist(),this.updateCurrentPlayingInfo();const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue();_.clean();const t=_.autoplayQueue;t&&(t.clean(),this._destroyAutoplayBlock());const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__current",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(i,"unshown"),"current"===this.getCurrentSection()&&(uiTabs.goTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__all",this._els.pageContainer)),null,!0),this.updateShuffleButton(),this.updateCurrentPlayingInfo(),this.updatePlayerClass(null)),this._initPlayer(!0);const o=e.getPlaylistsByType(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_MY).find((e=>e.getAudiosList().length)),s=o&&o.getAudiosList()[0];if(s&&(this._readyAudio=s,this._initPlayer(!0)),cur.audioPage){cur.audioPage._readyAudio=s,cur.audioPage._initPlayer(!0);try{const e=cur.audioPage._data.sectionData[cur.audioPage._currentSection].title;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setDocumentTitle)(e)}catch(e){}}this.updateStatusExport(),this.updateLayerHeight(),this._scroll.scrollTop()},AudioPage.prototype.setTooltipTitle=function(e){if(e.titleSet)return;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_performer",e),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song",e);(_.scrollWidth>_.clientWidth||t.scrollWidth>t.clientWidth)&&e.setAttribute("title",e.innerText),e.titleSet=!0},AudioPage.prototype._initPlayer=function(e){const _=this,t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),i=this._els.pageContainer,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player",i),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title",o),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_performer",o),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song",o),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song_title",o),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song_subtitle",o),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_duration",o),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player__cover",o),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_play",o),h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_play_blind_label",c),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_btn_lyrics",o),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_add",o),P=o.querySelector(".audio_page_player_follow_radiostation");let g;function b(e){if(l)if(t.ads.isActive)n.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_ad"),n.appendChild(makeAudioAdPerformerDivider()),n.appendChild(makeAudioDisableAdsLink()),l.innerHTML="",l.appendChild(makeAudioAdMoreLink()),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(o,"audio_song_is_explicit",!1);else{_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_42__.AudioAdActionsModalController.ensure().close();const i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioPerformers(e);e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a,"display","block"),l.innerHTML=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")?i:e.performer,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(e)?n.innerHTML=`<a href="/podcast${e.fullId}" onclick="return showPodcast(this, '${e.fullId}', event, 'player');" class="audio_player_podcast_title">${e.title}</a>`:n.innerHTML=e.hasTrackPage?`<a class="audio_page_player_title_link" href="/audio${e.trackPageId}">${e.title}</a>`:e.title,r.innerHTML=e.subTitle?e.subTitle:"";let s=null;(e.coverUrl_p||(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_36__.isRadio)(e))&&(s=e.coverUrl_p),s?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(u,"background-image","url("+s+")"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(u,"background-size","cover")):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(u,"background-image",null),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(u,"background-size","")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(o,"audio_title_long_performer",e.isLongPerformer),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(o,"audio_song_is_explicit",e.isExplicit);const d=(0,_shared_audioplayer_AudioPlayerAdapter_audioTuple_audioTupleToAudioObject__WEBPACK_IMPORTED_MODULE_40__.audioTupleToAudioObject)(t.getCurrentAudio());if(!_.isLayer()&&t.getCurrentAudio()&&d.fullId===e.fullId){const _=[e.performer,e.title].filter((e=>!!e)).join(" — ");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setDocumentTitle)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.stripHTML)(_))),clearTimeout(window.pageSetTitleTimer)}a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a,"display","none"),l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(l,"display","none"),requestAnimationFrame((()=>{const e=t.ads.isActive?"none":"block";a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a,"display",e),l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(l,"display","block")}))}}function D(e,_){return(0,_shared_audio_formatters_formatAudioTime__WEBPACK_IMPORTED_MODULE_57__.formatAudioTime)({duration:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(_),progress:e,negative:AudioPlayer.getDurationType()})}function O(){if(!_._trackSlider)return;const e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(t.getCurrentAudio()||_._readyAudio);if(!e)return;let i;E&&(E.disabled=!e.hasLyrics),i=_shared_ranges__WEBPACK_IMPORTED_MODULE_43__.Ranges.isGroupId(_.getOwnerId())&&_.canAddToGroup()?e.ownerId!=_.getOwnerId():e.ownerId!=vk.id,g!==i&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(p,i),g=i);const o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAddRestoreInfo();e&&o[e.fullId]&&"added"===o[e.fullId].state||e.ownerId===vk.id?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(p,"audio_player_btn_added"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(p,"audio_player_btn_added"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(p,"no_transition"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClassDelayed)(p,"no_transition"),_.updateRepeatButton()}if(!this._trackSlider){var M,m;const e=(null==(M=t.ads)?void 0:M.isActive)?t.ads.getCurrentProgress():t.getCurrentProgress(),_=(null==(m=t.ads)?void 0:m.isActive)?0:t.getCurrentBuffered(),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_track_slider",o),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_volume_slider",o);i&&(this._trackSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_17__.default(i,{value:e,backValue:_,size:1,hintClass:"audio_player_hint",withBackLine:!0,formatHint:e=>{let _=t.getCurrentAudio()||this._readyAudio;return _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_),(0,_shared_lib_date__WEBPACK_IMPORTED_MODULE_58__.formatTime)(Math.round(e*(_?_.duration:0)))},onEndDragging:e=>{let _=t.getCurrentAudio()||this._readyAudio;_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_),_&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(_)&&t.podcastSetActionRef(_,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.PodcastsLogs.ACTION_SEEK,"",o),t.seek(e)}}),t.ads.isActive&&(this._trackSlider.toggleAdState(!0),this.playerToggleAdsPlaying(!0))),l&&(this._volumeSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_17__.default(l,{value:t.getVolume(),size:1,hintClass:"audio_player_hint",log:!0,formatHint:e=>Math.round(100*e)+"%",onChange:e=>{t.setVolume(e)}})),[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_AUDIOS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_PLAYLISTS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_OWNERS_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_OWNERS_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURATOR_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURATOR_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLACEHOLDER_REMOVE].forEach((e=>t.on(this,e,((_,t)=>{this.catalogController&&this.catalogController.emitEvent(e,t)})))),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_PLAYLISTS_ADD,((e,_)=>{const{playlists:t,playlistsIndex:i}=this._data;Array.isArray(t)&&t.find((e=>e.id===_.id&&e.owner_id===_.owner_id))||(t&&(t.unshift(_),i&&i.add(_)),this.updatePlaylistsCounter(vk.id))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.AD_STARTED,((e,_)=>{this.playerToggleAdsPlaying(!0),this._trackSlider&&(this._trackSlider.toggleAdState(!0),this._trackSlider.setBackValue(0))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.AD_COMPLETED,(()=>{this.playerToggleAdsPlaying(!1),this._trackSlider&&this._trackSlider.toggleAdState(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.START_LOADING,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!0)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CAN_PLAY,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.RADIOSTATION_FOLLOW,((e,_)=>{const t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e);(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_36__.isRadio)(t)&&t.id===_&&P.classList.add(AudioPage.followedRadioClassName);const i=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${_}']`);Array.from(i).forEach((e=>{e.classList.add("AudioRadiostationItem--followed")}))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.RADIOSTATION_UNFOLLOW,((e,_)=>{const t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e);(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_36__.isRadio)(t)&&t.id===_&&P.classList.remove(AudioPage.followedRadioClassName);const i=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${_}']`);Array.from(i).forEach((e=>{e.classList.remove("AudioRadiostationItem--followed")}))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.ADDED,((e,_)=>{(e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e))&&e.fullId==_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(p,"audio_player_btn_added")})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.REMOVED,((e,_)=>{(e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e))&&e.fullId==_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(p,"audio_player_btn_added")})),t.on(this,[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY_REQUESTED],((e,_,i)=>{delete this._readyAudio,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(o,"audio",e),O(),e&&b(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(c,"audio_playing"),_&&!cur.audioStartReadyAudio&&(this._trackSlider&&this._trackSlider.setBackValue(0),!t.ads.isActive&&d&&(d.innerHTML=D(0,e?_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e).duration:0)),s&&(s.setAttribute("title",""),s.titleSet=!1)),h&&(h.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_play")),this.updateCurrentPlayingInfo(),this.updateShuffleButton(),this.updateFaveButton(),this.updateRadioFollowBtn()})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PAUSE,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(c,"audio_playing"),h&&(h.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_play"))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.STOP,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(c,"audio_playing"),h&&(h.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_play"))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.BUFFERED,((e,_)=>{this._trackSlider&&this._trackSlider.setBackValue(_)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.VOLUME,((e,_)=>{this._volumeSlider&&this._volumeSlider.setValue(_,!0)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.ENDED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.UPDATE,((e,_)=>{e&&(e&&b(e),this.updatePlayerClass(e),this.updateRadioFollowBtn()),t.ads.isActive||e&&_&&d&&(d.innerHTML=D(_,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e).duration))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PROGRESS,((e,_,t)=>{this._trackSlider&&(this._trackSlider.toggleLoading(!1),this._trackSlider.setValue(_)),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(t)||isNaN(t)||!d||(d.innerHTML=D(_,t))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.FAILED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURRENT_CHANGED,(()=>{const e=t.getCurrentAudio()||this._readyAudio;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this._els.player,"audio",JSON.stringify(e)),b(e),this.updatePlayerClass(e),this._trackSlider&&this._trackSlider.setValue(0)}))}const A=t.getCurrentAudio()||this._readyAudio;A&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(o,"audio",JSON.stringify(A)),b(A),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(c,"audio_playing",t.isPlaying()),d&&(d.innerHTML=D(1,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(A).duration)),e&&this._trackSlider&&(this._trackSlider.setValue(0),this._trackSlider.setBackValue(0),this._trackSlider.toggleLoading(!1))),O();const C=t.getCurrentAudio()||this._readyAudio;this.updatePlayerClass(C),this.isLayer()||this._initFixedPlayer()},AudioPage.prototype.followRadioFromPlayer=function(e){const _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(e,!0);if(!(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_36__.isRadio)(_))return;const t=_.id,i=(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_37__.getAudioExtra)(_).faveHash;e.classList.contains(AudioPage.followedRadioClassName)?(0,_player_radiostation_unfollowRadiostation__WEBPACK_IMPORTED_MODULE_38__.unfollowRadiostation)(t,i):(0,_player_radiostation_followRadiostation__WEBPACK_IMPORTED_MODULE_39__.followRadiostation)(t,i)},AudioPage.prototype._initFixedPlayer=function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.playerWrap);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(this._els.playerWrap,{width:e[0],height:e[1]});const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.player);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(this._els.player,{width:_[0],height:_[1]});const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)("page_header_wrap")[1],i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.contentBlock)[1],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.playerWrap)[1]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.playerWrap)[1]-t;let s,l,a=!1;const n=()=>{const e=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)(),_=e>i;if(e<o&&(s||a))return clearTimeout(s),clearTimeout(l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed_shown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed"),void(a=s=!1);_&&!a&&(clearTimeout(s),s=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(this._els.player,"audio_page_player_fixed"),l=setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(this._els.player,"audio_page_player_fixed_shown"))),a=!0),!_&&a&&(clearTimeout(s),s=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed_shown"),s=setTimeout((()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed"),s=!1}),250),a=!1)};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"scroll",n),cur.destroy.push((()=>{n&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"scroll",n)}))},AudioPage.prototype.togglePlayerPlay=function(e){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();if(_.isPlaying()){const t=_.getCurrentAudio();t&&_.podcastSetActionRef(t,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.PodcastsLogs.ACTION_PAUSE,"",e),_.pause()}else{const t=this.getPageCurrentPlaylist(),i=_.getCurrentPlaylist(),o=_.getCurrentAudio(),s=_.getPlaylistQueue();let l=o||this._readyAudio;const a=()=>{if(!l)return;if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isClaimedAudio(l)){l=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(l);const e=(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_37__.getAudioExtra)(l).claim;return void(0,_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_18__.showAudioClaimWarning)(l,e)}let o;o=i&&-1!==s.indexOfAudio(l)?i:t&&-1!==t.indexOfAudio(l)?t:new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_TEMP,vk.id),delete this._readyAudio,cur.audioStartReadyAudio=!0,_.podcastSetActionRef(l,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.PodcastsLogs.ACTION_PLAY,"",e),_.play(l,o)};!l&&t?s.getAudioAt(0).then((e=>{l=e,a()})):a()}},AudioPage.prototype.promoAlbumSlideInit=function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_promo");if(this.isLayer()||!e)return;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_promo__items",e);if(!_||_.children.length<=1)return;this.promoAlbumSlideAutoStart(_);const t=()=>this.promoAlbumSlideAutoStop(),i=()=>this.promoAlbumSlideAutoStart(_);(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(e,"mouseenter",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(e,"mouseleave",i),window.cur&&cur.destroy.push((()=>{this.promoAlbumSlideAutoStop(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(e,"mouseenter",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(e,"mouseleave",i)}))},AudioPage.prototype.promoAlbumSlideAutoStart=function(e){window.cur&&(cur._promoAlbumSlideTO=setTimeout((()=>this.promoAlbumSlide(e,1)),SLIDER_TIMEOUT))},AudioPage.prototype.promoAlbumSlideAutoStop=function(){window.cur&&clearTimeout(cur._promoAlbumSlideTO)},AudioPage.prototype.promoAlbumSlide=function(e,_){const t=vk.rtl?_>0?-1:1:_<0?-1:1,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("audio_promo",e);if(!i)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_promo__items",i);if(!o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(o,"sliding"))return;this.promoAlbumSlideAutoStop();const s=o.scrollLeft,l=o.offsetWidth,a=o.children,n=a.length,r=e=>vk.rtl?o.scrollWidth-e*l-l:e*l;if(!(a.length>1))return;this.promoAlbumSlideAutoStart(e);let d=!1,u=null,c=!1,h=Math.round(s/l);h+=t,h>=n||h<0?(d=a[0].cloneNode(!0),o.appendChild(d),h>=n?(c=!0,u=r(h)):h<0&&(o.scrollLeft=r(n),h=n-1,u=r(h))):u=r(h),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(o,"sliding",!0),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_3__.animate)(o,{scrollLeft:u},{duration:500,transition:_web_lib_fx__WEBPACK_IMPORTED_MODULE_3__.Fx.Transitions.swiftOut,onComplete:()=>{c&&(o.scrollLeft=r(0)),d&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(o,"sliding",!1)}})},AudioPage.prototype.handleAudioAdMoreClick=function(e){console.log(e,e.currentTarget)},AudioPage.prototype.playerToggleAdsPlaying=function(e){const _=this._els.player.classList;isAdPlayingWithChoices()&&_.toggle("audio_page_player_with_ad_choices",e),_.toggle("audio_page_player_ads_playing",e)},AudioPage.setVisibilitySectionsContent=function(e){cur.audioPage&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(cur.audioPage._els.sections,e)};try{(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("Audio/Player/LyricsButton/Click",(e=>{const{target:_}=e.payload;if(_.disabled)return;const t=currentAudioPage(e.payload.target),i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayerUI)(),s=i.getCurrentAudio()||t._readyAudio;s&&o.lyrics.open({audio:s,playlist:null,context:s.context})}))}catch(e){console.error(e)}},444402:(e,_,t)=>{t.d(_,{default:()=>r});var i=t(438221),o=t(705758),s=t(795558),l=t(82161),a=t(953908);function n(e,_,t){if((0,l.isObject)(_)?t=_:this._dragElClass=_,this.options=(0,l.extend)({dragThreshold:n.DRAG_THRESHOLD_DIST},t),this._contEl=(0,s.ge)(e),this._contEl){this._excludedCount=0;for(let e=0;e<this._contEl.children.length;e++)this._contEl.children[e].getAttribute("nodrag")&&this._excludedCount++;(0,a.addEvent)(this._contEl,"mousedown",this._ev_mousedown_handler=this._onMouseDown.bind(this)),(0,s.setStyle)(this._contEl,"position","relative"),this._inited=!0,this._updateScrollbar=this._initUpdaterScrollbar()}}n.AUTO_SCROLL_DY=10,n.DRAG_THRESHOLD_DIST=0,n.AUTO_SCROLL_DISTANCE_THRESHOLD=300,n.AUTO_SCROLL_GAP=300,n.prototype.destroy=function(){this._inited&&(this._inited=!1,this._deinitEvents(!0))},n.prototype._getParentDragItemEl=function(e){let _,t=e;for(;t&&(_=(0,s.domPN)(t))!==this._contEl;)t=_;return t===this._curPlaceholderEl&&(t=null),t},n.prototype._onKey=function(e){e.keyCode===a.KEY.ESC&&this.isCurrentlyDragging()&&this._onMouseUp()},n.prototype._onMouseDown=function(e){if(this._disabled||0!=e.button||this._curDragEl||(0,s.attr)(e.target,"nodrag")||this._dragElClass&&!(0,s.domClosest)(this._dragElClass,e.target))return;let _=e.target;for(;_&&_!==window.document;){if((0,l.intval)((0,s.domData)(_,"nodrag")))return;_=(0,s.domPN)(_)}const t=this._getParentDragItemEl(e.target);if(!t||(0,s.attr)(t,"nodrag"))return;if((0,s.re)((0,s.geByClass1)("ui_gridsorter_placeholder"),this._contEl),this._contInfo=this._contInfo||{prevSize:(0,s.getSize)(this._contEl)},this._ensureGridIsActual(),this._grid.length<=1)return;const i=window.getComputedStyle(t),o=(0,s.getXY)(t);this._initial={candidateEl:t,x:e.clientX,y:e.clientY,itemMargin:{x:parseInt(i.marginLeft),y:parseInt(i.marginTop)},shift:{x:e.pageX-o[0],y:e.pageY-o[1]}},(0,a.addEvent)(document,"mousemove",this._ev_mousemove_handler=this._onMouseMove.bind(this)),(0,a.addEvent)(document,"mouseup",this._ev_mouseup_handler=this._onMouseUp.bind(this)),(0,a.addEvent)(document,"keydown",this._ev_keydown_handler=this._onKey.bind(this)),cur.cancelClick=!1,(0,a.cancelEvent)(e)},n.prototype._dist=function(e){return Math.abs(e.clientX-this._initial.x)+Math.abs(e.clientY-this._initial.y)},n.prototype._onMouseUp=function(e){const _=this._curDragEl;let t=!e;if(this._curDragEl){this._curDragEl=null,(0,s.removeClass)(_,"ui_gridsorter_moveable_notrans"),this._curOverCell||(this._curOverCell={el:this._curPlaceholderEl,pos:(0,s.getXY)(this._curPlaceholderEl),size:(0,s.getSize)(this._curPlaceholderEl)});const i=this._curOverCell.pos,o=this._curOverCell.el,l=this._grid[this._curDragCellIndex],n=l&&l.size;(0,s.gpeByClass)("_ape_item_list",_)&&(i[0]+=20,i[1]+=20),n&&this._isShiftToLeft&&(i[1]-=n[1]-this._curOverCell.size[1]),setTimeout((()=>{if(t){for(let e=0,_=this._grid.length;e<_;e++){const _=this._grid[e];_.dirty&&this._setPos(_.el,{left:0,top:0})}this._setPos(_,this._initialCurDragPos)}else this._setPos(_,{left:i[0],top:i[1]})})),setTimeout((()=>{if((0,s.re)(this._curPlaceholderEl),(0,s.removeClass)(this._contEl,"ui_gridsorter_cont"),this.options.dragCls&&(0,s.removeClass)(_,this.options.dragCls),!this._inited)return;let e;if(t){let e=this._grid.length;for(let _=0;_<e;_++){const e=this._grid[_];e.dirty&&this._setPos(e.el,{left:null,top:null})}this._setPos(_,{left:null,top:null,width:null,height:null})}else{let t;e=this._isShiftToLeft?(0,s.domNS)(o):o,this._contEl.insertBefore(_,e);let i=-1,l=this._initial.hasInlineSize;this._setPos(_,{left:null,top:null}),l||(0,s.setStyle)(_,{width:null,height:null});let a=this._grid.length;for(let e=0;e<a;e++){const a=this._grid[e];(a.dirty||a.el===_)&&(this._setPos(a.el,{left:null,top:null}),l||(0,s.setStyle)(a.el,{width:null,height:null}),a.pos=this._calcElementPos(a.el),a.dirty=!1),a.el===_?t=e:a.el===o&&(i=e)}if(i>=0){const e=this._grid.splice(t,1);this._grid.splice(i,0,e[0])}}(0,s.removeClass)(_,"ui_gridsorter_moveable"),this._curOverCell=this._curPlaceholderEl=null,t&&this.update(),this.options.onDragFinish&&this.options.onDragFinish(_),o!==_&&!t&&this.options.onReorder&&this.options.onReorder(_,e,(0,s.domPS)(_))}),210),e&&this._dist(e)>5&&((0,a.cancelEvent)(e),cur.cancelClick=!0)}this._updateScrollbar(),this._deinitEvents(),_&&this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,_),t||_&&this._overEl&&this.options.onDragDrop&&(t=this.options.onDragDrop(this._overEl,_)),this._overEl=null},n.prototype._deinitEvents=function(e){e&&(this._onMouseUp(),(0,a.removeEvent)(this._contEl,"mousedown",this._ev_mousedown_handler)),clearTimeout(this._autoScrollTO),this._autoScrollTO=!1,this._ev_mousemove_handler&&(0,a.removeEvent)(document,"mousemove",this._ev_mousemove_handler),this._ev_mouseup_handler&&(0,a.removeEvent)(document,"mouseup",this._ev_mouseup_handler),this._ev_keydown_handler&&(0,a.removeEvent)(document,"keydown",this._ev_keydown_handler)},n.prototype._setPos=function(e,_){this.options.noPosTransform||!this._hasTranslateFeauture&&!(this._hasTranslateFeauture=window.getComputedStyle(e).getPropertyValue("transform"))?(0,s.setStyle)(e,(0,l.extend)({transform:null},_)):null===_.left||null===_.top?(0,s.setStyle)(e,{transform:null,top:null,left:null}):(0,s.setStyle)(e,{transform:"translate("+_.left+"px, "+_.top+"px)",top:null,pos:null})},n.prototype._recalc=function(){const e=this._curDragEl,_=this._curOverCell.el;if(this._initGrid(),_===e){let _=this._grid.length;for(let t=0;t<_;t++){const _=this._grid[t];_.el!==e&&_.dirty&&(_.dirty=!1,this._setPos(_.el,{left:null,top:null}))}return}let t=0,i=!1,o=!1,s=this._grid.length;for(let t=0;t<s;t++){const o=this._grid[t];if(o.el===e){i=!0;break}if(o.el===_){i=!1;break}}this._isShiftToLeft=i;let l=i?0:this._grid.length-1,a=i?this._grid.length:-1,n=i?1:-1,r=[0,0];for(;l!==a;l+=n){const s=this._grid[l];if(2!==t)if(s.el!==e){if(s.el===_&&t++,1===t||2===t){let e=0,_=0;i?(e=o.pos[0]+r[0],_=o.pos[1]+r[1],r[0]+=s.size[0]-o.size[0],r[1]+=s.size[1]-o.size[1]):(r[0]+=o.size[0]-s.size[0],r[1]+=o.size[1]-s.size[1],e=o.pos[0]+r[0],_=o.pos[1]+r[1]),this._setPos(s.el,{left:e-s.pos[0],top:_-s.pos[1]}),s.dirty=!0}else s.dirty&&(this._setPos(s.el,{left:null,top:null}),s.dirty=!1);o=s}else t++,o=s;else s.dirty&&(this._setPos(s.el,{left:null,top:null}),s.dirty=!1),o=s}},n.prototype.disable=function(){this._disabled=!0},n.prototype.enable=function(){this._disabled=!1,this._initGrid(!0)},n.prototype.update=function(){this._disabled||this._initGrid(!0)},n.prototype._ensureGridIsActual=function(){this._initGrid()},n.prototype._needGridUpdate=function(){if(!this._grid)return 1;this._contInfo.prevSize=this._contInfo.prevSize||(0,s.getSize)(this._contEl);let e=0,_=this._contEl.children.length-this._excludedCount-(0,l.intval)(!!this._curPlaceholderEl);if(_!==this._grid.length)e=_>this._grid.length?2:1,this._contInfo.prevSize=(0,s.getSize)(this._contEl);else{let _=(0,s.getSize)(this._contEl),t=this._contInfo.prevSize;(Math.abs(t[0]-_[0])>5||Math.abs(t[1]-_[1])>5)&&(e=1),this._contInfo.prevSize=_}return e},n.prototype._initGrid=function(e){let _=e?1:this._needGridUpdate();if(!_)return;1===_&&(this._grid=[],this._contInfo&&(delete this._contInfo.pos,delete this._contInfo.size));let t=this._grid?this._grid[this._grid.length-1]:null;this._grid=this._grid||[];let i,o=!!t,l=this._contEl.children;if(!l.length)return;let a=this._getItemMargins();for(let e=this._curDragEl?this._grid.length:0,_=l.length;e<_;e++){let _=l[e];t&&_===t.el?o=!1:o||_===this._curPlaceholderEl||_.getAttribute("nodrag")||(i=(0,s.getSize)(_),i[0]+=a[0],i[1]+=a[1],this._grid.push({el:_,size:i,pos:this._calcElementPos(_)}))}},n.prototype._getRelativeMousePos=function(e){let _=this._getContPos(),t=this._getContShift();return{left:e.clientX-_[0]-t[0],top:e.clientY-_[1]-t[1]}},n.prototype._updateDraggablePosition=function(e){if(!this._curDragEl)return;let _=this._getRelativeMousePos(e),t=this._getItemShift(),i=this._getContShift(),o=this._getContSize(),l=_.top-this._initial.shift.y-t[1]+i[1];this.options.limitBottomMove&&(l=Math.min(l,o[1]+30)),(0,s.hasClass)(this._contEl,"_ape_item_list")&&(l+=this._contEl.scrollTop),this._setPos(this._curDragEl,{left:_.left-this._initial.shift.x-t[0]+i[0],top:l}),window.AudioPage&&window.AudioPage.onUpdateDraggablePosition&&window.AudioPage.onUpdateDraggablePosition()},n.prototype._getContShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.shift){let e=window.getComputedStyle(this._contEl);this._contInfo.shift=[parseFloat(e.paddingLeft),parseFloat(e.paddingTop)]}return this._contInfo.shift},n.prototype._getContSize=function(){return this._contInfo=this._contInfo||{},this._contInfo.size=(0,s.getSize)(this._contEl),this._contInfo.size},n.prototype._getContPos=function(){return this._contInfo=this._contInfo||{},this._contInfo.pos=(0,s.getXY)(this._contEl),this._contInfo.pos[1]-=(0,i.scrollGetY)(),this._contInfo.pos},n.prototype._getItemShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemShift){let e=window.getComputedStyle((0,s.domFC)(this._contEl));this._contInfo.itemShift=[parseFloat(e.marginLeft),parseFloat(e.marginTop)]}return this._contInfo.itemShift},n.prototype._getItemMargins=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemMargins){let e=window.getComputedStyle((0,s.domFC)(this._contEl));this._contInfo.itemMargins=[parseFloat(e.marginLeft)+parseFloat(e.marginRight),parseFloat(e.marginTop)+parseFloat(e.marginBottom)]}return this._contInfo.itemMargins},n.prototype._calcElementPos=function(e){let _=this._getContShift(),t=this._getItemShift();return[e.offsetLeft-_[0]-t[0],e.offsetTop-_[1]-t[1]]},n.prototype.isCurrentlyDragging=function(){return!!this._curDragEl},n.prototype._initUpdaterScrollbar=function(){return(0,o.throttle)((e=>{const _=this.options.wrapNode||e;let t=(0,s.data)(_,"sb");t&&t.update(!1,!0)}),500)},n.prototype._onMouseMove=function(e){const _=()=>this.options.wrapNode?this.options.wrapNode.scrollTop:(0,i.scrollGetY)(),t=e=>{this.options.wrapNode?this.options.wrapNode.scrollTop=e:(0,i.scrollToY)(e,0,!1,!0)};if(this._curDragEl){this._ensureGridIsActual(),!e&&(e={clientX:this._lastMousePos.x,clientY:this._lastMousePos.y}),this._lastMousePos={x:e.clientX,y:e.clientY},this._updateDraggablePosition(e);let o=this._getContSize(),l=this._getRelativeMousePos(e),a=!1;if((0,s.hasClass)(this._contEl,"_ape_item_list")&&(l.top+=this._contEl.scrollTop),l.left>0&&l.left<o[0]&&l.top>0&&l.top<o[1]){let e=0,_=this._grid.length-1,t=50;for(;t;){let i=e+Math.floor((_-e)/2);const o=this._grid[i];if(l.left>o.pos[0]&&l.top>o.pos[1]&&l.left<o.pos[0]+o.size[0]&&l.top<o.pos[1]+o.size[1]){a=o;break}if(e===_)break;l.top<o.pos[1]||l.left<o.pos[0]&&l.top<o.pos[1]+o.size[1]?_=_===i?_-1:i:e=e===i?e+1:i,t--}}else{let e,_,t,i=this._grid.length,o=999999;for(let s=0;s<i;s++){const i=this._grid[s];_=l.left-(i.pos[0]+i.size[0]/2),t=l.top-(i.pos[1]+i.size[1]/2);const a=_*_+t*t;o>a&&(o=a,e=i)}a=e}!a||this._curOverCell&&this._curOverCell.el===a.el||(this._curOverCell=a,this._recalc());{let o,l,a,n,r=0;if(this.options.wrapNode)o=n=this.options.wrapNode,l=(0,s.getSize)(o),a=(0,s.getXY)(o),a[1]-=(0,i.scrollGetY)(),r=e.clientY;else{let _=window,t=document.documentElement,i=document.body,o=_.innerWidth||t.clientWidth||i.clientWidth,s=_.innerHeight||t.clientHeight||i.clientHeight;n=_.bodyNode,l=[o,s],a=[0,0],r=e.clientY}let d=Math.max(20,l[1]/10),u=a[1]+d-r,c=d-(a[1]+l[1]-r);if(c>0||u>0){let e=Math.min(1,u/d),i=Math.min(1,c/d);this._autoScrollTO||(this._autoScrollTO=setTimeout((()=>{this._autoScrollTO=!1;let o=_();t(o+16*(e>0?-e:i)),o!==n.scrollTop&&(this._updateScrollbar(n),this._onMouseMove())}),20))}}if(this.options.onDragOverElClass){let _=e.target;(0,s.hasClass)(_,this.options.onDragOverElClass)||(_=(0,s.gpeByClass)(this.options.onDragOverElClass,_))?this._overEl!==_&&(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this.options.onDragEnter&&this.options.onDragEnter(_,this._curDragEl),this._overEl=_):(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this._overEl=null)}}else if(this._dist(e)>this.options.dragThreshold){this._curDragEl=this._initial.candidateEl;let _=this._grid.length;for(let e=0;e<_;e++)if(this._grid[e].el===this._curDragEl){this._curDragCellIndex=e;break}this.options.dragCls&&(0,s.addClass)(this._curDragEl,this.options.dragCls);const t=(0,s.getSize)(this._curDragEl),i=(0,s.getXY)(this._curDragEl),o=window.getComputedStyle(this._curDragEl),l=this._getContPos();this._initial.hasInlineSize=!(!this._curDragEl.style.width&&!this._curDragEl.style.height),(0,s.setStyle)(this._curDragEl,{width:t[0],height:t[1]}),this._initialCurDragPos={left:i[0]-l[0],top:i[1]-l[1]-document.body.scrollTop},this._curPlaceholderEl=(0,s.ce)("div",{className:"ui_gridsorter_placeholder"}),(0,s.setStyle)(this._curPlaceholderEl,{width:t[0]+parseFloat(o.marginLeft)+parseFloat(o.marginRight),height:t[1]+parseFloat(o.marginTop)+parseFloat(o.marginBottom)}),this._contEl.insertBefore(this._curPlaceholderEl,this._curDragEl),(0,s.addClass)(this._curDragEl,"ui_gridsorter_moveable"),(0,s.addClass)(this._curDragEl,"ui_gridsorter_moveable_notrans"),(0,s.addClass)(this._contEl,"ui_gridsorter_cont"),this._onMouseMove(e),this._updateDraggablePosition(e),this.options.onDragStart&&this.options.onDragStart(this._curDragEl)}(0,a.cancelEvent)(e)};const r=n},145637:(e,_,t)=>{t.d(_,{ON_BOARDING_BG_RECT_ID:()=>n,default:()=>u});var i=t(795558),o=t(953908),s=t(438221),l=t(23087),a=t(84543);const n="onboarding_bg_rect",r="page_header_cont",d="onboarding";class u{initOnboardingBG(){if(!window.onboardingBG){let e='\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ',_=(0,i.se)(e);(0,i.domInsertBefore)(_,window.layerBG),window.onboardingBGHeader=(0,i.ge)("onboarding_bg_header"),window.onboardingBG=(0,i.ge)("onboarding_bg"),window.onboardingBGRect=(0,i.ge)(n),window.onboardingBGClip=(0,i.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,i.hide)(window.onboardingBG),(0,i.hide)(window.onboardingBGHeader),(0,i.removeClass)((0,i.ge)(r),d),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,o.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){const[,e]=(0,i.getXY)(this.el);this.tt=new a.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();const _=this.tt.getContent();(0,l.isElementInViewport)(this.el)&&(0,l.isElementInViewport)(_)||(0,s.scrollToY)(e-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,o.removeEvent)(window,"scroll"),(0,o.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,o.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,o.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){let e=this.el.offsetWidth,_=this.el.offsetHeight,t=(0,i.getXY)(this.el);(0,i.attr)(window.onboardingBGClip,"width",e+this.border[1]+this.border[3]),(0,i.attr)(window.onboardingBGClip,"height",_+this.border[0]+this.border[2]),(0,i.attr)(window.onboardingBGClip,"x",t[0]-this.border[1]),(0,i.attr)(window.onboardingBGClip,"y",t[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){let e=this.getPageHeight();window.onboardingBG.height!=e&&this.setDartToFullHeight()}setDartToFullHeight(){(0,i.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,i.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,i.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,i.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,i.show)(window.onboardingBG),(0,i.isVisible)(window.onboardingBGHeader)||((0,i.show)(window.onboardingBGHeader),(0,i.addClass)((0,i.ge)(r),d)))}removeDarkens(){this.hideDarkness&&((0,i.hide)(window.onboardingBG),(0,i.hide)(window.onboardingBGHeader),(0,i.removeClass)((0,i.ge)(r),d))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){const e=document.documentElement,_=document.body;return Math.max(_.scrollWidth,e.scrollWidth,_.offsetWidth,e.offsetWidth,_.clientWidth,e.clientWidth)}getPageHeight(){const e=document.documentElement,_=document.body;return Math.max(_.scrollHeight,e.scrollHeight,_.offsetHeight,e.offsetHeight,_.clientHeight,e.clientHeight)}constructor(e,_,t={}){this.el=e,this.text=_,this.hideDarkness=!0,this.oldColor=!1;var i;let o={autoShow:!1,noAutoHideOnWindowClick:null==(i=t.noAutoHideOnWindowClick)||i,content:_ instanceof HTMLElement?_:`${_}`,cls:`feature_intro_tt tutorial_tip_tt ${(()=>{var e;const _=null!=(e=t.class)?e:"";return t.tooltipWhite?_:_+" feature_intro_blue_tt"})()}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:t.scrollOffset||0,align:t.align||a.ElementTooltip.ALIGN_CENTER};t.side&&(o.forceSide=t.side),t.offset&&(o.offset=t.offset),t.width&&(o.width=t.width),t.shift&&(o.centerShift=t.shift),t.border?this.border=t.border:this.border=[10,10,10,10],t.ttOnHide&&(o.onHide=t.ttOnHide),t.withCloseButton&&(o.withCloseButton=t.withCloseButton,o.onCloseButtonClick=t.onCloseButtonClick),t.align&&(o.align=t.align),this.ttParams=o,this.opts=t,this.initOnboardingBG()}}},23087:(e,_,t)=>{function i(e){const _=e.getBoundingClientRect();return _.top>=0&&_.left>=0&&_.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&_.right<=(window.innerWidth||document.documentElement.clientWidth)}t.d(_,{isElementInViewport:()=>i})},276125:(e,_,t)=>{t.d(_,{default:()=>r});var i=t(795558),o=t(29271),s=t(82161),l=t(953908),a=t(936134);function n(e,_){if(this.constructor!=n)throw new Error("Slider was called without 'new' operator");if(!e)throw new Error("No element was provided for Slider");e=(0,i.ge)(e),this.options=_||{size:1},this.options.backValue=this.options.backValue||0;const t=100*this.options.backValue,o=`<div class="slider_slide"><div class="slider_loading_bar" style="opacity: 0; display: none;"></div> ${this.options.withBackLine?'<div class="slider_back" style="width:'+t+'%"></div>':""} <div class="slider_amount"></div> <div class="slider_handler"></div> </div>`;this._el=(0,i.ce)("div",{innerHTML:o,className:"slider",id:e.getAttribute("id")||""});const r=e.classList||[],d=this;for(let e=0,_=r.length;e<_;e++)(0,i.addClass)(this._el,r[e]);(0,s.each)(this._el.attributes,(function(e,_){"id"==_.name&&"class"==_.name||d._el.setAttribute(_.name,_.value)})),e.parentNode.replaceChild(this._el,e),(0,i.data)(this._el,"slider",this),this._amountEl=(0,i.geByClass1)("slider_amount",this._el),this._handlerEl=(0,i.geByClass1)("slider_handler",this._el),this._slideEl=(0,i.geByClass1)("slider_slide",this._el),this._backEl=(0,i.geByClass1)("slider_back",this._el),this._progressEl=(0,i.geByClass1)("slider_loading_bar",this._el),this.options.color&&((0,i.setStyle)(this._amountEl,{backgroundColor:this.options.color}),(0,i.setStyle)(this._handlerEl,{backgroundColor:this.options.color})),this.options.handlerColor&&(0,i.setStyle)(this._handlerEl,{backgroundColor:this.options.handlerColor}),this.options.backColor&&(0,i.setStyle)(this._slideEl,{backgroundColor:this.options.backColor}),(0,i.addClass)(this._el,"slider_size_"+this.options.size),this.options.debounce&&(this._onValueChangeDebounced=(0,a.debounce)(this._onValueChange,this.options.debounce)),_.formatHint&&((0,l.addEvent)(this._el,"mousemove",this._ev_onMouseOver=this._onMouseOver.bind(this)),(0,l.addEvent)(this._el,"mouseleave",this._ev_onMouseLeave=this._onMouseLeave.bind(this))),(0,l.addEvent)(this._el,"mousedown",this._ev_onMouseDown=this._onMouseDown.bind(this)),this.setValue(this.options.value||0,!this.options.fireChangeEventOnInit,!1),this.setBackValue(this.options.backValue)}n.prototype.toggleAdState=function(e){this._adState=!!e,(0,i.toggleClass)(this._el,"slider_ad_mode",!!e)},n.prototype.toggleAdMarker=function(e){e=!!e;let _=(0,i.geByClass1)("slider_ad_marker",this._el);if(e){if(!_){const e="onmouseover=\"showTooltip(this, {text: '"+o.getLang("global_audio_ad")+"', black: 1, shift: [16, 9, 10]})\"";_=(0,i.se)('<div class="slider_ad_marker_wrap" '+e+'><div class="slider_ad_marker"></div></div>'),(0,i.domPN)(this._slideEl).insertBefore(_,this._slideEl),delete this._width,(0,i.addClass)(this._el,"slider_ad_marker_shown")}}else(0,i.re)(_),delete this._width,(0,i.removeClass)(this._el,"slider_ad_marker_shown")},n.prototype.showAdMarker=function(e){const _=(0,i.se)('<div class="slider_ad_marker"></div>');(0,i.domPN)(this._slideEl).insertBefore(_,this._slideEl),delete this._width,(0,i.addClass)(this._el,"slider_ad_marker_shown")},n.prototype.isAdMode=function(){return(0,i.hasClass)(this._el,"slider_ad_mode")},n.prototype.setBlocked=function(e){this.blocked=e,(0,i.toggleClass)(this._el,"slider_blocked",e)},n.prototype.getBlocked=function(){return this.blocked},n.prototype.isBlocked=function(){return this.isAdMode()||this.getBlocked()},n.prototype.toggleLoading=function(e){e=!!e,(0,i.toggle)(this._progressEl,e),(0,i.setStyle)(this._progressEl,"opacity",e?1:0)},n.prototype.destroy=function(e){this.options.formatHint&&((0,l.removeEvent)(this._el,"mousemove",this._ev_onMouseOver),(0,l.removeEvent)(this._el,"mouseleave",this._ev_onMouseLeave),(0,l.removeEvent)(this._el,"mousedown",this._ev_onMouseDown)),(0,i.re)(this._el),(0,i.re)(this._currHintEl)},n.prototype._updateHint=function(e,_){this._currHintEl||(this._currHintEl=(0,i.se)('<div class="slider_hint" id="slider_hint"></div>'),this.options.hintClass&&(0,i.addClass)(this._currHintEl,this.options.hintClass),this._el.appendChild(this._currHintEl)),this._width=this._width||(0,i.getSize)(this._slideEl)[0];const t=this._getPos();let o=Math.round(e.pageX-t[0]);const s=this._width;if(o=_?Math.min(Math.max(0,o),s):o,o>=0&&o<=s){const e=o/s;this._currHintEl.innerHTML=this.options.formatHint?this.options.formatHint.call(this,e):e;const t=(0,i.getSize)(this._currHintEl);(0,i.setStyle)(this._currHintEl,{left:this._slideEl.offsetLeft+o-t[0]/2,top:this._slideEl.offsetTop-t[1]-10}),!_&&this._toggleHint(!0)}else!_&&this._toggleHint(!1);this.options.formatHint||this._toggleHint(!1)},n.prototype._toggleHint=function(e){this.isAdMode()&&(e=!1),(0,i.toggleClass)(this._currHintEl,"visible",e)},n.prototype._onMouseOver=function(e){n._currenSliderDrag||(0,i.hasClass)(this._el,"active")||this._updateHint(e)},n.prototype._onMouseLeave=function(e){(0,i.hasClass)(this._el,"active")||this._toggleHint(!1)},n.prototype._onMouseDown=function(e){0==e.button&&(delete cur._sliderMouseUpNowEl,this._adState||this.getBlocked()||((0,l.addEvent)(window,"mousemove",this._ev_onMouseMove=this._onMouseMove.bind(this)),(0,l.addEvent)(window,"mouseup",this._ev_onMouseUp=this._onMouseUp.bind(this)),this._width=(0,i.getSize)(this._slideEl)[0],this._onMouseMove(e),n._currenSliderDrag=this,(0,i.addClass)(this._el,"active"),(0,l.cancelEvent)(e)))},n.prototype._onMouseUp=function(e){cur._sliderMouseUpNowEl=this._el,(0,l.removeEvent)(window,"mousemove",this._ev_onMouseMove),(0,l.removeEvent)(window,"mouseup",this._ev_onMouseUp),clearTimeout(this._debounceto),this._onValueChange(),(0,i.removeClass)(this._el,"active"),n._currenSliderDrag=!1,this._toggleHint(!1),this.options.onEndDragging&&this.options.onEndDragging(this._currValue)},n.prototype._onMouseMove=function(e){const _=this._getPos();let t=Math.max(e.pageX,_[0]);t=Math.min(t,_[0]+this._width),t-=_[0],this.setValue(t/this._width,!0,!0),this._onValueChangeDebounced?this._onValueChangeDebounced():this._onValueChange(),this._toggleHint(!0),this._updateHint(e,!0),(0,l.cancelEvent)(e)},n.prototype._getPos=function(){return this._slidePos=(0,i.getXY)(this._slideEl)},n.LOGFBASE=35,n.prototype._logf=function(e){if(!this.options.log)return e;const _=n.LOGFBASE;return(Math.pow(_,e)-1)/(_-1)},n.prototype._unlogf=function(e){if(!this.options.log)return e;const _=n.LOGFBASE;return t=_,i=1+e*(_-1),Math.log(i)/Math.log(t);var t,i},n.prototype.setValue=function(e,_,t){if((0,i.hasClass)(this._el,"active")&&!t)return;const o=t?this._logf(e):e;if(this._currValue==o)return;this._currValue=o;let s=t?e:this._unlogf(e);s=100*s+"%",(0,i.setStyle)(this._amountEl,{width:s}),(0,i.setStyle)(this._handlerEl,{left:s}),!_&&this._onValueChange()},n.prototype.setBackValue=function(e){(0,i.toggleClass)(this._backEl,"slider_back_transition",e>this._backValue),this._backValue=e;const _=100*e+"%";(0,i.setStyle)(this._backEl,{width:_})},n.prototype._onValueChange=function(){this._lastValue=this._lastValue||0,this._lastValue!=this._currValue&&(this._lastValue=this._currValue,this.options.onChange&&this.options.onChange(this._currValue))};const r=n},258810:(e,_,t)=>{t.r(_),t.d(_,{UiScroll:()=>d,default:()=>u});var i=t(301230),o=t(664988),s=t(82161),l=t(795558),a=t(953908),n=t(893106),r=t(332066);class d{init(){if(this.options.stopScrollPropagation&&this.fixBlocker(),!this.inited){if(!this.el.container.scrollWidth||this.disabled)return;this.fixSize(!0),this.options.autoresize&&this.startResizeListening(),this.options.global||cur.destroy.push(this.destroy.bind(this)),this.inited=!0}return this.update(!0),this.api}addEvent(e,_,t,i){return this.removeEvents.push([e,_,t]),(0,a.addEvent)(e,_,t,void 0,void 0,i?{passive:!0}:void 0),t}destroy(){if(this.disabled=!0,this.fixSize(),this.animation&&this.animation.stop(),this.moreTimeout&&clearTimeout(this.moreTimeout),this.dragstopHandler&&(0,a.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,a.removeEvent)(document,"mousemove",this.dragHandler),(0,s.each)(this.removeEvents,(function(e,_){a.removeEvent.apply(null,_)})),this.el.overflow.parentNode==this.el.container){const e=(0,l.cf)();for(;this.el.content.firstChild;)e.appendChild(this.el.content.firstChild);this.el.container.appendChild(e)}return(0,l.removeData)(this.el.container,"ui-scroll"),this.el.container.className=this.el.container.className.replace(/\bui_scroll_.+?\b/g," "),(0,s.each)(this.removeElements,(function(e,_){(0,l.re)(_)})),this.el.container.scrollTop=this.api.data.scrollTop,delete this.el.container.__uiScroll__,this.api}updateAbove(e){if((0,s.isFunction)(e)){this.animation&&this.animation.stop();const _=this.el.outer.scrollHeight-this.el.outer.scrollTop-this.el.overflow.offsetHeight;e(),this.el.outer.scrollTop=this.el.outer.scrollHeight-this.el.overflow.offsetHeight-_}return this.api}updateBelow(e){if((0,s.isFunction)(e)){this.animation&&this.animation.stop();const _=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;e(),_&&this.scrollBottom(!1)}return this.api}fixBlocker(){i.browser.chrome&&!this.options.noForceReFlow&&this.forceReFlow(),this.el.blocker.scrollTop=this.blockerScrollTop}forceReFlow(){this.el.blocker.style.display="inline-block",this.el.blocker.offsetHeight,this.el.blocker.style.display=""}fixSize(e){this.options.native||(e&&null==this.fixSizeDefault&&(this.fixSizeDefault=this.el.container.style.width),(0,l.setStyle)(this.el.container,"width",e?(0,l.getSize)(this.el.container,!0)[0]||this.fixSizeDefault||"":this.fixSizeDefault||""))}emitEvent(e){this.disabled||this.inited&&this.emitter.emitEvent(e,[this.api])}static scrollEventDelta(e){let _=0;const t=void 0!==e.deltaMode?e.deltaMode:"MozMousePixelScroll"==e.type?0:1;return"wheel"==e.type?_=e.deltaY:void 0!==e.wheelDeltaX&&void 0!==e.wheelDeltaY?(_=1/40*-e.wheelDeltaY,i.browser.mac&&i.browser.opera&&(_*=.1)):void 0!==e.wheelDelta?_=1/40*-e.wheelDelta:e.detail&&2===e.axis&&(_=e.detail),_*(1==t?15:2==t?450:1)}isScrollEventUnused(e){return d.scrollEventDelta(e)>0?!this.api.data.scrollBottom:!this.api.data.scrollTop}resize(e){if(!e&&this.options.preserveEdgeBelow){const _=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;this.update(!0)&&(this.emitEvent("resize"),_&&this.scrollBottom(),this.options.stopScrollPropagation&&!e&&this.fixBlocker())}else this.update(!0)&&(this.options.stopScrollPropagation&&!e&&this.fixBlocker(),this.emitEvent("resize"))}disable(e){return this.disabled=!!e,e?(this.animation&&this.animation.stop(),this.fixSize()):(this.fixSize(!0),this.options.stopScrollPropagation&&this.fixBlocker(),this.update(!0)),(0,l.toggleClass)(this.el.container,"ui_scroll_disabled",this.disabled),this.api}dragstart(e){if(!(this.disabled||this.dragging||this.options.native))return e||(e=window.event),this.dragging=!0,this.animation&&this.animation.stop(),this.options.reversed&&(this.noMore=!0),(0,a.addEvent)(document,"mouseup contextmenu",this.dragstartHandler=this.dragstop.bind(this)),(0,a.addEvent)(document,"mousemove",this.dragHandler=this.drag.bind(this)),this.dragScroll=this.options.reversed?this.api.data.scrollBottom:this.api.data.scrollTop,this.dragY=e.screenY,(0,a.cancelEvent)(e),this.emitEvent("dragstart"),this.api}dragstop(e){if(!this.disabled&&this.dragging&&!this.options.native){if(e||(e=window.event),this.dragging=!1,this.dragstopHandler&&(0,a.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,a.removeEvent)(document,"mousemove",this.dragHandler),(0,l.setStyle)(document.body,"cursor",""),(0,l.removeClass)(this.el.container,"ui_scroll_dragging"),this.dragged)this.noMore&&(this.noMore=!1,this.more());else{this.options.reversed&&(this.noMore=!0);const _=(e.pageY-(0,l.getXY)(this.el.barOuter)[1]-this.barInnerHeight/2)*(Math.max(this.options.minContentHeight,this.api.data.scrollHeight)-this.api.data.viewportHeight)/(this.barOuterHeight-this.barInnerHeight);this.scrollTop(!1,_,0,function(){this.noMore&&(this.noMore=!1,this.more())}.bind(this))}return this.dragged=!1,e&&"contextmenu"!==e.type&&(0,a.cancelEvent)(e),this.emitEvent("dragstop"),this.api}}drag(e){if(this.disabled||!this.dragging||this.options.native)return;e||(e=window.event);const _=(e.screenY-this.dragY)*(this.api.data.scrollHeight/this.el.barOuter.scrollHeight);return this.el.outer.scrollTop=this.options.reversed?this.el.outer.scrollHeight-this.el.overflow.offsetHeight-this.dragScroll+_:this.dragScroll+_,this.dragged||(this.dragged=!0,(0,l.setStyle)(document.body,"cursor","pointer"),(0,l.addClass)(this.el.container,"ui_scroll_dragging")),(0,a.cancelEvent)(e),this.emitEvent("drag"),this.api}scroll(e,_,t){return this.animation&&this.animation.stop(),this.el.outer.scrollTop==e&&this.update(!0),_?(_="number"!=typeof _||!isFinite(_)||_%1?300:Math.abs(_),this.animation=new n.Fx.Base({scrollTop:this.el.outer.scrollTop},{transition:n.Fx.Transitions.easeOutCubic,onStep:function(e){this.el.outer.scrollTop=e.scrollTop}.bind(this),duration:_,onComplete:(0,s.isFunction)(t)?t.pbind(this.api):void 0}).start({scrollTop:this.el.outer.scrollTop},{scrollTop:e})):(this.el.outer.scrollTop=e,(0,s.isFunction)(t)&&t(this.api)),this.api}scrollTop(e,_,t,i){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll((0,s.intval)(_),t,i)}scrollBottom(e,_,t,i){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollHeight-this.el.overflow.offsetHeight-(0,s.intval)(_),t,i)}scrollBy(e,_,t){if(!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollTop+(0,s.intval)(e),_,t)}scrollIntoView(e,_,t,i){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),(_=(0,r.getScrollElement)(_))&&_.compareDocumentPosition&&_.compareDocumentPosition(this.el.content)&Node.DOCUMENT_POSITION_CONTAINS){const e=(0,l.getXY)(_)[1],o=(0,l.getXY)(this.el.overflow)[1],a=(0,l.getSize)(_)[1];if(e<=o&&e+a>=o+this.api.data.viewportHeight||e>=o&&e+a<=o+this.api.data.viewportHeight)(0,s.isFunction)(i)&&(t?setTimeout(i.bind(this.api),0):i(this.api));else if(a>this.api.data.viewportHeight||e<o)this.scrollTop(!1,e-o+this.api.data.scrollTop-(this.options.shadows?(0,l.getSize)(this.el.shadowTop)[1]:0),t,i);else{const _=this.options.shadows?(0,l.getSize)(this.el.shadowBottom)[1]:0;this.scrollTop(!1,e-o+this.api.data.scrollTop+a-this.api.data.viewportHeight+_,t,i)}}return this.api}update(e){let _,t;this.el.container&&!this.el.container.updateScroll&&(this.el.container.updateScroll=this.update.bind(this,!1));const i=this.el.outer.scrollTop;if(this.inited&&!this.disabled&&(e&&(_=this.el.inner.offsetHeight,this.api.data.viewportHeight!==(this.api.data.viewportHeight=this.el.overflow.offsetHeight)||this.api.data.scrollHeight!==_)||this.api.data.scrollTop!==i)){if(e&&(this.api.data.scrollHeight=_),this.api.data.scrollTop=Math.max(0,Math.min(this.api.data.scrollHeight-this.api.data.viewportHeight,Math.max(0,i))),this.api.data.scrollBottom=Math.max(0,this.api.data.scrollHeight-this.api.data.scrollTop-this.api.data.viewportHeight),!this.options.native){if(_=Math.max(this.options.minContentHeight,this.api.data.scrollHeight),t=_<=this.api.data.viewportHeight,!t){const t=this.el.barOuter.offsetHeight;(e||this.barOuterHeight!==t)&&(this.barOuterHeight=t,this.barInnerHeight=Math.max(this.options.barMinHeight,this.barOuterHeight*this.api.data.viewportHeight/_),this.el.barInner.style.height=this.barInnerHeight+"px"),(0,r.nextFrame)((()=>{const e=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(_-this.api.data.viewportHeight);this.el.barInner.style.transform=`translateY(${e}px)`}))}this.options.shadows&&(this.shadowTop!=(this.api.data.scrollTop&&!t)&&(0,l.toggleClass)(this.el.container,"ui_scroll_shadow_top_visible",this.shadowTop=this.api.data.scrollTop&&!t),this.shadowBottom!=(this.api.data.scrollBottom&&!t)&&(0,l.toggleClass)(this.el.container,"ui_scroll_shadow_bottom_visible",this.shadowBottom=this.api.data.scrollBottom&&!t)),this.unnecessary!==t&&((0,l.toggleClass)(this.el.container,"ui_scroll_unnecessary",t),this.unnecessary=t,this.options.stopScrollPropagation&&this.fixBlocker(),t&&this.barInnerHeight&&this.barOuterHeight&&(0,r.nextFrame)(function(e){this.el.barInner.style.height=100*this.barInnerHeight/this.barOuterHeight+"%";const t=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(_-this.api.data.viewportHeight)*100/this.barInnerHeight;this.el.barInner.style.transform=`translateY(${t}%)`}.bind(this)))}return this.emitEvent("update"),(!this.options.reversed||i>=0)&&this.more(),!0}return!1}more(){const e=this.options.reversed?this.api.data.scrollTop:this.api.data.scrollBottom,_=null!==this.options.onmoreThreshold?this.options.onmoreThreshold:2*this.api.data.viewportHeight;!this.noMore&&e<=_&&this.emitEvent("more")}constructor(e,_){if(!(e=(0,r.getScrollElement)(e)))throw new Error("uiScroll container is undefined");e.__uiScroll__&&e.__uiScroll__.destroy(),this.options=(0,s.extend)({global:!1,native:!1,theme:"default",reversed:!1,autoresize:!0,preserveEdgeBelow:!1,barMinHeight:30,preserveEdgeBelowThreshold:20,stopScrollPropagation:!0,stopScrollPropagationAlways:!1,minContentHeight:0,onmoreThreshold:null,hidden:!1,shadows:!1,scrollElements:[],onresize:null,onscroll:null,onscrollstart:null,onscrollstop:null,ondrag:null,ondragstart:null,ondragstop:null,onupdate:null,onmore:null,noForceReFlow:!1},_),this.options.native&&(this.options.shadows=!1),i.browser.mobile&&(this.options.stopScrollPropagation=!1),(0,o.isArray)(this.options.scrollElements)||(this.options.scrollElements=[]),this.removeEvents=[],this.removeElements=[],this.dragging=!1,this.dragged=!1,this.released=!0,this.noMore=!1,this.dragY=null,this.dragScroll=null,this.shadowTop=!1,this.shadowBottom=!1,this.unnecessary=!1,this.disabled=!1,this.stopped=!0,this.stoppedTimeout=null,this.fixSizeDefault=null,this.animation=null,this.barOuterHeight=null,this.barInnerHeight=null,this.currentFrame=null,this.blockerScrollTop=500,this.emitter=new EventEmitter,(0,s.isFunction)(this.options.onresize)&&this.emitter.addListener("resize",this.options.onresize),(0,s.isFunction)(this.options.onscroll)&&this.emitter.addListener("scroll",this.options.onscroll),(0,s.isFunction)(this.options.onscrollstart)&&this.emitter.addListener("scrollstart",this.options.onscrollstart),(0,s.isFunction)(this.options.onscrollstop)&&this.emitter.addListener("scrollstop",this.options.onscrollstop),(0,s.isFunction)(this.options.ondrag)&&this.emitter.addListener("drag",this.options.ondrag),(0,s.isFunction)(this.options.ondragstart)&&this.emitter.addListener("dragstart",this.options.ondragstart),(0,s.isFunction)(this.options.ondragstop)&&this.emitter.addListener("dragstop",this.options.ondragstop),(0,s.isFunction)(this.options.onupdate)&&this.emitter.addListener("update",this.options.onupdate),(0,s.isFunction)(this.options.onmore)&&this.emitter.addListener("more",this.options.onmore),this.el={container:e,overflow:(0,l.ce)("div",{className:"ui_scroll_overflow"}),outer:(0,l.ce)("div",{className:"ui_scroll_outer"},{margin:this.options.stopScrollPropagation?this.blockerScrollTop+"px 0":void 0}),inner:(0,l.ce)("div",{className:"ui_scroll_inner tt_noappend"}),shadowTop:(0,l.ce)("div",{className:"ui_scroll_shadow_top"}),shadowBottom:(0,l.ce)("div",{className:"ui_scroll_shadow_bottom"}),content:(0,l.ce)("div",{className:"ui_scroll_content clear_fix"}),barContainer:(0,l.ce)("div",{className:"ui_scroll_bar_container"}),barOuter:(0,l.ce)("div",{className:"ui_scroll_bar_outer"}),barInner:(0,l.ce)("div",{className:"ui_scroll_bar_inner"})},(0,l.data)(this.el.container,"ui-scroll",this);const t=(0,l.cf)(),n=["ui_scroll_container"];for((0,s.each)((0,o.isArray)(this.options.theme)?this.options.theme:(0,s.trim)(this.options.theme+"").split(/\s+/),(function(e,_){_&&n.push("ui_scroll_"+_+"_theme")})),(0,l.addClass)(this.el.container,n.join(" ")),this.options.hidden&&(0,l.addClass)(this.el.container,"ui_scroll_hidden");this.el.container.firstChild;)this.el.content.appendChild(this.el.container.firstChild);if(this.el.outer.appendChild(this.el.inner),this.el.inner.appendChild(this.el.content),this.options.stopScrollPropagation?(this.el.blocker=(0,l.ce)("div",{className:"ui_scroll_blocker"}),this.addEvent(this.el.blocker,"scroll",this.fixBlocker.bind(this),!0),this.el.blocker.appendChild(this.el.outer),this.el.overflow.appendChild(this.el.blocker)):this.el.overflow.appendChild(this.el.outer),t.appendChild(this.el.overflow),this.options.native?(0,l.addClass)(this.el.container,"ui_scroll_native"):(this.el.barOuter.appendChild(this.el.barInner),this.el.barContainer.appendChild(this.el.barOuter),t.appendChild(this.el.barContainer),this.options.shadows&&(this.el.overflow.appendChild(this.el.shadowTop),this.el.overflow.appendChild(this.el.shadowBottom)),i.browser.mobile||this.options.scrollElements.push(this.el.barContainer)),this.options.autoresize){const e=(0,r.addResizeSensor)(this.el.inner,this.resize.bind(this,!0)),_=(0,r.addResizeSensor)(this.el.overflow,this.resize.bind(this,!1));this.removeElements.push(e[0]),this.removeElements.push(_[0]),this.startResizeListening=function(){e[1](),_[1]()}}this.removeElements.push(this.el.overflow,this.el.barContainer),this.el.container.appendChild(t),this.options.reversed&&(this.el.outer.scrollTop=this.el.outer.scrollHeight),this.el.container.__uiScroll__=this.api={container:this.el.container,scroller:this.el.outer,content:this.el.content,emitter:this.emitter,ondragstart:this.dragstart.bind(this),ondragstop:this.dragstop.bind(this),ondrag:this.drag.bind(this),destroy:this.destroy.bind(this),disable:this.disable.bind(this,!0),enable:this.disable.bind(this,!1),scrollTop:this.scrollTop.bind(this,!0),scrollBottom:this.scrollBottom.bind(this,!0),scrollBy:this.scrollBy.bind(this),scrollIntoView:this.scrollIntoView.bind(this,!0),update:this.init.bind(this),updateAbove:this.updateAbove.bind(this),updateBelow:this.updateBelow.bind(this),data:{scrollTop:null,scrollBottom:null,scrollHeight:null,viewportHeight:null}},this.init();const u="onwheel"in this.el.outer?"wheel":void 0!==document.onmousewheel?"mousewheel":i.browser.mozilla?"MozMousePixelScroll":"DOMMouseScroll";return this.addEvent(this.el.container,u,function(e){this.animation&&this.animation.stop(),!this.disabled&&this.options.stopScrollPropagation&&(this.unnecessary?this.options.stopScrollPropagationAlways&&(0,a.cancelEvent)(e):this.isScrollEventUnused(e)?(0,a.cancelEvent)(e):(0,a.stopEvent)(e))}.bind(this),!this.options.stopScrollPropagation),this.options.native||this.addEvent(this.el.barContainer,"mousedown",this.dragstart.bind(this)),(0,s.each)(this.options.scrollElements,function(e,_){this.addEvent(_,u,function(e){this.disabled||this.unnecessary||(this.scrollBy(d.scrollEventDelta(e)),!this.options.stopScrollPropagation&&this.isScrollEventUnused(e)||(0,a.cancelEvent)(e))}.bind(this))}.bind(this)),this.options.reversed&&this.addEvent(this.el.container,"mousedown touchstart pointerdown",function(e){this.released=!1,this.noMore=!0;const _=this.addEvent(document,"mouseup contextmenu touchend pointerup",function(e){(0,a.removeEvent)(document,"mouseup contextmenu touchend pointerup",_),this.released=!0,this.noMore&&this.stopped&&!this.dragging&&(this.noMore=!1,this.more())}.bind(this))}.bind(this)),this.addEvent(this.el.outer,"scroll",function(){this.update()&&(this.stopped?(this.stopped=!1,this.emitEvent("scrollstart")):this.options.native||!1!==this.stopped||(this.stopped=0,(0,l.addClass)(this.el.container,"ui_scroll_scrolled")),this.emitEvent("scroll"),this.stoppedTimeout&&clearTimeout(this.stoppedTimeout),this.stoppedTimeout=setTimeout(function(){this.stopped||(this.stopped=!0,this.options.native||(0,l.removeClass)(this.el.container,"ui_scroll_scrolled"),this.emitEvent("scrollstop"),this.noMore&&this.released&&!this.dragging&&(this.noMore=!1,this.more()))}.bind(this),200))}.bind(this)),this.api}}d.addResizeSensor=r.addResizeSensor;const u=d},332066:(e,_,t)=>{t.d(_,{addResizeSensor:()=>u,getScrollElement:()=>d,nextFrame:()=>r});var i=t(82161),o=t(795558),s=t(301230);let l;const a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||(e=>setTimeout(e,1)),n=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;function r(e){l&&n(l),l=a(e)}function d(e){return(0,i.isString)(e)&&"_"===e[0]?(0,o.geByClass1)(e):(0,o.ge)(e)}function u(e,_){if((e=d(e))&&(0,i.isFunction)(_)){if(s.browser.msie9||s.browser.opera&&s.browser.version<13){let t=!1,l=!1;const a=(0,o.ce)("object",{type:"text/html",className:"ui_scroll_resize_object",data:"about:blank",onload:function(){l=!0,t&&n()}});function n(){if(!a.contentDocument)return setTimeout(n,100);a.contentDocument.defaultView.removeEventListener("resize",_),a.contentDocument.defaultView.addEventListener("resize",_),_()}return e.appendChild(a),e.__resizeSensor__=[a,function(){t=!0,l&&n()}]}{const r=(0,o.ce)("div",{className:"ui_scroll_resize_sensor"}),u=(0,o.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_expand"}),c=(0,o.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_shrink"}),h=(0,o.ce)("div"),E=(0,o.ce)("div");let p=null;return u.appendChild(h),c.appendChild(E),r.appendChild(u),r.appendChild(c),e.appendChild(r),e.__resizeSensor__=[r,u.onscroll=c.onscroll=function(){const t=(e.offsetWidth||1e4)+10,i=(e.offsetHeight||1e4)+10;h.style.width=t+"px",h.style.height=i+"px",u.scrollLeft=t,u.scrollTop=i,c.scrollLeft=t,c.scrollTop=i,p!==(p=t+" "+i)&&_()}]}}}},833712:(e,_,t)=>{t.d(_,{InlineDropdown:()=>d});var i=t(795558),o=t(301230),s=t(563411),l=t(953908),a=t(605101),n=t(664988),r=t(82161);function d(e,_){if(this.constructor!==d)throw new Error("InlineDropdown was called without 'new' operator");if(!(e=(0,i.ge)(e)))return;if(!e.nodeType)throw new Error("First argument not a DOM element");if((0,i.hasClass)(e,"idd_wrap"))return;if(this._opts=_||{},this._items=_.items?(0,r.clone)(_.items):JSON.parse(e.getAttribute("data-items")),!this._items)throw new Error("No items provided");this._title=_.keepTitle?_.title||e.innerHTML:"",this._selectable=!_.keepTitle||_.keepSelected,this._disableCancelClickEvent=!!_.disableCancelClickEvent&&!!_.disableCancelClickEvent;const{icon:t}=(0,a.getIcon12Dropdown)();this._iddEl=(0,i.se)(`<div class="idd_wrap" id="${e.id}">\n    <div class="idd_selected_value" tabindex="0" role="button">\n      ${e.innerHTML}\n    </div>\n    ${_.withArrow?`<div class="idd_chevron">${t}</div>`:""}\n    <input type="hidden" id="${e.id}_input" name="${e.getAttribute("name")||e.id}" />\n  </div>`);let o=this;if((0,n.each)(e.className.split(" "),(function(e,_){(0,i.addClass)(o._iddEl,_)})),(0,n.each)(e.attributes,(function(e,_){0==_.name.indexOf("data-")&&o._iddEl.setAttribute(_.name,_.value)})),e.parentNode.replaceChild(this._iddEl,e),this._els={valueEl:(0,i.geByClass1)("idd_selected_value",this._iddEl),itemsContentEl:(0,i.geByClass1)("idd_items_content",this._iddEl),hiddenInputEl:(0,i.geByTag1)("input",this._iddEl)},this._opts.autoShow){let e=!1;const _=function(){e=!0,clearTimeout(o._autoShowTimeout),o._autoShowTimeout=setTimeout((function(){e&&o._onClick()}),100)},t=function(){clearTimeout(o._autoShowTimeout),e=!1};(0,l.addEvent)(this._iddEl,"mouseenter",_),(0,l.addEvent)(this._iddEl,"mouseleave",t),(0,l.addEvent)(this._iddEl,"keydown",(e=>"Enter"===e.key&&e.target.getAttribute("class").includes("idd_selected_value")?_():null))}else(0,l.addEvent)(this._iddEl,"click",this._onClick.bind(this)),(0,l.addEvent)(this._iddEl,"keydown",(e=>"Enter"===e.key&&e.target.getAttribute("class").includes("idd_selected_value")?this._onClick.call(this):null));this._rebuildDropdown();let s=!1;void 0!==_.selected?s=_.selected:e.hasAttribute("data-value")&&(s=e.getAttribute("data-value")),!1!==s&&this.select(s,!0)}d.IDD_HEADER_CORRECTION_LEFT=-10,d.IDD_HEADER_CORRECTION_TOP=-8,d.prototype._rebuildDropdown=function(){let e=this._opts.withIcon?"idd_with_icon":"",_=this._opts.idPrefix?this._opts.idPrefix:"",t=this._opts.idItemPrefix?this._opts.idItemPrefix:"",s=this,r=this._opts.ariaLabel||"";const{icon:u}=(0,a.getIcon12Dropdown)();let c=`<div class="idd_header_wrap ${e}">\n    <div class="idd_header" id="${_}${this._items[0][0]}"></div>\n      ${this._opts.withArrow?`<div class="idd_chevron">${u}</div>`:""}\n    </div>`,h=`<div class="idd_items_wrap"><div class="idd_items_content" role="list" aria-label="${r}">`;(0,n.each)(this._items,(function(_,i){h+="separator"===i?'<div class="idd_separator"></div>':function(_,i){i=i||"";let o=s._opts.sublists&&s._opts.sublists[_[0]]?"idd_sublist":"";return`<div class="idd_item ${i} ${e} ${o}" id="${t}idd_item_${_[0]}" data-id="${_[0]}" tabindex="0" role="button">\n      ${s._opts.withIcon?'<div class="idd_item_icon" id="'+_[0]+'"></div>':""}\n      <div class="idd_item_name">${s._opts.html?s._opts.html(_):_[1]}</div>\n    </div>`}(i)})),h+="</div></div>",this._els.popupItems=(0,i.se)(h),this._els.popupHeader=(0,i.se)(c),(0,l.addEvent)(this._els.popupItems,"click",(function(e){let _=e.target;if("a"!=_.tagName.toLowerCase()){for(;_&&!(0,i.hasClass)(_,"idd_item");)_=_.parentNode;_&&(s.select(_.getAttribute("data-id"))?s._hide():s._hoverItem(_)),(0,l.cancelEvent)(e)}else setTimeout((function(){s._hide()}))})),(0,n.each)((0,i.geByClass)("idd_item",this._els.popupItems),(function(e,_){(0,l.addEvent)(_,"mouseenter",(function(e){d._preventMouseHover||s._hoverItem(e.currentTarget)})),(0,l.addEvent)(_,"mouseleave",(function(e){d._preventMouseHover||s._unhoverItem(e.currentTarget,e)}))})),(0,l.addEvent)(this._els.popupItems,"mouseenter",function(){(0,l.addEvent)(this._els.popupItems,o.browserFeatures.wheelEvent,this._onWheel.bind(this))}.bind(this)),(0,l.addEvent)(this._els.popupItems,"mouseleave",function(){(0,l.removeEvent)(this._els.popupItems,o.browserFeatures.wheelEvent,this._onWheel.bind(this))}.bind(this))},d.prototype._onClick=function(e){if((0,i.isVisible)(this._els.popupEl))return void this._hide();d._currIDD&&d._currIDD._hide(),d._currIDD=this,window.tooltips&&tooltips.hideAll();let _=this;let t=this._els.popupEl=(0,i.se)('<div class="idd_popup"></div>');this._opts.alignLeft&&(0,i.addClass)(t,"idd_align_left"),this._opts.popupClass&&(0,i.addClass)(t,this._opts.popupClass),this.openToUp=1==this._opts.forceDir||"up"==this._opts.forceDir||-1!=this._opts.forceDir&&"down"!=this._opts.forceDir&&(0,i.getXY)(_._iddEl)[1]-((window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0))+200>window.innerHeight,this.openToUp?(t.appendChild(this._els.popupItems),t.appendChild(this._els.popupHeader)):(t.appendChild(this._els.popupHeader),t.appendChild(this._els.popupItems));let o=(0,i.geByClass1)("idd_header",this._els.popupHeader);this._opts.keepTitle?o.innerHTML=this._title:o.innerHTML=this._selected?this._selected[1]:"",t.id="idd_"+this._iddEl.id,this._iddEl.appendChild(t);let s=(0,i.getSize)(t),a=(0,i.getSize)(this._els.valueEl),n=0;this.openToUp&&(n=-(0,i.getSize)(this._els.popupItems)[1]);let r={marginTop:(this._opts.headerTop||d.IDD_HEADER_CORRECTION_TOP)+n,width:s[0]+8,opacity:1};this._opts.alignLeft?r[vk.rtl?"marginRight":"marginLeft"]=a[0]-d.IDD_HEADER_CORRECTION_LEFT:r.marginLeft=(this._opts.headerLeft||d.IDD_HEADER_CORRECTION_LEFT)-(this._opts.withIcon?20:0),(0,i.setStyle)(t,r),this._unhoverItem(),this._highlightItem(),this._initOutEvent(),this._initKeypressEvent(),this._opts.onShow&&this._opts.onShow(this.ddEl),this._disableCancelClickEvent||(0,l.cancelEvent)(e)},d.prototype._hide=function(){(0,i.re)(this._els.popupEl),this._els.popupEl=null,(0,i.removeClass)(this._hoveredItem,"idd_hover"),this._hoveredItem=null,this._deinitEvents(),this._hideSubmenu(),clearTimeout(this._hideSubmenuTimeout),this._opts.onHide&&this._opts.onHide()},d.prototype._highlightItem=function(e){if(!this._selectable)return;if(!this._els.popupEl)return;if(void 0===e){if(!this._selected)return;e=this._selected[0]}let _=(0,i.geByClass1)("idd_hl",this._els.popupEl);_&&(0,i.removeClass)(_,"idd_hl");let t=(0,i.ge)("idd_item_"+e);(0,i.addClass)(t,"idd_hl");let o=this;(0,n.each)((0,i.geByClass)("idd_item",this._els.popupItems),(function(e,_){if(_==t)return o._els.popupItems.scrollTop=(e+1)*(0,i.getSize)(_)[1]-(0,i.getSize)(o._els.popupItems)[1]/2,!1}))},d.prototype._onWheel=function(e){let _=(0,i.getSize)((0,i.geByClass1)("idd_items_content",this._els.popupItems))[1],t=(0,i.getSize)(this._els.popupItems)[1];_!=t&&(0==this._els.popupItems.scrollTop&&e.deltaY<0||this._els.popupItems.scrollTop==_-t&&e.deltaY>0)&&(0,l.cancelEvent)(e)},d.prototype._onKeyDown=function(e){switch(e.keyCode){case 9:case 38:case 40:case 13:case 27:this._onKey(e.keyCode,e)}},d.prototype._onKeyPress=function(e){this._onKey(e.which,e)},d.prototype._hideSubmenu=function(){(0,i.removeClass)(this._currSubmenuItem,"idd_hover_sublist_parent"),(0,i.re)(this._els.currCascade),delete this._currSubmenuItem,this._hoveredItem&&this._showSubmenu(this._hoveredItem)},d.prototype._showSubmenu=function(e){if(clearTimeout(this._hideSubmenuTimeout),!e)return;let _=this,t=e.getAttribute("data-id");if(this._opts.sublists&&this._opts.sublists[t]){if((0,i.addClass)(e,"idd_hover_sublist_parent"),this._currSubmenuItem==e)return void clearTimeout(this._submenuHideTimeout);let o=this._opts.sublists[t],a='<div class="idd_popup"><div class="idd_items_wrap"><div class="idd_items_content">',r=o.withIcon?"idd_with_icon":"";function u(e,_){return'<div class="idd_item '+(_=_||"")+" "+r+'" id="idd_item_'+e[0]+'" data-id="'+e[0]+'" role="button" tabindex="0">'+(o.withIcon?'<div class="idd_item_icon" id="'+e[0]+'"></div>':"")+'<div class="idd_item_name">'+(o.html?o.html(e):e[1])+"</div></div>"}(0,n.each)(o.items,(function(e,_){a+=u(_)})),a+="</div></div></div>",this._els.currCascade=(0,i.se)(a),this._iddEl.appendChild(this._els.currCascade);{let c=(0,i.getSize)(this._els.popupEl),h=(0,i.getSize)(e),E=(0,i.getSize)(this._els.currCascade),p=0,P=e;for(;null!=(P=P.previousSibling);)p++;let g=c[0]+(this._opts.headerLeft||d.IDD_HEADER_CORRECTION_LEFT)-1;(0,i.setStyle)(this._els.currCascade,{marginLeft:g-3,marginTop:h[1]*p+6-(this.openToUp?c[1]:0),"z-index":200,width:E[0]+30}),setTimeout((function(){(0,s.cssAnim)(_._els.currCascade,{marginLeft:g,opacity:1},{duration:140})}),10)}(0,n.each)((0,i.geByClass)("idd_item",this._els.currCascade),(function(e,t){(0,l.addEvent)(t,"mouseenter",(function(e){_._isInSubmenu=!0,d._preventMouseHover||_._hoverItem(e.currentTarget,null,!0)})),(0,l.addEvent)(t,"mouseleave",(function(e){_._isInSubmenu=!1,d._preventMouseHover||_._unhoverItem()}))})),(0,l.addEvent)(this._els.currCascade,"click",(function(e){let t=e.target;if("a"!=t.tagName.toLowerCase()){for(;t&&!(0,i.hasClass)(t,"idd_item");)t=t.parentNode;if(t){let e=!0,s=t.getAttribute("data-id"),l=(0,i.geByClass1)("idd_item_name",t).innerHTML;o.onSelect?e=o.onSelect(s,l):_._opts.onSelect&&(e=_._opts.onSelect(s,l)),e&&_._hide()}(0,l.cancelEvent)(e)}else setTimeout((function(){_._hide()}))})),this._currSubmenuItem=e}},d.prototype._hoverItem=function(e,_,t){let o=this;if(this._unhoverItem(),(0,i.addClass)(e,"idd_hover"),this._hoveredItem=e,_&&e){let _=e.getAttribute("id"),t=this;(0,n.each)((0,i.geByClass)("idd_item"),(function(o,s){if(s.getAttribute("id")==_)return t._els.popupItems.scrollTop=(0,i.getSize)(e)[1]*(o+1)-(0,i.getSize)(t._els.popupItems)[1]/2,clearTimeout(d._preventMouseHover),d._preventMouseHover=setTimeout((function(){d._preventMouseHover=null}),100),!1}))}if(clearTimeout(this._hideSubmenuTimeout),t)(0,i.addClass)(this._currSubmenuItem,"idd_hover_sublist_parent");else{let _=this._currSubmenuItem==e;this._currSubmenuItem&&!_&&(this._hideSubmenuTimeout=setTimeout((function(){o._hideSubmenu()}),200)),this._currSubmenuItem||this._showSubmenu(e),(0,i.removeClass)(this._currSubmenuItem,"idd_hover_sublist_parent")}},d.prototype._unhoverItem=function(e,_){this._hoveredItem&&(0,i.removeClass)(this._hoveredItem,"idd_hover"),this._hoveredParentItem&&(0,i.removeClass)(this._hoveredParentItem,"idd_hover"),clearTimeout(d._preventMouseHover)},d.prototype._onKey=function(e,_){if(38==e||40==e){let t=this,o=this._hoveredItem||(0,i.geByClass1)("idd_hl",this._els.popupItems)||(0,i.geByClass1)("idd_item",this._els.popupItems);return o=38==e?o.previousSibling:o.nextSibling,t._hoverItem(o,!0),(0,l.cancelEvent)(_),!1}if(9==e){let e=this,t=(0,i.geByClass1)("idd_items_content",this._els.popupItems),o=_.target;return o=_.target.getAttribute("class").includes("idd_item")?_.shiftKey?o.previousSibling:o.nextSibling:_.shiftKey?t.lastChild:t.firstChild,e._hoverItem(o,!0),!1}13==e?this._hoveredItem&&this.select(this._hoveredItem.getAttribute("data-id"))&&this._hide():27==e?this._hide():this._quickSearch(e)},d.prototype._quickSearch=function(e){let _=this;if(void 0!==e){let t=String.fromCharCode(e).toLowerCase();if(!t)return;setTimeout((function(){_._currSearchStr=""}),600),this._currSearchStr=this._currSearchStr||"",this._currQuickSearchIndex=this._currQuickSearchIndex||0,1==this._currSearchStr.length&&this._currSearchStr[0]==t||(this._currSearchStr+=t)}let t=this._items;for(let _=this._currQuickSearchIndex;_<t.length;_++){let o=t[_][1].toLowerCase();if(1==this._currSearchStr.length&&this._currSearchStr==o[0]||this._currSearchStr.length>1&&o.indexOf(this._currSearchStr)>=0){this._currQuickSearchIndex=_+1,this._hoverItem((0,i.ge)("idd_item_"+t[_][0]),!0),_==t.length-1&&(this._currQuickSearchIndex=0);break}_==t.length-1&&(this._currQuickSearchIndex=0,e&&this._quickSearch())}},d.prototype._deinitEvents=function(){(0,l.removeEvent)(window,"click",d._window_onOuterClick),(0,l.removeEvent)(window,"keypress",d._window_onKeyPress),(0,l.removeEvent)(window,"keydown",d._window_onKeyDown)},d.prototype._initKeypressEvent=function(){(0,l.addEvent)(window,"keypress",d._window_onKeyPress=this._onKeyPress.bind(this)),(0,l.addEvent)(window,"keydown",d._window_onKeyDown=this._onKeyDown.bind(this))},d.prototype._onOuterClick=function(e){let _=e.target,t=!0;for(;_&&_!=document;){if((0,i.hasClass)(_,"idd_popup")){t=!1;break}_=_.parentNode}t&&this._hide()},d.prototype._initOutEvent=function(){let e=this;setTimeout((function(){(0,l.addEvent)(window,"click",d._window_onOuterClick=e._onOuterClick.bind(e))})),this._opts.autoHide>0&&((0,l.addEvent)(this._iddEl,"mouseleave",(function(){clearTimeout(e._leaveTimeout),e._leaveTimeout=setTimeout((function(){e._isInSubmenu||e._hide()}),e._opts.autoHide)})),(0,l.addEvent)(this._iddEl,"mouseenter",(function(){clearTimeout(e._leaveTimeout)})))},d.prototype.deinit=function(){this._deinitEvents()},d.prototype.setItems=function(e){this._items=(0,r.clone)(e),this.select(e[0][0],!0),this._rebuildDropdown()},d.prototype.getElement=function(){return this._iddEl},d.prototype.getSelected=function(){return this._selected},d.prototype.select=function(e,_){if(this._opts.sublists&&this._opts.sublists[e])return;let t=!1;if((0,n.each)(this._items,(function(_,i){if(i[0]==e)return t=i,!1})),!1===t)throw new Error("No item found for selection");this._selected=t,this._opts.keepTitle||(this._els.valueEl.innerHTML=t[1]),(0,i.val)(this._els.hiddenInputEl,e);let o=!0;if(!_&&this._opts.onSelect)try{o=!this._opts.onSelect(t[0],t)}catch(e){console.error(e)}return o},d.prototype.val=function(e,_){return void 0!==e?this.select(e,_):this.getSelected()?this.getSelected()[0]:""}},718409:(e,_,t)=>{t.d(_,{Lottie:()=>r});var i=t(434788),o=t(820224),s=t(785893),l=t(659397),a=t(607338),n=t(39655);const r=e=>{var _,t,{play:r,fallback:d,options:u,className:c,style:h}=e,E=(0,o._)(e,["play","fallback","options","className","style"]);const{width:p,height:P}=u,{lottieContainerRef:g,lottieLoading:b,lottieError:D}=(0,a.useLottie)((0,i._)({},u),{play:r}),O=b||D;var M,m;return(0,s.jsx)("div",(0,i._)({ref:g},E,{className:(0,l.classNames)(n.default.root,c),style:(0,i._)({},h,{width:null!=(M=null!=p?p:null==(_=h)?void 0:_.width)?M:"100%",height:null!=(m=null!=P?P:null==(t=h)?void 0:t.height)?m:"100%"}),children:(0,s.jsx)("div",{children:O&&d})}))}},72305:(e,_,t)=>{t.d(_,{ensureMyAudioPlaylistsService:()=>a});var i=t(798116),o=t(367431),s=t(409131),l=t(108920);const a=(0,o.makeSharedState)("global/audio/myPlaylists",(()=>(0,s.createMyAudioPlaylistsService)({config:{domain:(0,i.createDomain)("global/audio/myPlaylists"),name:"global/audio/myPlaylists"},audioPlaylistsService:(0,l.ensureAudioPlaylistsService)()})),{version:1})},409131:(e,_,t)=>{t.d(_,{createMyAudioPlaylistsService:()=>n});var i=t(11010),o=t(434788),s=t(798116),l=t(778748),a=t(191503);function n({config:e,audioPlaylistsService:_}){const t=(0,l.getEffectorServiceDomain)(e),n=t.createEvent(),r=(0,s.restore)(n,null),d=t.createStore({},{updateFilter:(e,_)=>!(0,a.shallowEqual)(e,_),serialize:"ignore"}),u=(0,s.attach)({source:r,effect:(e,t)=>(0,i._)((function*(){if(!e)throw new Error("[MyAudioPlaylistsService] UserId not set. To create a playlist, set the userId using setUserId.");return _.createFx((0,o._)({},t,{ownerId:e}))}))()}),c=(0,s.attach)({source:r,effect:(e,t)=>(0,i._)((function*(){if(!e)throw new Error("[MyAudioPlaylistsService] UserId not set. To delete a playlist, set the userId using setUserId.");return _.deleteFx((0,o._)({},t,{ownerId:e}))}))()});return(0,s.sample)({clock:(0,s.combine)({playlistDataEntities:_.$playlistDataEntities,userId:r}),fn:({playlistDataEntities:e,userId:_})=>_?Object.entries(e).reduce(((e,[t,i])=>(i.ownerId===_&&(e[t]=i),e)),{}):{},target:d}),{createFx:u,deleteFx:c,setUserId:n,$myAudioPlaylistsIdentitiesMap:d}}},191503:(e,_,t)=>{function i(e,_){if(e===_)return!0;if("object"!=typeof e||null===e||"object"!=typeof _||null===_)return!1;const t=Object.keys(e),i=Object.keys(_);if(t.length!==i.length)return!1;for(let i=0;i<t.length;i++)if(!Object.prototype.hasOwnProperty.call(_,t[i])||e[t[i]]!==_[t[i]])return!1;return!0}t.d(_,{shallowEqual:()=>i})}}]);try{stManager.done("dist/db518e9c64536d311f4629724f55e979.33e7dff38e37482b84c4.js")}catch(e){}